use core::{AsBytes, Serializable, Deserializable, SliceReader};
use traits::traits::{Field, PrimeField};
use crate::fp::Fp;
use crate::fp2::Fp2;
//======================= BASE FIELD TESTS =========================

#[test]
fn base_add_test(){
    
    
    // a and b are generated using 2 runs of the following code in order to sample 100 random integers uniformly in the range (M/2, M)
    
    //let mut rng = rand::thread_rng();

    // let vec_a:Vec<u128> = (&mut rng).sample_iter::<u128,_>(Uniform::new(M/2, M)).take(100).collect();

    // let vec_b:Vec<u128> = (&mut rng).sample_iter::<u128,_>(Uniform::new(M/2, M)).take(100).collect();
    
    let a: [u128; 100] = [174406971591187532577705298530619297067, 273353028293521134949622872099189388256, 198981816169985501641346527210182162568, 266968125559646267477442838834337788083, 283611569930382170543797387556786379993, 294005113981518242532751606844460156755, 210732426404757464420338703701598751623, 248629953311415512231700469440262894065, 301067984250527614521955973089951710131, 300541728442683048701600656120512381730, 328251708715830175291910815737759552519, 293573563608851668446059642854917948514, 209991387440891093216292930727030725008, 269814779980830229126089063542909050830, 283127497541056998028010894720264869718, 318332808602522965056875924436433937079, 246564613855769992364459547145478990710, 267893748327116225790788212602782700875, 277441184223231718499039856054824479977, 307379648796213556060906100102431002866, 204156632252328444272210650246072601792, 266161027224865530911247179221639154823, 290681593512253573022199871945928392173, 226994754062744436272311197990129751829, 263500661401797224165785434518081132927, 214611557385190178563975370685743774858, 226699703760093194810901962675950842193, 189348118647373921500161996758990638689, 171354918074974526091680703557935224852, 230219402513511552661259494156641323727, 261936105219404796587420984104306950114, 302586702473153683517790117847281515155, 207562456976658795859089815138473200076, 234620263481478077667663107645333133424, 200608582974468186940862776793324866372, 227642739967391709125974048156019925208, 177476305387885923625556941151867829108, 285840390245801352027750853020225443155, 275623215861777922285827585986629135501, 207252424968247720425173048612470511188, 184963389035847465016368421426649833334, 231832770651334170648059077772857143196, 323591133055692951129187463266588937484, 205212211621986006608539427413824555398, 179447058542990065180216122399111317042, 250604600273304930320763015307891253469, 261431978981259678351703972456106709589, 240431756598800771820483111003824160836, 195694955681705789199144659657748352464, 308840952762164815563403493808449488382, 301061493274618792902931005800466873424, 300832066491507440246527377162476062013, 260390111731085200071377235215593088894, 286819110407827932732524931380550938317, 253006067564119864218534975283077258386, 178142023420163004656832803426678084966, 260577369348379108805214349137287127690, 226192344752234292386443876995211991478, 203370514551421496915834667254781615590, 329050953312042147915396811743193441892, 181566191693489726745036506250149601144, 189315886774540971768846357162454904318, 213776461720607525871017077856134245262, 219808710268616328585999447625827969004, 323606520381566497629725356479691541937, 251854458876219917904372933515284831197, 323462134996048656473293650701159402547, 270212435678530101376424604960680211667, 305337634168873644454739545569990473705, 275439646257100762489959591393973837669, 278229616727698593928971599975282595471, 336787481429331481616072165270836092809, 252321822179247184744034404064517925280, 262121214045757074094426801874969317808, 289391802164114755791445354722334628552, 293182346132637147205582082915261700671, 252367434614446978246508341287429071902, 172993424507119854686228227508956353012, 285159706837272952353542128861664342530, 189047243051601303641202590787335593391, 316157761469015661506396796541579662898, 223000960683804875337158054021708845669, 253972157925737779384962355241749120590, 241458504178745352744900612061985631045, 222302601796071233403679567140470100891, 230270555280495443463209747554449127757, 246345083094371693758864388035639480439, 174085084424215708261067864608968990931, 179548895624876743709369083813246874679, 215207169964025281188379043359686076327, 182359414140244115854161477891097494465, 224858292811209448567312375324531572861, 278747487954339590139509297069625054828, 316160657532095243047824354804693481361, 274456180119635224494017551427963964105, 211921054014305312551383131318737424629, 280589933576620290865233287231267475126, 190196479105693496182452311740744965577, 227630184444351855593884546610815383002, 219605863144177352033679176569502755697];
    let b: [u128; 100] = [219144869279903914781847181350978435516, 176532942523124545805654851786973969122, 265323234677897595829007649035347126949, 230565065491432223807777880676885238307, 320311955773880910875442119115864551065, 223429944981778806156762332038732289832, 219022710963061799561873887279038158458, 302505193887824181137338825539964029243, 268078175398344758279965849683685025081, 311553934101341713635061860623501863473, 280093269267237269844875815268472625079, 197429240569462326350853629791671038642, 200978239514513835178304242704710858278, 291218352457904147259134072204983403755, 215812238400976691189362992062340258124, 264193515551784286279257201334200385297, 250305453623463730339974355958055213818, 279869293174182091345632657039355898424, 338198699315337348865518273383664698019, 265660111283715789301628045894132992296, 232632431804554730869914942427228663801, 186523858258610815959533523080866228201, 293660212004874245907361220393676981407, 336404698877908911143539681987416561825, 322397685902507165771646803295191815033, 274744441423794217352948844231432798799, 220823866681047959762489679855751824869, 215022642271109592977849264343007365287, 319323126225831315431579717400456404318, 291390827135550181504917868859399016337, 308269541770210745021729575776186183749, 191791142178133864457733153771177363741, 198914479761092970545173733879758068452, 191936541206920876787267435815830559313, 269108159932556131422336549680473644357, 316950052928724349031108155199156902356, 317633642578225990195361379469672337588, 228618436252891052984935890691330403803, 249119419129547744789036458175734558088, 225661857869710104952495864677669872405, 223377022770086530883770720720086154403, 323614763802982786230424536580539219138, 245378302213974027674326962356651522410, 246707946108923410088449967869232095918, 320583828712788265106840481377922099036, 213781570026415919288112772624900720504, 236945234287073600407013159743481009337, 269301911302568014362550332678032017627, 332165182770104088260872456083568720337, 177407521141864774426534017916347556285, 201048326597270662766230852422005658496, 299591901501544687102392979148396283881, 266859136606734281593642390533164026348, 204063829619441272654425963296354048962, 298190356581773744993127157634772411296, 178114599347353441030551553179210135422, 229014718243463412335613501418420031594, 326316357382602195295072571351598338043, 272421822517682029669952180841475300809, 214487085037583246495663912794896630445, 205793524314788121004230800609712437167, 300653042731173892763532220662086304377, 180514187440765578418127079069314736980, 248256807501948668064828338181480564845, 227947891191366650176576457388083446504, 238637863136454667895874022906777089485, 269600576095487885081154604143518689636, 235360230496087202111315256085984173292, 219461855330335304523081184720220480972, 223598118659766656036439094328871131307, 280637185452865724306509968410692705434, 294833441109056072189961741454959534835, 300501666776966818098422265640272652676, 246313447874821962448347652434970196949, 305888089603500677245307495306176307125, 187907956781653407011971327945815118555, 281855853436633642681542617301931715827, 297567001782272919101302096920545638429, 239379755681466538575995625528935131993, 206004117001208181679503727830004502369, 239302931240391603430904372730550333255, 231645935573106877245845718221590225182, 333138121021722339893097562205708515148, 184162333313436223014862643216955562864, 175885238140532604596045611689355728756, 261324281329602267747183299438025874851, 251059235628702160939829829274004766773, 287512348480364223587477174394091917910, 251193827308867337127235425638156899778, 183054319130203442041140461823526348318, 230559271741623964301684653941895809955, 292217643391827349760621342656498324903, 258726452392107906570966935838957890913, 208867262461656046823627195745200792629, 289490077305068221215896895405195079897, 242718558902851983435760850743228483261, 266331112221476847671910032147592941798, 224339669168716217943333725501099600553, 251783565425267189241657984486758231073, 325284478827487772645489157765674692654];
    
    //modulo sum computed using SageMath
    let actual_add: [u128; 100] = [53269473950152983896177921927852771046, 109603603895707217291903165932418395841, 124022683926944634006979618291784327980, 157250824130140027821846161557478064853, 263641158783324617955864948718905969521, 177152692042358585226139380929447485050, 89472770446880800518838033026891948544, 210852780278301229905664737026481961771, 228863792727933909338547264819891773675, 271813295623086298873287958790269283666, 268062611062128981673412073052487216061, 150720437257375531333538714692844025619, 70687260034466464931222615477996621749, 220750765517795912921848577794147493048, 158657369021095225753999328828860166305, 242243957233368787872758567816889360839, 156587700558295259241059345149789242991, 207480674580359853673046311688393637762, 275357516617630603901183571484744216459, 232757393158990881899159588042819033625, 96506697135944711678751034719556304056, 112402518562537883407406144348760421487, 244059438596189355466186534385860412043, 223117086019714883952476322023801352117, 245615980383365926474057679859527986423, 149073631888045932453549656963431612120, 107241203520202691110017084577957705525, 64088393997545051014636703148253042439, 150395677379867378059885863004646667633, 181327862728123270702802805062295378527, 229923280068677078145776001926748172326, 154095477730349084512148713664713917359, 66194569816813302940888991064486306991, 86274437767460490991555985507418731200, 129434375986085854899824768520053549192, 204310425975177594693707645401431866027, 154827581045173450357543762667795205159, 174176459577753941549312185757810885421, 184460268070387203611489486208618732052, 92631915917019361914294355336395422056, 68058044884995532436764584192991026200, 215165167533378493415109056399651400797, 228687068348728515340139867669495498357, 111637790809970953233614837329311689779, 159748520334839866823682045823288454541, 124103803378782386145501229979047012436, 158094846347394815295342574245842757389, 169451300980430322719658885728111216926, 187577771530871413996642557787572111264, 145966106983091126526562953771052083130, 161827452950950992205787300268727570383, 260141601072113663885545798357127384357, 186966881416881018201645067795012153705, 150600573106330741923576336723160025742, 210914057224955145748287574964104708145, 15974255846577982224009798652143258851, 149309720670904057677453292601962197747, 212226335213898024218141890393065367984, 135509970148165063122412290142511954862, 203255671428686930947686166584345110800, 47077349087339384285892748906117076774, 149686562584776401069004019870796247158, 54008282240434640825769598971704020705, 127783150849626533187453227853563572312, 211272044651994684342927255914030026904, 150209955091736122336872398468316959145, 252780344170598078091073696890933130646, 165290299253678840024365303092919423422, 184517122578270485514446172336465993140, 158755397995928955063024127769100007439, 218584435259625854772107010432230339368, 291338555617449090342659348772050666107, 212541122035275539379082111751045616419, 168152294999640573079399896356194553220, 254997524846676969573378292074765974140, 140807935993352090754178852907331857689, 193940921130142157464676400635615826192, 130278059368454310324155766475757029904, 184257095597801027466163196436854512986, 54768993131871021857331760663595134223, 215178325788468801473926611318385034616, 114364529335973289119629214289554109314, 246827912026521655814685359493712674201, 85338470571243112296388697325196232372, 57905473015665374536350620876080868110, 151312469689159247747018489038730041071, 157121951802135391235319659355899285675, 121315065983641468385170481049315947304, 90460356012805617373229951497658812920, 57979122173290259766144947229467463108, 72636318960929616692471573879248342883, 176793569282098334864559160027284936227, 197191573425509033247101674954837984204, 184745553072812826408076992596149312453, 223663890503764982246539888879414082465, 114357245996218832523769424108220946353, 206638678877158675073768761425115455387, 74253781353471250662411479288099604593, 139131382948680581372167973143828652538, 204607975050726661215793776381432486814];
    
    let actual_add_f128:Vec<Fp> = actual_add.iter().map(|&a| Fp::from(a)).collect();
    
    let test_add:Vec<Fp> = a.iter().zip(b.iter()).map(|(&a,&b)| Fp::from(a) + Fp::from(b)).collect();

    assert_eq!(actual_add_f128, test_add)
}


#[test]
fn base_sub_test() {
    let a: [u128; 100] = [174406971591187532577705298530619297067, 273353028293521134949622872099189388256, 198981816169985501641346527210182162568, 266968125559646267477442838834337788083, 283611569930382170543797387556786379993, 294005113981518242532751606844460156755, 210732426404757464420338703701598751623, 248629953311415512231700469440262894065, 301067984250527614521955973089951710131, 300541728442683048701600656120512381730, 328251708715830175291910815737759552519, 293573563608851668446059642854917948514, 209991387440891093216292930727030725008, 269814779980830229126089063542909050830, 283127497541056998028010894720264869718, 318332808602522965056875924436433937079, 246564613855769992364459547145478990710, 267893748327116225790788212602782700875, 277441184223231718499039856054824479977, 307379648796213556060906100102431002866, 204156632252328444272210650246072601792, 266161027224865530911247179221639154823, 290681593512253573022199871945928392173, 226994754062744436272311197990129751829, 263500661401797224165785434518081132927, 214611557385190178563975370685743774858, 226699703760093194810901962675950842193, 189348118647373921500161996758990638689, 171354918074974526091680703557935224852, 230219402513511552661259494156641323727, 261936105219404796587420984104306950114, 302586702473153683517790117847281515155, 207562456976658795859089815138473200076, 234620263481478077667663107645333133424, 200608582974468186940862776793324866372, 227642739967391709125974048156019925208, 177476305387885923625556941151867829108, 285840390245801352027750853020225443155, 275623215861777922285827585986629135501, 207252424968247720425173048612470511188, 184963389035847465016368421426649833334, 231832770651334170648059077772857143196, 323591133055692951129187463266588937484, 205212211621986006608539427413824555398, 179447058542990065180216122399111317042, 250604600273304930320763015307891253469, 261431978981259678351703972456106709589, 240431756598800771820483111003824160836, 195694955681705789199144659657748352464, 308840952762164815563403493808449488382, 301061493274618792902931005800466873424, 300832066491507440246527377162476062013, 260390111731085200071377235215593088894, 286819110407827932732524931380550938317, 253006067564119864218534975283077258386, 178142023420163004656832803426678084966, 260577369348379108805214349137287127690, 226192344752234292386443876995211991478, 203370514551421496915834667254781615590, 329050953312042147915396811743193441892, 181566191693489726745036506250149601144, 189315886774540971768846357162454904318, 213776461720607525871017077856134245262, 219808710268616328585999447625827969004, 323606520381566497629725356479691541937, 251854458876219917904372933515284831197, 323462134996048656473293650701159402547, 270212435678530101376424604960680211667, 305337634168873644454739545569990473705, 275439646257100762489959591393973837669, 278229616727698593928971599975282595471, 336787481429331481616072165270836092809, 252321822179247184744034404064517925280, 262121214045757074094426801874969317808, 289391802164114755791445354722334628552, 293182346132637147205582082915261700671, 252367434614446978246508341287429071902, 172993424507119854686228227508956353012, 285159706837272952353542128861664342530, 189047243051601303641202590787335593391, 316157761469015661506396796541579662898, 223000960683804875337158054021708845669, 253972157925737779384962355241749120590, 241458504178745352744900612061985631045, 222302601796071233403679567140470100891, 230270555280495443463209747554449127757, 246345083094371693758864388035639480439, 174085084424215708261067864608968990931, 179548895624876743709369083813246874679, 215207169964025281188379043359686076327, 182359414140244115854161477891097494465, 224858292811209448567312375324531572861, 278747487954339590139509297069625054828, 316160657532095243047824354804693481361, 274456180119635224494017551427963964105, 211921054014305312551383131318737424629, 280589933576620290865233287231267475126, 190196479105693496182452311740744965577, 227630184444351855593884546610815383002, 219605863144177352033679176569502755697];
    let b: [u128; 100] = [219144869279903914781847181350978435516, 176532942523124545805654851786973969122, 265323234677897595829007649035347126949, 230565065491432223807777880676885238307, 320311955773880910875442119115864551065, 223429944981778806156762332038732289832, 219022710963061799561873887279038158458, 302505193887824181137338825539964029243, 268078175398344758279965849683685025081, 311553934101341713635061860623501863473, 280093269267237269844875815268472625079, 197429240569462326350853629791671038642, 200978239514513835178304242704710858278, 291218352457904147259134072204983403755, 215812238400976691189362992062340258124, 264193515551784286279257201334200385297, 250305453623463730339974355958055213818, 279869293174182091345632657039355898424, 338198699315337348865518273383664698019, 265660111283715789301628045894132992296, 232632431804554730869914942427228663801, 186523858258610815959533523080866228201, 293660212004874245907361220393676981407, 336404698877908911143539681987416561825, 322397685902507165771646803295191815033, 274744441423794217352948844231432798799, 220823866681047959762489679855751824869, 215022642271109592977849264343007365287, 319323126225831315431579717400456404318, 291390827135550181504917868859399016337, 308269541770210745021729575776186183749, 191791142178133864457733153771177363741, 198914479761092970545173733879758068452, 191936541206920876787267435815830559313, 269108159932556131422336549680473644357, 316950052928724349031108155199156902356, 317633642578225990195361379469672337588, 228618436252891052984935890691330403803, 249119419129547744789036458175734558088, 225661857869710104952495864677669872405, 223377022770086530883770720720086154403, 323614763802982786230424536580539219138, 245378302213974027674326962356651522410, 246707946108923410088449967869232095918, 320583828712788265106840481377922099036, 213781570026415919288112772624900720504, 236945234287073600407013159743481009337, 269301911302568014362550332678032017627, 332165182770104088260872456083568720337, 177407521141864774426534017916347556285, 201048326597270662766230852422005658496, 299591901501544687102392979148396283881, 266859136606734281593642390533164026348, 204063829619441272654425963296354048962, 298190356581773744993127157634772411296, 178114599347353441030551553179210135422, 229014718243463412335613501418420031594, 326316357382602195295072571351598338043, 272421822517682029669952180841475300809, 214487085037583246495663912794896630445, 205793524314788121004230800609712437167, 300653042731173892763532220662086304377, 180514187440765578418127079069314736980, 248256807501948668064828338181480564845, 227947891191366650176576457388083446504, 238637863136454667895874022906777089485, 269600576095487885081154604143518689636, 235360230496087202111315256085984173292, 219461855330335304523081184720220480972, 223598118659766656036439094328871131307, 280637185452865724306509968410692705434, 294833441109056072189961741454959534835, 300501666776966818098422265640272652676, 246313447874821962448347652434970196949, 305888089603500677245307495306176307125, 187907956781653407011971327945815118555, 281855853436633642681542617301931715827, 297567001782272919101302096920545638429, 239379755681466538575995625528935131993, 206004117001208181679503727830004502369, 239302931240391603430904372730550333255, 231645935573106877245845718221590225182, 333138121021722339893097562205708515148, 184162333313436223014862643216955562864, 175885238140532604596045611689355728756, 261324281329602267747183299438025874851, 251059235628702160939829829274004766773, 287512348480364223587477174394091917910, 251193827308867337127235425638156899778, 183054319130203442041140461823526348318, 230559271741623964301684653941895809955, 292217643391827349760621342656498324903, 258726452392107906570966935838957890913, 208867262461656046823627195745200792629, 289490077305068221215896895405195079897, 242718558902851983435760850743228483261, 266331112221476847671910032147592941798, 224339669168716217943333725501099600553, 251783565425267189241657984486758231073, 325284478827487772645489157765674692654];

    //modulo difference computed using sage_math
    
    let actual_diff:[u128;100] = [295544469232222081259232675133385823088, 96820085770396589143968020312215419134, 273940948413026369275713436128579997156, 36403060068214043669664958157452549776, 303581981077439723131729826394666790465, 70575168999739436375989274805727866923, 331992082362634128321839374376305554702, 286407126344529794557736201854043826359, 32989808852182856241990123406266685050, 329270161262279798529913353450755479794, 48158439448592905447035000469286927440, 96144323039389342095206013063246909872, 9013147926377258037988688022319866730, 318878794443864545330329549291670608612, 67315259140080306838647902657924611594, 54139293050738678777618723102233551782, 336541527153244725487859749141168738429, 328306822073872597908530113517171763988, 279524851828832833096896140624904743495, 41719537512497766759278054208298010570, 311806567368712176865670265772588899528, 79637168966254714951713656140772926622, 337303748428317790578213209505996372303, 230872422105773988592146073956458151541, 281385342420228521857513189176634279431, 280149482882334424674401084408055937596, 5875837079045235048412282820199017324, 314607843297202791985687290369728234939, 192314158770081674123475544111223782071, 279110942298899834619716183250987268927, 293948930370132515029065966281865727902, 110795560295019819060056964076104151414, 8647977215565825313916081258715131624, 42683722274557200880395671829502574111, 271782789962850518981900785066596183552, 250975053959605823558240450910607984389, 200125029730598396893570119635940453057, 57221953992910299042814962328895039352, 26503796732230177496791127810894577413, 321872934019476078936051741888545600320, 301868733186699397595972258660308640468, 248500373769289847881009099146062885595, 78212830841718923454860500909937415074, 298786632434001059983464017498337421017, 199145596751140263536750198974934179543, 36823030246889011032650242682990532965, 24486744694186077944690812712625700252, 311412212217171220921307336279537104746, 203812139832540164401646761527924593664, 131433431620300041136869475892101932097, 100013166677348130136700153378461214928, 1240164989962753144134398014079778132, 333813342045289381941109402636174024083, 82755280788386660078098968084196889355, 295098077903284582688782375602049808627, 27424072809563626281250247467949544, 31562651104915696469600847718867096096, 240158354290570560554745863597358614972, 271231058954677930709257044367051276318, 114563868274458901419732898948296811447, 316055034299640069204180263594182125514, 228945210964305542468688694454113561478, 33262274279841947452889998786819508282, 311834269687606123984545667398092365696, 95658629190199847453148899091608095433, 13216595739765250008498910608507741712, 53861558900560771392139046557640712911, 34852205182442899265109348874696038375, 85875778838538339931658360849769992733, 51841527597334106453520497065102706362, 337874798195771333085836189518334851574, 41954040320275409426110423815876557974, 292102522323218830108986696377990234141, 15807766170935111646079149439999120859, 323786079481552542009512417369903282964, 105274389350983740193610754969446582116, 310793948098751799028340281939242317612, 215708789645785399048300688542155676120, 45779951155806413777546503332729210537, 323325492971331585425073420911076052559, 76854830228624058075492423811029329643, 331637392031636461554686893753863582024, 261116403824953902955239350989785566979, 57296170865309129730037968845030068181, 46417363655538628807633955451114372135, 309228640871831639179401006070168214443, 335568214386607996282409116715379675203, 226855102864789948136965248168622034558, 268637435236947870045508216128834936438, 32152850833821839147238581536159728009, 292082509319558615015851381902946646047, 272923016340320562270065590621778209495, 20021035562231683568542361230667163915, 107293395070439196224197159059492688732, 325248469735505466741495213976513845745, 309484862032391792578996838529253902905, 14258821355143443193323255083674533328, 306139176857915741702493144193390326561, 316128985940023129815601120077802113466, 234603751237628042851564576757573024580];
    
    let actual_diff_f128:Vec<Fp> = actual_diff.iter().map(|&a| Fp::from(a)).collect();
    
    let test_sub:Vec<Fp> = a.iter().zip(b.iter()).map(|(&a,&b)| Fp::from(a) - Fp::from(b)).collect();
    assert_eq!(actual_diff_f128, test_sub)
}

#[test]
fn base_mul_test() {
   let a: [u128; 100] = [174406971591187532577705298530619297067, 273353028293521134949622872099189388256, 198981816169985501641346527210182162568, 266968125559646267477442838834337788083, 283611569930382170543797387556786379993, 294005113981518242532751606844460156755, 210732426404757464420338703701598751623, 248629953311415512231700469440262894065, 301067984250527614521955973089951710131, 300541728442683048701600656120512381730, 328251708715830175291910815737759552519, 293573563608851668446059642854917948514, 209991387440891093216292930727030725008, 269814779980830229126089063542909050830, 283127497541056998028010894720264869718, 318332808602522965056875924436433937079, 246564613855769992364459547145478990710, 267893748327116225790788212602782700875, 277441184223231718499039856054824479977, 307379648796213556060906100102431002866, 204156632252328444272210650246072601792, 266161027224865530911247179221639154823, 290681593512253573022199871945928392173, 226994754062744436272311197990129751829, 263500661401797224165785434518081132927, 214611557385190178563975370685743774858, 226699703760093194810901962675950842193, 189348118647373921500161996758990638689, 171354918074974526091680703557935224852, 230219402513511552661259494156641323727, 261936105219404796587420984104306950114, 302586702473153683517790117847281515155, 207562456976658795859089815138473200076, 234620263481478077667663107645333133424, 200608582974468186940862776793324866372, 227642739967391709125974048156019925208, 177476305387885923625556941151867829108, 285840390245801352027750853020225443155, 275623215861777922285827585986629135501, 207252424968247720425173048612470511188, 184963389035847465016368421426649833334, 231832770651334170648059077772857143196, 323591133055692951129187463266588937484, 205212211621986006608539427413824555398, 179447058542990065180216122399111317042, 250604600273304930320763015307891253469, 261431978981259678351703972456106709589, 240431756598800771820483111003824160836, 195694955681705789199144659657748352464, 308840952762164815563403493808449488382, 301061493274618792902931005800466873424, 300832066491507440246527377162476062013, 260390111731085200071377235215593088894, 286819110407827932732524931380550938317, 253006067564119864218534975283077258386, 178142023420163004656832803426678084966, 260577369348379108805214349137287127690, 226192344752234292386443876995211991478, 203370514551421496915834667254781615590, 329050953312042147915396811743193441892, 181566191693489726745036506250149601144, 189315886774540971768846357162454904318, 213776461720607525871017077856134245262, 219808710268616328585999447625827969004, 323606520381566497629725356479691541937, 251854458876219917904372933515284831197, 323462134996048656473293650701159402547, 270212435678530101376424604960680211667, 305337634168873644454739545569990473705, 275439646257100762489959591393973837669, 278229616727698593928971599975282595471, 336787481429331481616072165270836092809, 252321822179247184744034404064517925280, 262121214045757074094426801874969317808, 289391802164114755791445354722334628552, 293182346132637147205582082915261700671, 252367434614446978246508341287429071902, 172993424507119854686228227508956353012, 285159706837272952353542128861664342530, 189047243051601303641202590787335593391, 316157761469015661506396796541579662898, 223000960683804875337158054021708845669, 253972157925737779384962355241749120590, 241458504178745352744900612061985631045, 222302601796071233403679567140470100891, 230270555280495443463209747554449127757, 246345083094371693758864388035639480439, 174085084424215708261067864608968990931, 179548895624876743709369083813246874679, 215207169964025281188379043359686076327, 182359414140244115854161477891097494465, 224858292811209448567312375324531572861, 278747487954339590139509297069625054828, 316160657532095243047824354804693481361, 274456180119635224494017551427963964105, 211921054014305312551383131318737424629, 280589933576620290865233287231267475126, 190196479105693496182452311740744965577, 227630184444351855593884546610815383002, 219605863144177352033679176569502755697];
    let b: [u128; 100] = [219144869279903914781847181350978435516, 176532942523124545805654851786973969122, 265323234677897595829007649035347126949, 230565065491432223807777880676885238307, 320311955773880910875442119115864551065, 223429944981778806156762332038732289832, 219022710963061799561873887279038158458, 302505193887824181137338825539964029243, 268078175398344758279965849683685025081, 311553934101341713635061860623501863473, 280093269267237269844875815268472625079, 197429240569462326350853629791671038642, 200978239514513835178304242704710858278, 291218352457904147259134072204983403755, 215812238400976691189362992062340258124, 264193515551784286279257201334200385297, 250305453623463730339974355958055213818, 279869293174182091345632657039355898424, 338198699315337348865518273383664698019, 265660111283715789301628045894132992296, 232632431804554730869914942427228663801, 186523858258610815959533523080866228201, 293660212004874245907361220393676981407, 336404698877908911143539681987416561825, 322397685902507165771646803295191815033, 274744441423794217352948844231432798799, 220823866681047959762489679855751824869, 215022642271109592977849264343007365287, 319323126225831315431579717400456404318, 291390827135550181504917868859399016337, 308269541770210745021729575776186183749, 191791142178133864457733153771177363741, 198914479761092970545173733879758068452, 191936541206920876787267435815830559313, 269108159932556131422336549680473644357, 316950052928724349031108155199156902356, 317633642578225990195361379469672337588, 228618436252891052984935890691330403803, 249119419129547744789036458175734558088, 225661857869710104952495864677669872405, 223377022770086530883770720720086154403, 323614763802982786230424536580539219138, 245378302213974027674326962356651522410, 246707946108923410088449967869232095918, 320583828712788265106840481377922099036, 213781570026415919288112772624900720504, 236945234287073600407013159743481009337, 269301911302568014362550332678032017627, 332165182770104088260872456083568720337, 177407521141864774426534017916347556285, 201048326597270662766230852422005658496, 299591901501544687102392979148396283881, 266859136606734281593642390533164026348, 204063829619441272654425963296354048962, 298190356581773744993127157634772411296, 178114599347353441030551553179210135422, 229014718243463412335613501418420031594, 326316357382602195295072571351598338043, 272421822517682029669952180841475300809, 214487085037583246495663912794896630445, 205793524314788121004230800609712437167, 300653042731173892763532220662086304377, 180514187440765578418127079069314736980, 248256807501948668064828338181480564845, 227947891191366650176576457388083446504, 238637863136454667895874022906777089485, 269600576095487885081154604143518689636, 235360230496087202111315256085984173292, 219461855330335304523081184720220480972, 223598118659766656036439094328871131307, 280637185452865724306509968410692705434, 294833441109056072189961741454959534835, 300501666776966818098422265640272652676, 246313447874821962448347652434970196949, 305888089603500677245307495306176307125, 187907956781653407011971327945815118555, 281855853436633642681542617301931715827, 297567001782272919101302096920545638429, 239379755681466538575995625528935131993, 206004117001208181679503727830004502369, 239302931240391603430904372730550333255, 231645935573106877245845718221590225182, 333138121021722339893097562205708515148, 184162333313436223014862643216955562864, 175885238140532604596045611689355728756, 261324281329602267747183299438025874851, 251059235628702160939829829274004766773, 287512348480364223587477174394091917910, 251193827308867337127235425638156899778, 183054319130203442041140461823526348318, 230559271741623964301684653941895809955, 292217643391827349760621342656498324903, 258726452392107906570966935838957890913, 208867262461656046823627195745200792629, 289490077305068221215896895405195079897, 242718558902851983435760850743228483261, 266331112221476847671910032147592941798, 224339669168716217943333725501099600553, 251783565425267189241657984486758231073, 325284478827487772645489157765674692654];

    //modulo multiplication computed using sage_math

    let actual_prod:[u128;100] = [113946839711548960497731202298036420574, 55043910430494547397826318231109106736, 301357622175807858928595541600557579308, 68923406293154263469985893116234057051, 329331601858928342651080776269778155926, 184231159003090450562852716509598576638, 166180076602729855285011435129580906465, 163512894555152731111701934979880972422, 23000166112684264028530144619453010892, 230753283871539525279364910039040034965, 109376545121880229987518892549659082581, 156651480714842569247863413742364982448, 184603002380496770508935608065129922790, 261471713394191569385014657832407182207, 126287443507221338825342782603823670199, 52494561104191295724680513840850867403, 245339154414141961526481559256932881342, 301307060684678845604353646647989956713, 132859160313542011059627189143363286936, 119804529746501717907041526453895380193, 247248048443571068014367352725308968495, 336741376910910827705581086364691495477, 61985826611281005133185225888974530898, 307918956364025398128346316900112243324, 14824461416059761585057305919085138686, 14612114779878069621135880063948005334, 189052029709146116842845970462334824132, 62637873808262500636892268436437961530, 34365294834838938351038508928134108209, 161999116112012594721310061425179244289, 179509570060345258430884036455553289219, 308493470467827236309876856158773000919, 259831438457090066658102860568559954351, 20915039633039710170893481041953077320, 79652193385612855992293650104187410796, 304984371681271300009555016486038320138, 209378296348399646804168891627137938533, 319840496931930277527310035813109946849, 246036527609676601647756000989727168778, 248944712692812383840920858190420162019, 244148950107338586612592568296458971880, 96197841679481133286350459261799037237, 48640179139569082413758258069690589782, 122886614643691512068115966101721443843, 311020731579109679976596984421513704148, 147772454431185827100255291132235611031, 269430955709806822247981329900898620617, 172968694003893119189748373383574458353, 27481879072909100424202054523806318016, 160031458037752735005188773555904078824, 325547316572344146457093960972059696557, 294209738233733168301213098130024199728, 304699339695592971010911104334690233561, 218778555135571892012063030242158335600, 127018450809217225704793422241662258252, 95038158206628203394012991933021363397, 146793667295518434241403637294640690834, 240298180869148228747823337980728058129, 191804878859386241492207656825049904581, 18541736620320292236680440857759382157, 166510707903204675482271885039451454941, 41121302957427214733511870371789528041, 64145571983749273801222966754562657341, 305465281352670273884996875989202531062, 266773241592141423073108209457619725380, 198718802972465120852656983547335966148, 23289193387126679262869021738080981262, 263711579203335397287771947643104770155, 28921849263784960491461738759093197230, 155062898342570498764741101395649930233, 326780279134966784530793313452783855270, 317266851305547609074455854776344174459, 201070089848556654816939363459076396992, 202042472212688895635206404871113988281, 311752314516546909874279324723013612844, 319091469338862562213201117033396429818, 49608668342259476149831356988306787863, 49700397983727425653243387688830603648, 317792147525888163872546178236547136723, 23304131263900468640511259950973499116, 238733272764711522190453884038678900000, 177424513495761905290148088075536331421, 170111896072098289890054327161120960341, 329090864414987233317724297775865646636, 209303230195624534457123738037038155049, 295983982292625742621739093797821535761, 17545812692009166444935713498492650652, 290461504835708016391998931577275929139, 220571128164730878179399481190081833534, 45999073697481342463845304020930536774, 268924571120107822850854232417516397348, 197551025221142254021527963986682220846, 257040942355158835699891690675939472844, 139377613123553119547118409138204298122, 241688904132419700867360051033342724666, 234478769564487533018165757146837882084, 255222999090926567942666002705571220642, 268182521742595893032990766123882512740, 170760158026369133109155755741919852548, 308608547496182289152812637144625562019];
    
    let actual_prod_f128:Vec<Fp> = actual_prod.iter().map(|&a| Fp::from(a)).collect();


    let test_mul:Vec<Fp> = a.iter().zip(b.iter()).map(|(&a,&b)| Fp::from(a) * Fp::from(b)).collect();
    assert_eq!(actual_prod_f128,test_mul)
}
#[test]
fn base_inv() {
     let b: [u128; 100] = [219144869279903914781847181350978435516, 176532942523124545805654851786973969122, 265323234677897595829007649035347126949, 230565065491432223807777880676885238307, 320311955773880910875442119115864551065, 223429944981778806156762332038732289832, 219022710963061799561873887279038158458, 302505193887824181137338825539964029243, 268078175398344758279965849683685025081, 311553934101341713635061860623501863473, 280093269267237269844875815268472625079, 197429240569462326350853629791671038642, 200978239514513835178304242704710858278, 291218352457904147259134072204983403755, 215812238400976691189362992062340258124, 264193515551784286279257201334200385297, 250305453623463730339974355958055213818, 279869293174182091345632657039355898424, 338198699315337348865518273383664698019, 265660111283715789301628045894132992296, 232632431804554730869914942427228663801, 186523858258610815959533523080866228201, 293660212004874245907361220393676981407, 336404698877908911143539681987416561825, 322397685902507165771646803295191815033, 274744441423794217352948844231432798799, 220823866681047959762489679855751824869, 215022642271109592977849264343007365287, 319323126225831315431579717400456404318, 291390827135550181504917868859399016337, 308269541770210745021729575776186183749, 191791142178133864457733153771177363741, 198914479761092970545173733879758068452, 191936541206920876787267435815830559313, 269108159932556131422336549680473644357, 316950052928724349031108155199156902356, 317633642578225990195361379469672337588, 228618436252891052984935890691330403803, 249119419129547744789036458175734558088, 225661857869710104952495864677669872405, 223377022770086530883770720720086154403, 323614763802982786230424536580539219138, 245378302213974027674326962356651522410, 246707946108923410088449967869232095918, 320583828712788265106840481377922099036, 213781570026415919288112772624900720504, 236945234287073600407013159743481009337, 269301911302568014362550332678032017627, 332165182770104088260872456083568720337, 177407521141864774426534017916347556285, 201048326597270662766230852422005658496, 299591901501544687102392979148396283881, 266859136606734281593642390533164026348, 204063829619441272654425963296354048962, 298190356581773744993127157634772411296, 178114599347353441030551553179210135422, 229014718243463412335613501418420031594, 326316357382602195295072571351598338043, 272421822517682029669952180841475300809, 214487085037583246495663912794896630445, 205793524314788121004230800609712437167, 300653042731173892763532220662086304377, 180514187440765578418127079069314736980, 248256807501948668064828338181480564845, 227947891191366650176576457388083446504, 238637863136454667895874022906777089485, 269600576095487885081154604143518689636, 235360230496087202111315256085984173292, 219461855330335304523081184720220480972, 223598118659766656036439094328871131307, 280637185452865724306509968410692705434, 294833441109056072189961741454959534835, 300501666776966818098422265640272652676, 246313447874821962448347652434970196949, 305888089603500677245307495306176307125, 187907956781653407011971327945815118555, 281855853436633642681542617301931715827, 297567001782272919101302096920545638429, 239379755681466538575995625528935131993, 206004117001208181679503727830004502369, 239302931240391603430904372730550333255, 231645935573106877245845718221590225182, 333138121021722339893097562205708515148, 184162333313436223014862643216955562864, 175885238140532604596045611689355728756, 261324281329602267747183299438025874851, 251059235628702160939829829274004766773, 287512348480364223587477174394091917910, 251193827308867337127235425638156899778, 183054319130203442041140461823526348318, 230559271741623964301684653941895809955, 292217643391827349760621342656498324903, 258726452392107906570966935838957890913, 208867262461656046823627195745200792629, 289490077305068221215896895405195079897, 242718558902851983435760850743228483261, 266331112221476847671910032147592941798, 224339669168716217943333725501099600553, 251783565425267189241657984486758231073, 325284478827487772645489157765674692654];

    //modulo inverse of b computed using sage_math

    let actual_inv:[u128;100] = [206912233196642468111727034786360517640, 15860226735274797670491021741725943311, 48411775267644425919072359560834993373, 2882818729843352674083064761329029994, 233733279659131653662297661969174184099, 81227049001306794167029467173818241317, 154873957096727415799718312025415198071, 223563728153733967084596176606032865809, 158984881854806888013733930485940985044, 195603336961956613757144659889214492840, 178205570461787794200155489202288630180, 187515301053299497372240838504232474809, 164494533009144679587182424737493236125, 200720180800141915813910558089422231433, 335933056196080857459331521855307114484, 139924486603535676030960392288270321308, 35424689022917755543399451295819611326, 37677280681808418236887412375776125790, 119398160532805505461355121893009624281, 106572823352786596524565471650715110799, 191231979685556415066917714138872650034, 135514603457813708611352801188534929321, 275685444951014497704828182987714089255, 225593666421673664689974935171377022179, 80102318836393827004206076783222998691, 200521692020792278174753808003470795357, 291566352133258541315850162908231887959, 252710728700442771274174885505731728038, 5830642517189879913767166705662422140, 220162531198706628348376887069084776481, 275186967620496546471082869194367930694, 174977993932022187727012608240083126637, 320584046811645287188629176331433184305, 141413633738645255228249457309653892898, 258884596302913345174539561533466526510, 282383672652650741110589843594452132854, 270401040378517558854952247831909947760, 16889383903361870501996472921278792940, 114066056372064160008167559722309256642, 329828966637288438624511680693082823233, 240053550738493241768464870043091721731, 136795781509638670147011677923886916014, 26003451894064689380710584594740338385, 289191349055643450034775551788845636531, 15004379434241027194377137395942140244, 23113941108997734053786840905373088818, 260396414441283467014367436079861194487, 169433106790574702467509212526374958054, 189248282996449258571046674732034911584, 63224260192509889264074121036246211479, 270345969844488496704700316951426791034, 150645935482591227362313600993434470407, 95949868955818607119524450842644763072, 67909275114031920156117646778359147873, 179314256503867511239957232891025698786, 277466796856014195787244788848771393543, 216293868388605520009995844060346793813, 274084358428039470517396782340328587790, 11325353193004879211419883695323788133, 324999277273771941169529023310719935808, 128393533055002106784799096045316168724, 186117959282408830123479497317062740030, 320638476531465960666693175091089533830, 102645367868106017299522146637062618314, 188306004894626785202820472195102250189, 324320147661193229899652053408879443190, 138168908826587328903401518882934518078, 44913326804363381957400141047635554557, 197532302823230386105565238561364203085, 216621149537018724250699848012870714806, 132942676513744899336822203869896750255, 92706248639774221783377975181280267122, 144006397245458256732219140026390431978, 217183249763052849425851536549072061860, 62178308273946893858002981098901028675, 165232645607221377591348279523488475236, 254380759395270275435856667315267254692, 168255204485852417778088218960973338676, 329349761653880070273964390033624274834, 195161667113462996142674989228582162731, 152386892427068363620874352432073309570, 337032304490593220941901762120744482139, 207016312891463997529993425867259039499, 211974381852352086219157437699596260722, 265093937995323665812119857165276141375, 99521901783837798724552565131900488577, 201787448910428276016854821504023605611, 304518174917369260735705822394249207371, 246339353383485306386686729307107020057, 43376832633955290036922218700874881790, 127889505320068154361227737905378005031, 206550929739394361886965325378554056089, 51164519994648750142234575179818058173, 8352641236164161755702299169381437229, 320514015825650741060865626659848085521, 13362836180969195655638086984665754473, 247644619882147675272350671341630445163, 301350056874286357361451892396955649598, 260158386693662804411346608584464819001, 38257513952135553995639974547121293351];
    
    let actual_inv_f128:Vec<Fp> = actual_inv.iter().map(|&b| Fp::from(b)).collect();
    
    let test_inv :Vec<Fp> = b.iter().map(|&b| Fp::from(b).invert().unwrap()).collect();

    assert_eq!(actual_inv_f128,test_inv)
}

#[test]

fn base_div_test(){
let a: [u128; 100] = [174406971591187532577705298530619297067, 273353028293521134949622872099189388256, 198981816169985501641346527210182162568, 266968125559646267477442838834337788083, 283611569930382170543797387556786379993, 294005113981518242532751606844460156755, 210732426404757464420338703701598751623, 248629953311415512231700469440262894065, 301067984250527614521955973089951710131, 300541728442683048701600656120512381730, 328251708715830175291910815737759552519, 293573563608851668446059642854917948514, 209991387440891093216292930727030725008, 269814779980830229126089063542909050830, 283127497541056998028010894720264869718, 318332808602522965056875924436433937079, 246564613855769992364459547145478990710, 267893748327116225790788212602782700875, 277441184223231718499039856054824479977, 307379648796213556060906100102431002866, 204156632252328444272210650246072601792, 266161027224865530911247179221639154823, 290681593512253573022199871945928392173, 226994754062744436272311197990129751829, 263500661401797224165785434518081132927, 214611557385190178563975370685743774858, 226699703760093194810901962675950842193, 189348118647373921500161996758990638689, 171354918074974526091680703557935224852, 230219402513511552661259494156641323727, 261936105219404796587420984104306950114, 302586702473153683517790117847281515155, 207562456976658795859089815138473200076, 234620263481478077667663107645333133424, 200608582974468186940862776793324866372, 227642739967391709125974048156019925208, 177476305387885923625556941151867829108, 285840390245801352027750853020225443155, 275623215861777922285827585986629135501, 207252424968247720425173048612470511188, 184963389035847465016368421426649833334, 231832770651334170648059077772857143196, 323591133055692951129187463266588937484, 205212211621986006608539427413824555398, 179447058542990065180216122399111317042, 250604600273304930320763015307891253469, 261431978981259678351703972456106709589, 240431756598800771820483111003824160836, 195694955681705789199144659657748352464, 308840952762164815563403493808449488382, 301061493274618792902931005800466873424, 300832066491507440246527377162476062013, 260390111731085200071377235215593088894, 286819110407827932732524931380550938317, 253006067564119864218534975283077258386, 178142023420163004656832803426678084966, 260577369348379108805214349137287127690, 226192344752234292386443876995211991478, 203370514551421496915834667254781615590, 329050953312042147915396811743193441892, 181566191693489726745036506250149601144, 189315886774540971768846357162454904318, 213776461720607525871017077856134245262, 219808710268616328585999447625827969004, 323606520381566497629725356479691541937, 251854458876219917904372933515284831197, 323462134996048656473293650701159402547, 270212435678530101376424604960680211667, 305337634168873644454739545569990473705, 275439646257100762489959591393973837669, 278229616727698593928971599975282595471, 336787481429331481616072165270836092809, 252321822179247184744034404064517925280, 262121214045757074094426801874969317808, 289391802164114755791445354722334628552, 293182346132637147205582082915261700671, 252367434614446978246508341287429071902, 172993424507119854686228227508956353012, 285159706837272952353542128861664342530, 189047243051601303641202590787335593391, 316157761469015661506396796541579662898, 223000960683804875337158054021708845669, 253972157925737779384962355241749120590, 241458504178745352744900612061985631045, 222302601796071233403679567140470100891, 230270555280495443463209747554449127757, 246345083094371693758864388035639480439, 174085084424215708261067864608968990931, 179548895624876743709369083813246874679, 215207169964025281188379043359686076327, 182359414140244115854161477891097494465, 224858292811209448567312375324531572861, 278747487954339590139509297069625054828, 316160657532095243047824354804693481361, 274456180119635224494017551427963964105, 211921054014305312551383131318737424629, 280589933576620290865233287231267475126, 190196479105693496182452311740744965577, 227630184444351855593884546610815383002, 219605863144177352033679176569502755697];
let b: [u128; 100] = [219144869279903914781847181350978435516, 176532942523124545805654851786973969122, 265323234677897595829007649035347126949, 230565065491432223807777880676885238307, 320311955773880910875442119115864551065, 223429944981778806156762332038732289832, 219022710963061799561873887279038158458, 302505193887824181137338825539964029243, 268078175398344758279965849683685025081, 311553934101341713635061860623501863473, 280093269267237269844875815268472625079, 197429240569462326350853629791671038642, 200978239514513835178304242704710858278, 291218352457904147259134072204983403755, 215812238400976691189362992062340258124, 264193515551784286279257201334200385297, 250305453623463730339974355958055213818, 279869293174182091345632657039355898424, 338198699315337348865518273383664698019, 265660111283715789301628045894132992296, 232632431804554730869914942427228663801, 186523858258610815959533523080866228201, 293660212004874245907361220393676981407, 336404698877908911143539681987416561825, 322397685902507165771646803295191815033, 274744441423794217352948844231432798799, 220823866681047959762489679855751824869, 215022642271109592977849264343007365287, 319323126225831315431579717400456404318, 291390827135550181504917868859399016337, 308269541770210745021729575776186183749, 191791142178133864457733153771177363741, 198914479761092970545173733879758068452, 191936541206920876787267435815830559313, 269108159932556131422336549680473644357, 316950052928724349031108155199156902356, 317633642578225990195361379469672337588, 228618436252891052984935890691330403803, 249119419129547744789036458175734558088, 225661857869710104952495864677669872405, 223377022770086530883770720720086154403, 323614763802982786230424536580539219138, 245378302213974027674326962356651522410, 246707946108923410088449967869232095918, 320583828712788265106840481377922099036, 213781570026415919288112772624900720504, 236945234287073600407013159743481009337, 269301911302568014362550332678032017627, 332165182770104088260872456083568720337, 177407521141864774426534017916347556285, 201048326597270662766230852422005658496, 299591901501544687102392979148396283881, 266859136606734281593642390533164026348, 204063829619441272654425963296354048962, 298190356581773744993127157634772411296, 178114599347353441030551553179210135422, 229014718243463412335613501418420031594, 326316357382602195295072571351598338043, 272421822517682029669952180841475300809, 214487085037583246495663912794896630445, 205793524314788121004230800609712437167, 300653042731173892763532220662086304377, 180514187440765578418127079069314736980, 248256807501948668064828338181480564845, 227947891191366650176576457388083446504, 238637863136454667895874022906777089485, 269600576095487885081154604143518689636, 235360230496087202111315256085984173292, 219461855330335304523081184720220480972, 223598118659766656036439094328871131307, 280637185452865724306509968410692705434, 294833441109056072189961741454959534835, 300501666776966818098422265640272652676, 246313447874821962448347652434970196949, 305888089603500677245307495306176307125, 187907956781653407011971327945815118555, 281855853436633642681542617301931715827, 297567001782272919101302096920545638429, 239379755681466538575995625528935131993, 206004117001208181679503727830004502369, 239302931240391603430904372730550333255, 231645935573106877245845718221590225182, 333138121021722339893097562205708515148, 184162333313436223014862643216955562864, 175885238140532604596045611689355728756, 261324281329602267747183299438025874851, 251059235628702160939829829274004766773, 287512348480364223587477174394091917910, 251193827308867337127235425638156899778, 183054319130203442041140461823526348318, 230559271741623964301684653941895809955, 292217643391827349760621342656498324903, 258726452392107906570966935838957890913, 208867262461656046823627195745200792629, 289490077305068221215896895405195079897, 242718558902851983435760850743228483261, 266331112221476847671910032147592941798, 224339669168716217943333725501099600553, 251783565425267189241657984486758231073, 325284478827487772645489157765674692654];

let actual_div: [u128; 100] = [138698342085680270452587865137131323106, 164191899769611895671339206099487955115, 314807321725345321830890043547796293981, 15491392916812381913510994350607451922, 125349538633633231398315961036182485453, 75325668226636320776093580237667311105, 281826035710375536822326214912328735053, 97792884631160039824013220130190284107, 116196365871094044380792323220129657093, 314942179661785965346625053153735782610, 193842072047593383690050130587798939619, 132112810746224193882692885276764169631, 147796307287112370033477828158344369767, 191420398980264970432184704819035783976, 159364198997633505504068326347407804430, 149306630222033235406748798047109273113, 86747003456112093304953987367357339595, 228676659758075897527999065579995814637, 138247954270138123406813659283670091804, 50407756452032679268481601022794158376, 176852634910098567745225519935439183444, 136789181301344158827685305630900119596, 168765479188668139543968780566509513675, 160265244944696679145803986403743019118, 261822676536989621456793698429199013117, 116957473061719302136318509309314239967, 151616495333091941250383293325275368352, 268491402234387452024964037298105192704, 200480432666817863247611250504010859765, 136914717851976046523887419969106854159, 227622591105671392424013111070338061380, 192501701059994184852737895493641708589, 87930502801569404638832785954608496811, 39223696783670880164392625862449713191, 16111125700968907389457234304291707143, 119082727625066904592345598511188468185, 278318420553568340730815773725174869017, 289844441109794112531160754218473839949, 23141223472889459438315324547064750445, 265277448344504096196389871323939349488, 176021342375593787720144084745323479248, 35319872567263742174957408696451347222, 258939966009432247921855820211877148687, 152476046120395335650571043128968652197, 239625048853482797002148000622302653386, 301040348661053847048133235650638224274, 334870709148911271350013804552950212379, 6540282060882226972555108669657986027, 167231273114818209463197812739574981303, 57994213955318964573870710525580796836, 98772647678172499476695195234390112340, 10163231889727249885864321385491689662, 39730284763701378686755222310018129168, 101633562371010342539802033564851492385, 62155157725969964396246185706796110349, 289839361041545673694378897758201740553, 305192652895582424471576308960294409597, 125942722193429434540536674111124366634, 165601086566723181338516199000939432477, 251050988896523076138299340651501653683, 79827391642354632645789874414322452043, 109454654763460688350385028398434113052, 187683930158329446447609016970159021958, 224310787551629854135965386157067671223, 289840295924337825289799104400075779324, 103299863799100601348916089166296926477, 63086183999446385271553845108392708471, 16658559181733939385426039879698484901, 45539106235512393402578633817018402021, 125096912698937108225014104391388113765, 106364145047446169768513280873755450671, 289229989881594203957802495389761548426, 103237270330286324198662210821352338524, 257168567837788571477398735746325695705, 211466686747339056160385080835846239913, 27884132470464198060866235189846502609, 99329231057334900043102323059371579169, 11478390456694082192255524416295463193, 331276697982674825791092633642156855176, 257474737785618180032335772812280830747, 16719965390983258968429815905332259497, 38561623563766438409487392774193059163, 89780089957115536078983437735855555118, 226999379987947233720206506217681529595, 198175377040659155424050101596648121557, 315628305012426858832847348216955842650, 183036962100799635734390559816357445539, 278194703240840001387810799542680208758, 101703494245329406961151232918921186782, 249849222327435754340402551287264681961, 274958965666155503291541494300449575148, 216375066771988890029096009199327199559, 86287815830617405716858704887394322224, 263854215143413534326740818019632046187, 70387828114648351972090204320990082245, 4529173771677852294121805812301822322, 88419528362212278876131818421375054291, 308354548786229960449680983539306705687, 63449747344466766186603870267763017867, 48327013132215698629976549895791510578];

let actual_div_f128:Vec<Fp> = actual_div.iter().map(|&a| Fp::from(a)).collect();

let test_div: Vec<Fp> = a.iter().zip(b.iter()).map(|(&a,&b)| Fp::from(a)/Fp::from(b)).collect();

assert_eq!(actual_div_f128,test_div)
}

#[test]
//Checking that get_root_of_unity function returns a primitive root of unity.
fn get_root_of_unity(){
    for i in 1..40{
        for j in 1..i{
            assert_ne!(Fp::ONE, Fp::get_root_of_unity(i).exp(1u128<<j));
            println!("2^{}th root of unity: {:?}^(2^{}) = {:?}",i, Fp::get_root_of_unity(i),j, Fp::get_root_of_unity(i).exp(1u128<<j))
        }
        assert_eq!(Fp::ONE, Fp::get_root_of_unity(i).exp(1u128<<i));
        println!("2^{}th root of unity: {:?}^(2^{}) = {:?}",i, Fp::get_root_of_unity(i),i, Fp::get_root_of_unity(i).exp(1u128<<i))
    }

    
}




//=================== QUADRATIC EXTENSION TESTS ====================

#[test]

fn add_test(){
    //f2_a and f2_b are arrays of integer doubles that are less than the modulus. Each entry has been uniformly sampled from the range (M/2, M)
    //so the test checks appropriate wrap-around behavior.

    let f2_a: [[u128; 2]; 100] = [[174406971591187532577705298530619297067, 219144869279903914781847181350978435516], [273353028293521134949622872099189388256, 176532942523124545805654851786973969122], [198981816169985501641346527210182162568, 265323234677897595829007649035347126949], [266968125559646267477442838834337788083, 230565065491432223807777880676885238307], [283611569930382170543797387556786379993, 320311955773880910875442119115864551065], [294005113981518242532751606844460156755, 223429944981778806156762332038732289832], [210732426404757464420338703701598751623, 219022710963061799561873887279038158458], [248629953311415512231700469440262894065, 302505193887824181137338825539964029243], [301067984250527614521955973089951710131, 268078175398344758279965849683685025081], [300541728442683048701600656120512381730, 311553934101341713635061860623501863473], [328251708715830175291910815737759552519, 280093269267237269844875815268472625079], [293573563608851668446059642854917948514, 197429240569462326350853629791671038642], [209991387440891093216292930727030725008, 200978239514513835178304242704710858278], [269814779980830229126089063542909050830, 291218352457904147259134072204983403755], [283127497541056998028010894720264869718, 215812238400976691189362992062340258124], [318332808602522965056875924436433937079, 264193515551784286279257201334200385297], [246564613855769992364459547145478990710, 250305453623463730339974355958055213818], [267893748327116225790788212602782700875, 279869293174182091345632657039355898424], [277441184223231718499039856054824479977, 338198699315337348865518273383664698019], [307379648796213556060906100102431002866, 265660111283715789301628045894132992296], [204156632252328444272210650246072601792, 232632431804554730869914942427228663801], [266161027224865530911247179221639154823, 186523858258610815959533523080866228201], [290681593512253573022199871945928392173, 293660212004874245907361220393676981407], [226994754062744436272311197990129751829, 336404698877908911143539681987416561825], [263500661401797224165785434518081132927, 322397685902507165771646803295191815033], [214611557385190178563975370685743774858, 274744441423794217352948844231432798799], [226699703760093194810901962675950842193, 220823866681047959762489679855751824869], [189348118647373921500161996758990638689, 215022642271109592977849264343007365287], [171354918074974526091680703557935224852, 319323126225831315431579717400456404318], [230219402513511552661259494156641323727, 291390827135550181504917868859399016337], [261936105219404796587420984104306950114, 308269541770210745021729575776186183749], [302586702473153683517790117847281515155, 191791142178133864457733153771177363741], [207562456976658795859089815138473200076, 198914479761092970545173733879758068452], [234620263481478077667663107645333133424, 191936541206920876787267435815830559313], [200608582974468186940862776793324866372, 269108159932556131422336549680473644357], [227642739967391709125974048156019925208, 316950052928724349031108155199156902356], [177476305387885923625556941151867829108, 317633642578225990195361379469672337588], [285840390245801352027750853020225443155, 228618436252891052984935890691330403803], [275623215861777922285827585986629135501, 249119419129547744789036458175734558088], [207252424968247720425173048612470511188, 225661857869710104952495864677669872405], [184963389035847465016368421426649833334, 223377022770086530883770720720086154403], [231832770651334170648059077772857143196, 323614763802982786230424536580539219138], [323591133055692951129187463266588937484, 245378302213974027674326962356651522410], [205212211621986006608539427413824555398, 246707946108923410088449967869232095918], [179447058542990065180216122399111317042, 320583828712788265106840481377922099036], [250604600273304930320763015307891253469, 213781570026415919288112772624900720504], [261431978981259678351703972456106709589, 236945234287073600407013159743481009337], [240431756598800771820483111003824160836, 269301911302568014362550332678032017627], [195694955681705789199144659657748352464, 332165182770104088260872456083568720337], [308840952762164815563403493808449488382, 177407521141864774426534017916347556285], [301061493274618792902931005800466873424, 201048326597270662766230852422005658496], [300832066491507440246527377162476062013, 299591901501544687102392979148396283881], [260390111731085200071377235215593088894, 266859136606734281593642390533164026348], [286819110407827932732524931380550938317, 204063829619441272654425963296354048962], [253006067564119864218534975283077258386, 298190356581773744993127157634772411296], [178142023420163004656832803426678084966, 178114599347353441030551553179210135422], [260577369348379108805214349137287127690, 229014718243463412335613501418420031594], [226192344752234292386443876995211991478, 326316357382602195295072571351598338043], [203370514551421496915834667254781615590, 272421822517682029669952180841475300809], [329050953312042147915396811743193441892, 214487085037583246495663912794896630445], [181566191693489726745036506250149601144, 205793524314788121004230800609712437167], [189315886774540971768846357162454904318, 300653042731173892763532220662086304377], [213776461720607525871017077856134245262, 180514187440765578418127079069314736980], [219808710268616328585999447625827969004, 248256807501948668064828338181480564845], [323606520381566497629725356479691541937, 227947891191366650176576457388083446504], [251854458876219917904372933515284831197, 238637863136454667895874022906777089485], [323462134996048656473293650701159402547, 269600576095487885081154604143518689636], [270212435678530101376424604960680211667, 235360230496087202111315256085984173292], [305337634168873644454739545569990473705, 219461855330335304523081184720220480972], [275439646257100762489959591393973837669, 223598118659766656036439094328871131307], [278229616727698593928971599975282595471, 280637185452865724306509968410692705434], [336787481429331481616072165270836092809, 294833441109056072189961741454959534835], [252321822179247184744034404064517925280, 300501666776966818098422265640272652676], [262121214045757074094426801874969317808, 246313447874821962448347652434970196949], [289391802164114755791445354722334628552, 305888089603500677245307495306176307125], [293182346132637147205582082915261700671, 187907956781653407011971327945815118555], [252367434614446978246508341287429071902, 281855853436633642681542617301931715827], [172993424507119854686228227508956353012, 297567001782272919101302096920545638429], [285159706837272952353542128861664342530, 239379755681466538575995625528935131993], [189047243051601303641202590787335593391, 206004117001208181679503727830004502369], [316157761469015661506396796541579662898, 239302931240391603430904372730550333255], [223000960683804875337158054021708845669, 231645935573106877245845718221590225182], [253972157925737779384962355241749120590, 333138121021722339893097562205708515148], [241458504178745352744900612061985631045, 184162333313436223014862643216955562864], [222302601796071233403679567140470100891, 175885238140532604596045611689355728756], [230270555280495443463209747554449127757, 261324281329602267747183299438025874851], [246345083094371693758864388035639480439, 251059235628702160939829829274004766773], [174085084424215708261067864608968990931, 287512348480364223587477174394091917910], [179548895624876743709369083813246874679, 251193827308867337127235425638156899778], [215207169964025281188379043359686076327, 183054319130203442041140461823526348318], [182359414140244115854161477891097494465, 230559271741623964301684653941895809955], [224858292811209448567312375324531572861, 292217643391827349760621342656498324903], [278747487954339590139509297069625054828, 258726452392107906570966935838957890913], [316160657532095243047824354804693481361, 208867262461656046823627195745200792629], [274456180119635224494017551427963964105, 289490077305068221215896895405195079897], [211921054014305312551383131318737424629, 242718558902851983435760850743228483261], [280589933576620290865233287231267475126, 266331112221476847671910032147592941798], [190196479105693496182452311740744965577, 224339669168716217943333725501099600553], [227630184444351855593884546610815383002, 251783565425267189241657984486758231073], [219605863144177352033679176569502755697, 325284478827487772645489157765674692654]];
    let f2_b: [[u128; 2]; 100] = [[308952369500670449439528974078638856322, 312060782669695918279236300205228036550], [332139335567313838605424762155618996302, 304914288737209928836335437593295369251], [187813176247726390171868653858627204898, 190490230261523069592228138513188474270], [329261206314728232738310413309920396772, 179235429852190745898283297311367652377], [325354051654780761776638268628177078890, 324205066583550203280610719442830528195], [182829934919023643454729428270035393381, 182474281329811147046528600310534912736], [296705992984758357482837468528080799798, 337787214942738552073741233432123811001], [170456630767760171449637532287884159766, 205770390831338324767807128143312145588], [318454801747612778059950388973124643911, 282441078182195496116481678310242897249], [199614830160497803767111027322945406394, 170767108835369152512069031621629133310], [286099857605814991354149364764438179114, 288042366421119657934785519100170730057], [284972827975029105804010017017216607004, 292834150427608935542467625344466998367], [222442312984086401794643212871165669277, 338374958290032846479040814169955973118], [311412188416449827456940552096383109590, 298709341681257208135691070369334188486], [253185264993940074345755783409411188065, 246560279473299414355163147341725805365], [284962062297479862853548352023640537713, 205238043429478236902872563990455475128], [200469882203578305107119232927514783664, 288124732903370820506976684009068163535], [301960453030629360791160282409956942811, 266446943037249378236972666580535263815], [333314437553769013168096943622752137158, 291108401241109358391911452321262535734], [333591350862527112608449598805040031470, 284718536088399058700861480741563694076], [193302593060888769258844812517289955594, 170710577032583090125869558675220645242], [180444790489426333340294178870171828241, 194984378678097079930008296395285104258], [283341455012975095064937359348745084528, 326682747702724760264268907385330396173], [213321803685512380827717791703027107817, 335307317705409907776862766471807548366], [258668569596199460598322404145335028940, 235793401403758251915950798246512708497], [288747840899594244985154292835940355834, 193999535902873887715317708230350459778], [180426217538849536854032936408089304331, 224319209016700946449044016911279992285], [249601426024642662401063128395573646235, 314038033029503383511028889039408957987], [295792491407573845107686310508769863974, 192637968641716413336967442829621324246], [269180927676266372351410881389571410214, 262703749702567186019744293283669267598], [291217349328060380300575769340319954021, 287178476395255436814949722598137024890], [178379715013985573076049444065470154703, 279834369291394317847131663848892816110], [205729911716145446066121402996684167933, 325366247652056733364829347158602796836], [208605005535310934039386510923381744132, 177676400578315947396202635296311566538], [305285473512022524450103847865338359466, 175971312511585058555413698450782255612], [229553166632429194672384240229609619509, 198139189167155303609918186611918602926], [230910685127622921218619026404037177031, 171522864043818459103253603333226470246], [184918539956477480306971848424921015173, 178235576387608228047519943540311973277], [301138608710716288935613312406925802351, 265613802942803275557375364936092731181], [307586671709241018238840829673952968356, 280226296903574093750779425405465366009], [263595525692507907265084644452555322423, 206758076098848354680614159897532345223], [221014513621512897850214218784028069602, 211859432052588317847187903900179213154], [280065174154683459233739645541602269435, 332222234697679178247664036870540377119], [171642642345265115810485134431747692775, 195954359085860892545321770401565070596], [326538377762332527105363714083557661090, 206118649480395966797850942668509705256], [230531157157034655218596856275457967122, 278879737426111128292080715951988224888], [294267943329046506728469886939110707317, 251557307288840761374082146664943220399], [339779509773580817369188711320032722335, 257305684660530668831544363967769224974], [248866211643271047664391416085965948041, 311772694146790801169008382119083417525], [226677881669551053364680291866168279037, 310267783552082303182819795193873840639], [332760714745168434034607429594006079601, 226436511605227556040791031612871549779], [212753215123521436322132760157948407646, 306220729045238098171470847341694249464], [328682384706243774314436736764223820125, 255405490934377165878738593012828292528], [185810599061174559699829293266736865809, 316747986856770560764742513507258920372], [324543966366582741204628877582623786782, 185111499967856698959536786931758767877], [329324158603550663631124373139872889963, 290810761974936501759367769667878966197], [193328439156425880652797521721270855677, 336199421625272156510862232737282208025], [271984380962099771177729065072923884027, 246497734780688601780570619011935459061], [190469843547860200001260510097408045609, 268820700910006049761050282636867615034], [211417318689812929757076585128587634388, 217636899532821099528736745894897785223], [190876805948095467751547943955648826189, 245006346538688033564458332718388143838], [188251078757953246621324056993259795117, 225318995072076288517253781569562314489], [202292490294944402299818938984496629345, 240557553305379596557655645802026128194], [262539911809149162521377978584612735883, 254556483906734750516854706617712774871], [173848457034150260354443330599820658193, 297163647488881454815500556391055119352], [219493617018342747713032495351632051827, 187878979825127912400782858316183399167], [325221145828899911165987686973546333082, 304185903076241709496793630344385502401], [311009494776135366540471852076046893197, 334676442202365476582969659923417599974], [298087081678182501517781000133826586871, 283069170218850974331980702062854890099], [182497615246871695912509601645518579137, 323460638954100426280127324012845356594], [263969549884310718099911125716026411229, 196386246865999653051852718990952549797], [236102338802645651616425168537643176951, 224431186205169890323552223910530109802], [173229754870019219102103847771482557985, 269830339850374171311805130225546554382], [222293639913106334732607011121511179514, 269187234358147711678596427326809056927], [182689953649613549628386449959696622056, 213918164903751075326425749496315530990], [213434707336016490324112191217828255691, 251956117455235122871962804472932345781], [331902161002113254243564390909408938463, 206488184696768654765829643929013042401], [201769189004384972412651138302202510492, 222918959743203929924232288406213652596], [307985422964117273646236015626162697823, 291074392354212447298884393082962646692], [250414424406498210869227326440243194428, 204338863964986045417165863926317869049], [200498089961873543514910995601010338266, 298901362814386471218774469150903187504], [223188124319866465556851256933735859034, 329051437591060882594725930339891673592], [298229165148893501884150828191947303551, 269953245665952630394445582648028061871], [249004789129553110068172434340965142504, 302162586514640545130564792895850313073], [309750546813556980964398246868926744080, 337411319297314100308829140554946374967], [254837705867891706116944016386013802958, 315914045483830667626721921695262636780], [272842909726799011503799607901574070530, 170892855775935873283349074923806208284], [302224136917079014849504540590796541531, 228835479449188583251934973507933127122], [208659306963321091776538586694897938984, 180842097146239808395189868729224004386], [320387488897279267638302198260127246446, 326277117282078972361923082957571763270], [222806569535988766143425571588144968740, 203246941104603161599344377278472314093], [316518074599496307197558971611025222400, 180043461116888734520497481319705306675], [232404113076579833999773846116509910215, 273579381313471345530538924201674237476], [224796853841316250655878672681938733763, 246769841383527853037569146485644875418], [205216032265310336570358952832655751403, 296189950332203705518446315600313110282], [259673292517168998723991810152607680664, 226848319398376111851825047582877786299], [263430446960263199971110889067060239677, 335314681160472512153855863506369455233], [247425028346801351761963361464866080200, 292127924297224617358332318068842728883], [282701235111484633063826864873243861714, 223666169064189881377718841944197766768], [267920111895604379486980548222275372082, 308624491694471215020169490801447081007]];
    
    //Result of element-wise addition of f2_a and f2_b in SageMath when seen as elements of quadratic extension
    let quad_ext_sum: [[u128; 2]; 100] = [[143076974170919518553859714655513191852, 190923285028661369597708923602461510529], [265209996939896510091673076301063423021, 141164864339396011178615731426524376836], [46512625496773428349840623115064405929, 115531098018482201957861229594790639682], [255946964953436036752378694190513223318, 69518128422684506242686620034507929147], [268683254664224468857061098231218497346, 304234655436492650692678280604950117723], [136552681979603422524106477160750588599, 65621859390651489739916374395522241031], [167156052468577358439801614275934589884, 216527558984861888172240562757417007922], [78804217158237220217963443774402092294, 167993217798224042441771395729531213294], [279240419077201929118531804109331392505, 210236886659601790933072970040182960793], [159874191682242389005337125489712826587, 142038676015772402683756334291386035246], [274069199400706703182685622548452770096, 227853268767418464316286776414898393599], [238264024662942310786695101918389593981, 149981024076132798429946697182393075472], [92151333504039031547561585644451432748, 199070830883608218193970498920921869859], [240944601476341593119655057685547198883, 249645327218222891931450584620572630704], [196030395614058608910392120175931096246, 122090150953337642081151581450321101952], [263012503979064364447049718506329513255, 129149192060324059718755207370910898888], [106752129138409834008204222119248812837, 198147819605896087383576482013378415816], [229571834436807123118573937058994682149, 206033869290493006119230765666146200702], [270473254856062268203762241723831655598, 289024733635508243794055167751182272216], [300688632737802205205981140953726072799, 210096280451176384539114968681951724835], [57176858392278750067680904809617595849, 63060641916199357532409943148704347506], [106323450793353400788166800138066021527, 41225870015769432426167261522406370922], [233740681604290204623762673340928515164, 280060592786660542708255569825262416043], [100034190827318353636654431739411898109, 331429649662380355457027890505479148654], [181886864077058221300733280709671200330, 217908720385326954224223043587959561993], [163077031363845960085755105567939169155, 128461610405729641604891994508038297040], [66843554378004268201560341130295184987, 104860708776810442748159138813286855617], [98667177751078120437850567200819323387, 188778308379674513025503595428671361737], [126865042561609907735992456112960127289, 171678727946609265305172602276332767027], [159117963268839461549295817592467772404, 213812209917178904061287604189323322398], [212871087626526713424622195490881942598, 255165651244527718373304740420578247102], [140684050566200793130465003959006708321, 131343144548589718841490259666325218314], [73010001771865778461836660181412406472, 183998360492211240446628523084615903751], [102942902095850548243675060614969916019, 29330574864298360720095513158397164314], [165611689565552247927592066704918264301, 104797105523202726514375690177510938432], [116913539678882440334983730431884583180, 174806875174941189177651783857330543745], [68104623594570381380801409602160044602, 148874139701105985835240424849153846297], [130476563281340368871348143491401496791, 66571645719560817569081276277897415543], [236479457651555747758066340439809976315, 174450855151412556883037265158082327732], [174556729756550275200639320332678518007, 165605787852345735239900732129390276877], [108276547807416908818078507925460194220, 89852731947996422101010322663873538089], [112564917351908605034898738603140251261, 195191828934632640614237882526973470755], [263373940289437946899552550854446245382, 237318169990714742458616441273446937992], [36572487046312658955650003891827286636, 102379938273845839170397180317052204977], [165703069384384128822205278528924016595, 186420111272245768441316866092686842755], [140853390509401122075985313629604259054, 152378940531588584116818930623143983855], [215417555389367721616799301441472455369, 148220174654975898317720748454679268199], [239928899451443125726297264370111921634, 186325229042160219730720138692056281064], [104278800404038373400161517789969338968, 303655509995956425966506280248907176325], [195236467510777405464709227720872805882, 147392937773008614145979255156476435387], [293539841098848763474163877440727991488, 87202471281559755343647326081132246738], [173302914694090413105285579366679508122, 265530263625844321810489268536345571808], [248790129516390510922439414026071947482, 181982260620172984009006425592247357339], [132347342548064028968979666693542842589, 180529449555273369955793918849868007797], [237267667009764141959789294911956083631, 143019489628691980489289386612786217636], [167183815102775204824582618612806013392, 128642994401351479326544764893344140082], [113623441583866525994637312904813021830, 224931772947797105383101176201957278082], [157894358793395600100798384114390913968, 232531725242352333612268632409788835567], [53557991178343233453720619398444699662, 200960156506749615967627905524597954306], [200185905080916614209098838918036114743, 91841617649465882561026100736049454131], [32160630720646731033209892252053465796, 110517503932537691105314575374355619468], [37284598611555754926795856201969737898, 185689670882311717817411444277903657329], [75786585094613464707461458886885913070, 80789373825206711512408166917595903637], [142066255156827027644002868256695743350, 162530924487744955118308486845448378179], [157172610494778294520794129125767238593, 184829171759309641528702455825393604319], [131065708973624202154030870913171921487, 86234476040644116833282323269215527115], [308400913904010104175906779720960774092, 233504112250791131114573676534159230500], [240939563533727004453521899082982143327, 229754305777514215230910358055656811729], [263142348926117682509145987750072099039, 162248658628247815391687328829330409534], [117654894583033994939094635085747455269, 206776390692928618853191860387971526364], [201916799691070848565508167737564045163, 136741065397926913894988129447900293694], [232607453311038669769122775854734308223, 178982260393287499050139407411744683100], [85269210128327940382763693882255521728, 230049639706402525946852837912074245521], [144132487037924945363659255042735535785, 175218315312031210663569521808034292339], [131799388892789841956457246728286289071, 179523887586313289108358686848746876578], [166334686547715174066319716179344994825, 99581707315950066420559574465002502799], [243987228695621769026698174243093048828, 148061671212463833983997703277199796691], [34480246590566363635504807857413901967, 180203594604538385562159827373014329488], [252862762880451762536403586534082078816, 190171781114740522411505460658152817148], [99179300537161051047055359273833826282, 70060614045255763633295033802577409881], [176373484509950741557933234188845039627, 197921927133839611186304283927708559222], [105906718082732877430634753001699743166, 220415006243229296377197090607736937237], [211918956153692817805738625479951462604, 262808999766736506824168586899991615482], [150180926387359999349698488449205812012, 146042552907138304682052878159060914400], [191770781688689750904703256055651883434, 173014190516908241441500194290557142186], [144825894227448686116779205986717969178, 236955959892494471910530663179543550094], [178905625900232241799289437983468589432, 81669724483699570759804346244066013520], [136026854420356259647197847246020570925, 176065461008614343376037589948280083495], [47925835667259372022533112554399852126, 91753557534168682059050736413635942627], [195312291940366085363306683666068361236, 169049069491343950939688986827353150051], [64883616755294418534212491525497501668, 93523845925288662437654473266623162511], [201094000489767292301496788981811833724, 131978737587777620817744266022458670041], [170869234109980960675908585232390003506, 192023466784640788638131302086887166852], [200675144452473030240328469532887253587, 115354736924245436397821784277100706510], [139389845464007097601001946306874753971, 245397660716333463270968653051763228642], [131311979610535847812000383517600143756, 129284511380289631824211340372361308023], [203738013615945027372969618344582753266, 261363426461010896362391337700217435494], [97339140531556384481041115251866084240, 176185226545002371838291485616197367899], [170049052634898025194336853530314283179, 135167367568518607156002268477211036304], [147243608118843268057285166838033166242, 293626603601020524202284090613376812124]];
    
    let test_sum:Vec<Fp2<Fp>> = quad_ext_sum.iter().map(|a| Fp2::from(*a)).collect();
    //Vector from computing element-wise addition of f2_a and f2_b using implemented function
    let impl_sum:Vec<Fp2<Fp>> = f2_a.iter().zip(f2_b.iter()).map(|(a, b)| Fp2::from(*a)+ Fp2::from(*b)).collect();
    
    assert_eq!(test_sum,impl_sum)
}

#[test]
fn sub_test() {
    //f2_a and f2_b are arrays of integer doubles that are less than the modulus. Each entry has been uniformly sampled from the range (M/2, M)
    //so the test checks appropriate wrap-around behavior.
    let f2_a: [[u128; 2]; 100] = [[174406971591187532577705298530619297067, 219144869279903914781847181350978435516], [273353028293521134949622872099189388256, 176532942523124545805654851786973969122], [198981816169985501641346527210182162568, 265323234677897595829007649035347126949], [266968125559646267477442838834337788083, 230565065491432223807777880676885238307], [283611569930382170543797387556786379993, 320311955773880910875442119115864551065], [294005113981518242532751606844460156755, 223429944981778806156762332038732289832], [210732426404757464420338703701598751623, 219022710963061799561873887279038158458], [248629953311415512231700469440262894065, 302505193887824181137338825539964029243], [301067984250527614521955973089951710131, 268078175398344758279965849683685025081], [300541728442683048701600656120512381730, 311553934101341713635061860623501863473], [328251708715830175291910815737759552519, 280093269267237269844875815268472625079], [293573563608851668446059642854917948514, 197429240569462326350853629791671038642], [209991387440891093216292930727030725008, 200978239514513835178304242704710858278], [269814779980830229126089063542909050830, 291218352457904147259134072204983403755], [283127497541056998028010894720264869718, 215812238400976691189362992062340258124], [318332808602522965056875924436433937079, 264193515551784286279257201334200385297], [246564613855769992364459547145478990710, 250305453623463730339974355958055213818], [267893748327116225790788212602782700875, 279869293174182091345632657039355898424], [277441184223231718499039856054824479977, 338198699315337348865518273383664698019], [307379648796213556060906100102431002866, 265660111283715789301628045894132992296], [204156632252328444272210650246072601792, 232632431804554730869914942427228663801], [266161027224865530911247179221639154823, 186523858258610815959533523080866228201], [290681593512253573022199871945928392173, 293660212004874245907361220393676981407], [226994754062744436272311197990129751829, 336404698877908911143539681987416561825], [263500661401797224165785434518081132927, 322397685902507165771646803295191815033], [214611557385190178563975370685743774858, 274744441423794217352948844231432798799], [226699703760093194810901962675950842193, 220823866681047959762489679855751824869], [189348118647373921500161996758990638689, 215022642271109592977849264343007365287], [171354918074974526091680703557935224852, 319323126225831315431579717400456404318], [230219402513511552661259494156641323727, 291390827135550181504917868859399016337], [261936105219404796587420984104306950114, 308269541770210745021729575776186183749], [302586702473153683517790117847281515155, 191791142178133864457733153771177363741], [207562456976658795859089815138473200076, 198914479761092970545173733879758068452], [234620263481478077667663107645333133424, 191936541206920876787267435815830559313], [200608582974468186940862776793324866372, 269108159932556131422336549680473644357], [227642739967391709125974048156019925208, 316950052928724349031108155199156902356], [177476305387885923625556941151867829108, 317633642578225990195361379469672337588], [285840390245801352027750853020225443155, 228618436252891052984935890691330403803], [275623215861777922285827585986629135501, 249119419129547744789036458175734558088], [207252424968247720425173048612470511188, 225661857869710104952495864677669872405], [184963389035847465016368421426649833334, 223377022770086530883770720720086154403], [231832770651334170648059077772857143196, 323614763802982786230424536580539219138], [323591133055692951129187463266588937484, 245378302213974027674326962356651522410], [205212211621986006608539427413824555398, 246707946108923410088449967869232095918], [179447058542990065180216122399111317042, 320583828712788265106840481377922099036], [250604600273304930320763015307891253469, 213781570026415919288112772624900720504], [261431978981259678351703972456106709589, 236945234287073600407013159743481009337], [240431756598800771820483111003824160836, 269301911302568014362550332678032017627], [195694955681705789199144659657748352464, 332165182770104088260872456083568720337], [308840952762164815563403493808449488382, 177407521141864774426534017916347556285], [301061493274618792902931005800466873424, 201048326597270662766230852422005658496], [300832066491507440246527377162476062013, 299591901501544687102392979148396283881], [260390111731085200071377235215593088894, 266859136606734281593642390533164026348], [286819110407827932732524931380550938317, 204063829619441272654425963296354048962], [253006067564119864218534975283077258386, 298190356581773744993127157634772411296], [178142023420163004656832803426678084966, 178114599347353441030551553179210135422], [260577369348379108805214349137287127690, 229014718243463412335613501418420031594], [226192344752234292386443876995211991478, 326316357382602195295072571351598338043], [203370514551421496915834667254781615590, 272421822517682029669952180841475300809], [329050953312042147915396811743193441892, 214487085037583246495663912794896630445], [181566191693489726745036506250149601144, 205793524314788121004230800609712437167], [189315886774540971768846357162454904318, 300653042731173892763532220662086304377], [213776461720607525871017077856134245262, 180514187440765578418127079069314736980], [219808710268616328585999447625827969004, 248256807501948668064828338181480564845], [323606520381566497629725356479691541937, 227947891191366650176576457388083446504], [251854458876219917904372933515284831197, 238637863136454667895874022906777089485], [323462134996048656473293650701159402547, 269600576095487885081154604143518689636], [270212435678530101376424604960680211667, 235360230496087202111315256085984173292], [305337634168873644454739545569990473705, 219461855330335304523081184720220480972], [275439646257100762489959591393973837669, 223598118659766656036439094328871131307], [278229616727698593928971599975282595471, 280637185452865724306509968410692705434], [336787481429331481616072165270836092809, 294833441109056072189961741454959534835], [252321822179247184744034404064517925280, 300501666776966818098422265640272652676], [262121214045757074094426801874969317808, 246313447874821962448347652434970196949], [289391802164114755791445354722334628552, 305888089603500677245307495306176307125], [293182346132637147205582082915261700671, 187907956781653407011971327945815118555], [252367434614446978246508341287429071902, 281855853436633642681542617301931715827], [172993424507119854686228227508956353012, 297567001782272919101302096920545638429], [285159706837272952353542128861664342530, 239379755681466538575995625528935131993], [189047243051601303641202590787335593391, 206004117001208181679503727830004502369], [316157761469015661506396796541579662898, 239302931240391603430904372730550333255], [223000960683804875337158054021708845669, 231645935573106877245845718221590225182], [253972157925737779384962355241749120590, 333138121021722339893097562205708515148], [241458504178745352744900612061985631045, 184162333313436223014862643216955562864], [222302601796071233403679567140470100891, 175885238140532604596045611689355728756], [230270555280495443463209747554449127757, 261324281329602267747183299438025874851], [246345083094371693758864388035639480439, 251059235628702160939829829274004766773], [174085084424215708261067864608968990931, 287512348480364223587477174394091917910], [179548895624876743709369083813246874679, 251193827308867337127235425638156899778], [215207169964025281188379043359686076327, 183054319130203442041140461823526348318], [182359414140244115854161477891097494465, 230559271741623964301684653941895809955], [224858292811209448567312375324531572861, 292217643391827349760621342656498324903], [278747487954339590139509297069625054828, 258726452392107906570966935838957890913], [316160657532095243047824354804693481361, 208867262461656046823627195745200792629], [274456180119635224494017551427963964105, 289490077305068221215896895405195079897], [211921054014305312551383131318737424629, 242718558902851983435760850743228483261], [280589933576620290865233287231267475126, 266331112221476847671910032147592941798], [190196479105693496182452311740744965577, 224339669168716217943333725501099600553], [227630184444351855593884546610815383002, 251783565425267189241657984486758231073], [219605863144177352033679176569502755697, 325284478827487772645489157765674692654]];
    let f2_b: [[u128; 2]; 100] = [[308952369500670449439528974078638856322, 312060782669695918279236300205228036550], [332139335567313838605424762155618996302, 304914288737209928836335437593295369251], [187813176247726390171868653858627204898, 190490230261523069592228138513188474270], [329261206314728232738310413309920396772, 179235429852190745898283297311367652377], [325354051654780761776638268628177078890, 324205066583550203280610719442830528195], [182829934919023643454729428270035393381, 182474281329811147046528600310534912736], [296705992984758357482837468528080799798, 337787214942738552073741233432123811001], [170456630767760171449637532287884159766, 205770390831338324767807128143312145588], [318454801747612778059950388973124643911, 282441078182195496116481678310242897249], [199614830160497803767111027322945406394, 170767108835369152512069031621629133310], [286099857605814991354149364764438179114, 288042366421119657934785519100170730057], [284972827975029105804010017017216607004, 292834150427608935542467625344466998367], [222442312984086401794643212871165669277, 338374958290032846479040814169955973118], [311412188416449827456940552096383109590, 298709341681257208135691070369334188486], [253185264993940074345755783409411188065, 246560279473299414355163147341725805365], [284962062297479862853548352023640537713, 205238043429478236902872563990455475128], [200469882203578305107119232927514783664, 288124732903370820506976684009068163535], [301960453030629360791160282409956942811, 266446943037249378236972666580535263815], [333314437553769013168096943622752137158, 291108401241109358391911452321262535734], [333591350862527112608449598805040031470, 284718536088399058700861480741563694076], [193302593060888769258844812517289955594, 170710577032583090125869558675220645242], [180444790489426333340294178870171828241, 194984378678097079930008296395285104258], [283341455012975095064937359348745084528, 326682747702724760264268907385330396173], [213321803685512380827717791703027107817, 335307317705409907776862766471807548366], [258668569596199460598322404145335028940, 235793401403758251915950798246512708497], [288747840899594244985154292835940355834, 193999535902873887715317708230350459778], [180426217538849536854032936408089304331, 224319209016700946449044016911279992285], [249601426024642662401063128395573646235, 314038033029503383511028889039408957987], [295792491407573845107686310508769863974, 192637968641716413336967442829621324246], [269180927676266372351410881389571410214, 262703749702567186019744293283669267598], [291217349328060380300575769340319954021, 287178476395255436814949722598137024890], [178379715013985573076049444065470154703, 279834369291394317847131663848892816110], [205729911716145446066121402996684167933, 325366247652056733364829347158602796836], [208605005535310934039386510923381744132, 177676400578315947396202635296311566538], [305285473512022524450103847865338359466, 175971312511585058555413698450782255612], [229553166632429194672384240229609619509, 198139189167155303609918186611918602926], [230910685127622921218619026404037177031, 171522864043818459103253603333226470246], [184918539956477480306971848424921015173, 178235576387608228047519943540311973277], [301138608710716288935613312406925802351, 265613802942803275557375364936092731181], [307586671709241018238840829673952968356, 280226296903574093750779425405465366009], [263595525692507907265084644452555322423, 206758076098848354680614159897532345223], [221014513621512897850214218784028069602, 211859432052588317847187903900179213154], [280065174154683459233739645541602269435, 332222234697679178247664036870540377119], [171642642345265115810485134431747692775, 195954359085860892545321770401565070596], [326538377762332527105363714083557661090, 206118649480395966797850942668509705256], [230531157157034655218596856275457967122, 278879737426111128292080715951988224888], [294267943329046506728469886939110707317, 251557307288840761374082146664943220399], [339779509773580817369188711320032722335, 257305684660530668831544363967769224974], [248866211643271047664391416085965948041, 311772694146790801169008382119083417525], [226677881669551053364680291866168279037, 310267783552082303182819795193873840639], [332760714745168434034607429594006079601, 226436511605227556040791031612871549779], [212753215123521436322132760157948407646, 306220729045238098171470847341694249464], [328682384706243774314436736764223820125, 255405490934377165878738593012828292528], [185810599061174559699829293266736865809, 316747986856770560764742513507258920372], [324543966366582741204628877582623786782, 185111499967856698959536786931758767877], [329324158603550663631124373139872889963, 290810761974936501759367769667878966197], [193328439156425880652797521721270855677, 336199421625272156510862232737282208025], [271984380962099771177729065072923884027, 246497734780688601780570619011935459061], [190469843547860200001260510097408045609, 268820700910006049761050282636867615034], [211417318689812929757076585128587634388, 217636899532821099528736745894897785223], [190876805948095467751547943955648826189, 245006346538688033564458332718388143838], [188251078757953246621324056993259795117, 225318995072076288517253781569562314489], [202292490294944402299818938984496629345, 240557553305379596557655645802026128194], [262539911809149162521377978584612735883, 254556483906734750516854706617712774871], [173848457034150260354443330599820658193, 297163647488881454815500556391055119352], [219493617018342747713032495351632051827, 187878979825127912400782858316183399167], [325221145828899911165987686973546333082, 304185903076241709496793630344385502401], [311009494776135366540471852076046893197, 334676442202365476582969659923417599974], [298087081678182501517781000133826586871, 283069170218850974331980702062854890099], [182497615246871695912509601645518579137, 323460638954100426280127324012845356594], [263969549884310718099911125716026411229, 196386246865999653051852718990952549797], [236102338802645651616425168537643176951, 224431186205169890323552223910530109802], [173229754870019219102103847771482557985, 269830339850374171311805130225546554382], [222293639913106334732607011121511179514, 269187234358147711678596427326809056927], [182689953649613549628386449959696622056, 213918164903751075326425749496315530990], [213434707336016490324112191217828255691, 251956117455235122871962804472932345781], [331902161002113254243564390909408938463, 206488184696768654765829643929013042401], [201769189004384972412651138302202510492, 222918959743203929924232288406213652596], [307985422964117273646236015626162697823, 291074392354212447298884393082962646692], [250414424406498210869227326440243194428, 204338863964986045417165863926317869049], [200498089961873543514910995601010338266, 298901362814386471218774469150903187504], [223188124319866465556851256933735859034, 329051437591060882594725930339891673592], [298229165148893501884150828191947303551, 269953245665952630394445582648028061871], [249004789129553110068172434340965142504, 302162586514640545130564792895850313073], [309750546813556980964398246868926744080, 337411319297314100308829140554946374967], [254837705867891706116944016386013802958, 315914045483830667626721921695262636780], [272842909726799011503799607901574070530, 170892855775935873283349074923806208284], [302224136917079014849504540590796541531, 228835479449188583251934973507933127122], [208659306963321091776538586694897938984, 180842097146239808395189868729224004386], [320387488897279267638302198260127246446, 326277117282078972361923082957571763270], [222806569535988766143425571588144968740, 203246941104603161599344377278472314093], [316518074599496307197558971611025222400, 180043461116888734520497481319705306675], [232404113076579833999773846116509910215, 273579381313471345530538924201674237476], [224796853841316250655878672681938733763, 246769841383527853037569146485644875418], [205216032265310336570358952832655751403, 296189950332203705518446315600313110282], [259673292517168998723991810152607680664, 226848319398376111851825047582877786299], [263430446960263199971110889067060239677, 335314681160472512153855863506369455233], [247425028346801351761963361464866080200, 292127924297224617358332318068842728883], [282701235111484633063826864873243861714, 223666169064189881377718841944197766768], [267920111895604379486980548222275372082, 308624491694471215020169490801447081007]];
    
    //Result of element-wise addition of f2_a and f2_b in SageMath when seen as elements of quadratic extension.
    let quad_ext_sub: [[u128; 2]; 100] = [[205736969011455546601550882405725402282, 247366453531146459965985439099495360503], [281496059647145759807572667897315353491, 211901020706853080432693972147423561408], [11168639922259111469477873351554957670, 74833004416374526236779510522158652679], [277989286165856498202506983478162352848, 51329635639241477909494583365517585930], [298539885196539872230533676882354262640, 336389256111269171058205957626778984407], [111175179062494599078022178574424763374, 40955663651967659110233731728197377096], [254308800340937570400875793127262913362, 221517862941261710951507211800659308994], [78173322543655340782062937152378734299, 96734803056485856369531697396651883655], [322895549423853299925380142070572027757, 325919464137087725626858729327187089369], [100926898282185244934489628797566975336, 140786825265972561122992829001872730163], [42151851110015183937761450973321373405, 332333269767056075373464854122046856559], [8600735633822562642049625837701341510, 244877457062791854271760562400949001812], [327831441377743154885024275809610017268, 202885648145419452162637986488499846697], [298684958485318865132523069400270902777, 332791377697585402586817559789394176806], [29942232547116923682255111310853681653, 309534325848615740297574402674359414296], [33370746305043102203327572412793399366, 58955472122306049376384637343744910169], [46094731652191687257340314217964207046, 302463087641031373296372229902732011820], [306215662217425328463002488146570719601, 13422350136932713108659990458820634609], [284409113590401168794317470385817304356, 47090298074227990473606821062402162285], [314070664854624906915831059251135932933, 321223942116255194064141123106314259757], [10854039191439675013365837728782646198, 61921854771971640744045383752008018559], [85716236735439197570953000351467326582, 331821846501452199492899784639326085480], [7340138499278477957262512597183307645, 307259831223087949106466870962091546771], [13672950377232055444593406287102644012, 1097381172499003366676915515609013459], [4832091805597763567463030372746103987, 86604284498748913855696005048679106536], [266146083406534397042195635803548380561, 80744905520920329637631136001082339021], [46273486221243657956869026267861537862, 336787024585285476776820220898216794121], [280029059543669722562473426317161953991, 241266976162544672930194933257343368837], [215844793588339144447368951002910322415, 126685157584114902094612274570835080072], [301320841758183643773223170720814875050, 28687077432982995485173575575729748739], [311001122812282879750219772717731957630, 21091065374955308206779853178049158859], [124206987459168110441740673781811360452, 252239139807678010073976047876029509168], [1832545260513349792968412141789032143, 213830599029974700643718944674900233153], [26015257946167143628276596721951389292, 14260140628604929391064800519518992775], [235605476383384125954133486881731468443, 93136847420971072866922851229691388745], [338371940255900977916964365880155267236, 118810863761569045421189968587238299430], [286847987181201465870312472701575613614, 146110778534407531092107776136445867342], [100921850289323871720779004595304427982, 50382859865282824937415947151018430526], [314766974072000096813588831533448294687, 323787983107682932695035651193386788444], [239948120179945165649706776892262504369, 285717927887074474665090997225949467933], [261650230264278021214658334927839472448, 16618946671238176203156560822553809180], [10818257029821272797844858988829073594, 111755331750394468383236632680360005984], [43525958901009491895447817724986668049, 253438434437233312890037483439856106828], [33569569276720890798054292982076862623, 50753587023062517543128197467667025322], [193191047701596001538226966269298617489, 114465179232392298308989538709412393780], [20073443116270275102166159032433286347, 275184199521243254459406614626657457153], [307446402573151635086608643470740963809, 325670293919171302496305571032282750475], [240934613746158417914668957637536400038, 11996226642037345531005968710262792653], [287111110959373204998127801525527365960, 20392488623313287091864073964485302812], [82163071092613762198723201942281209345, 207422104510720934707088780676218677183], [308583145450388822331698134160205755360, 314894181912981570188814378762879070254], [88078851367986003924394617004527654367, 333653539377245052394296689760446995954], [271990093945779889220315056405114230306, 11453645672357115714903797520335733820], [101008511346653373032695638113814072508, 227598209683609175353058007742840090127], [268744468118475586477280655654198433141, 113078856613917046033590370703013643419], [189100231737550804489082988240550156540, 227586204293355402734558341465076130762], [67248930191953228152416827416016272013, 233097663539129719288125826634882785106], [294490330711072984672089369876033068988, 79818622601913593514501952339662878982], [12900671003561296914574157157373569981, 3601121607675979908901898204607685775], [117633634622229218158320226614605807504, 337132552425700610430301724853743806759], [330971752666332722456863120248245736492, 301069544697038550903147025845069254866], [1064808016587725147522300169195109201, 75334047659097604246278439092523989888], [11483971425663123571198138871637615917, 280239001056324445323845991221033570323], [297551165380405629527996026994960194658, 333982690516152381011348189517512751511], [149758063347416237275282025879870883744, 271066610623423658824450458950773288689], [32360841857877170191340438163652779370, 50758883311326755495091164590593690318], [338523356088087208770680521681358031002, 305697039940184639047735531752878148772], [299485307823333198299327310838378280007, 240966155214660188991720154116311534855], [7250552490691142936958545436163886834, 276675052032422793654475040611110552410], [92942031010229066577449989748455258532, 240419846626604693219686328269770736250], [14260066843387875829060474259256184242, 84250938586866071254657249419740155637], [100685142626685829999646996733192915858, 70402254903886181866409517544429425033], [79092067309227965641930556293035367295, 30671326926592646786617135414726098294], [39827574132650739361819790753458138294, 317408580437612714233125783061906101559], [106701848514501206163058904762638006496, 91969924699749601918881745809860776135], [79747638796620656881469891697433444980, 276234206247356747603383081426627734311], [260747640533272187466318508331765094976, 75367668739864987915712973372918673426], [311506602423673345736951647160498804057, 74648042039068989177069808514331985833], [317456650794094142170680671189246606244, 288587730248192554740485790399717446838], [278915185566041556235349822300837360500, 1665253036222136262337863903686633320], [115659671507142117991485800940569324632, 280683935346943595675504461533392107288], [340095203284876873243681355041717948172, 242876864902984458114494345835443513127], [296025359697782740964186085003546778576, 63184875355769709498651979557680453277], [332736081970130706140102735674765450078, 222282113719734141347672408274850211328], [252834421903452715902655878225288318348, 178756285764156967750591029088154315326], [315715216333542200809640289122180286336, 285692602766710063583835935696508199608], [313784540288511145718439338087810371446, 80166379852766287656480754350198558489], [212143314428075156874937881971917410937, 58676869031175640335542200886158790788], [311171955582494115396205055072093897232, 70351730162627528732045556908932895392], [235102047987684477013451403053303791418, 197059568769062933142591936819699546585], [299835211525193813174110464256697487262, 27312330637020802702340276663423495862], [248622585132651604833127961667251311998, 112174182274938615240123861336793018228], [46343374877759756139735450953115144613, 325429437999575024503802569591028614974], [91363803690778992391945682122754747598, 302379787999066657249432607213300878748], [69240147854324887923658598595308212702, 333582493893802979160825137758626931152], [292530128418074777290765879119874705502, 15870239504475871583935803160350696962], [17159486616357090894122398164207235449, 271298797981942798981428726594968448102], [283053817679830607883863508229623846914, 272494111792430064048375965386001833207], [285211316253805685993432239691316482825, 28117396361077307863939142542560464305], [291968118169511436010073186300972345152, 16659987133016557625319666964227611647]];
    
    let test_sub:Vec<Fp2<Fp>> = quad_ext_sub.iter().map(|a| Fp2::from(*a)).collect();
    
    //Vector from computing element-wise addition of f2_a and f2_b using implemented function.
    let impl_sub:Vec<Fp2<Fp>> = f2_a.iter().zip(f2_b.iter()).map(|(a, b)| Fp2::from(*a) - Fp2::from(*b)).collect();

    assert_eq!(test_sub, impl_sub)
}
#[test]
fn mul_test() {
    //f2_a and f2_b are arrays of integer doubles that are less than the modulus. Each entry has been uniformly sampled from the range (M/2, M)
    //so the test checks appropriate wrap-around behavior.
    let f2_a: [[u128; 2]; 100] = [[174406971591187532577705298530619297067, 219144869279903914781847181350978435516], [273353028293521134949622872099189388256, 176532942523124545805654851786973969122], [198981816169985501641346527210182162568, 265323234677897595829007649035347126949], [266968125559646267477442838834337788083, 230565065491432223807777880676885238307], [283611569930382170543797387556786379993, 320311955773880910875442119115864551065], [294005113981518242532751606844460156755, 223429944981778806156762332038732289832], [210732426404757464420338703701598751623, 219022710963061799561873887279038158458], [248629953311415512231700469440262894065, 302505193887824181137338825539964029243], [301067984250527614521955973089951710131, 268078175398344758279965849683685025081], [300541728442683048701600656120512381730, 311553934101341713635061860623501863473], [328251708715830175291910815737759552519, 280093269267237269844875815268472625079], [293573563608851668446059642854917948514, 197429240569462326350853629791671038642], [209991387440891093216292930727030725008, 200978239514513835178304242704710858278], [269814779980830229126089063542909050830, 291218352457904147259134072204983403755], [283127497541056998028010894720264869718, 215812238400976691189362992062340258124], [318332808602522965056875924436433937079, 264193515551784286279257201334200385297], [246564613855769992364459547145478990710, 250305453623463730339974355958055213818], [267893748327116225790788212602782700875, 279869293174182091345632657039355898424], [277441184223231718499039856054824479977, 338198699315337348865518273383664698019], [307379648796213556060906100102431002866, 265660111283715789301628045894132992296], [204156632252328444272210650246072601792, 232632431804554730869914942427228663801], [266161027224865530911247179221639154823, 186523858258610815959533523080866228201], [290681593512253573022199871945928392173, 293660212004874245907361220393676981407], [226994754062744436272311197990129751829, 336404698877908911143539681987416561825], [263500661401797224165785434518081132927, 322397685902507165771646803295191815033], [214611557385190178563975370685743774858, 274744441423794217352948844231432798799], [226699703760093194810901962675950842193, 220823866681047959762489679855751824869], [189348118647373921500161996758990638689, 215022642271109592977849264343007365287], [171354918074974526091680703557935224852, 319323126225831315431579717400456404318], [230219402513511552661259494156641323727, 291390827135550181504917868859399016337], [261936105219404796587420984104306950114, 308269541770210745021729575776186183749], [302586702473153683517790117847281515155, 191791142178133864457733153771177363741], [207562456976658795859089815138473200076, 198914479761092970545173733879758068452], [234620263481478077667663107645333133424, 191936541206920876787267435815830559313], [200608582974468186940862776793324866372, 269108159932556131422336549680473644357], [227642739967391709125974048156019925208, 316950052928724349031108155199156902356], [177476305387885923625556941151867829108, 317633642578225990195361379469672337588], [285840390245801352027750853020225443155, 228618436252891052984935890691330403803], [275623215861777922285827585986629135501, 249119419129547744789036458175734558088], [207252424968247720425173048612470511188, 225661857869710104952495864677669872405], [184963389035847465016368421426649833334, 223377022770086530883770720720086154403], [231832770651334170648059077772857143196, 323614763802982786230424536580539219138], [323591133055692951129187463266588937484, 245378302213974027674326962356651522410], [205212211621986006608539427413824555398, 246707946108923410088449967869232095918], [179447058542990065180216122399111317042, 320583828712788265106840481377922099036], [250604600273304930320763015307891253469, 213781570026415919288112772624900720504], [261431978981259678351703972456106709589, 236945234287073600407013159743481009337], [240431756598800771820483111003824160836, 269301911302568014362550332678032017627], [195694955681705789199144659657748352464, 332165182770104088260872456083568720337], [308840952762164815563403493808449488382, 177407521141864774426534017916347556285], [301061493274618792902931005800466873424, 201048326597270662766230852422005658496], [300832066491507440246527377162476062013, 299591901501544687102392979148396283881], [260390111731085200071377235215593088894, 266859136606734281593642390533164026348], [286819110407827932732524931380550938317, 204063829619441272654425963296354048962], [253006067564119864218534975283077258386, 298190356581773744993127157634772411296], [178142023420163004656832803426678084966, 178114599347353441030551553179210135422], [260577369348379108805214349137287127690, 229014718243463412335613501418420031594], [226192344752234292386443876995211991478, 326316357382602195295072571351598338043], [203370514551421496915834667254781615590, 272421822517682029669952180841475300809], [329050953312042147915396811743193441892, 214487085037583246495663912794896630445], [181566191693489726745036506250149601144, 205793524314788121004230800609712437167], [189315886774540971768846357162454904318, 300653042731173892763532220662086304377], [213776461720607525871017077856134245262, 180514187440765578418127079069314736980], [219808710268616328585999447625827969004, 248256807501948668064828338181480564845], [323606520381566497629725356479691541937, 227947891191366650176576457388083446504], [251854458876219917904372933515284831197, 238637863136454667895874022906777089485], [323462134996048656473293650701159402547, 269600576095487885081154604143518689636], [270212435678530101376424604960680211667, 235360230496087202111315256085984173292], [305337634168873644454739545569990473705, 219461855330335304523081184720220480972], [275439646257100762489959591393973837669, 223598118659766656036439094328871131307], [278229616727698593928971599975282595471, 280637185452865724306509968410692705434], [336787481429331481616072165270836092809, 294833441109056072189961741454959534835], [252321822179247184744034404064517925280, 300501666776966818098422265640272652676], [262121214045757074094426801874969317808, 246313447874821962448347652434970196949], [289391802164114755791445354722334628552, 305888089603500677245307495306176307125], [293182346132637147205582082915261700671, 187907956781653407011971327945815118555], [252367434614446978246508341287429071902, 281855853436633642681542617301931715827], [172993424507119854686228227508956353012, 297567001782272919101302096920545638429], [285159706837272952353542128861664342530, 239379755681466538575995625528935131993], [189047243051601303641202590787335593391, 206004117001208181679503727830004502369], [316157761469015661506396796541579662898, 239302931240391603430904372730550333255], [223000960683804875337158054021708845669, 231645935573106877245845718221590225182], [253972157925737779384962355241749120590, 333138121021722339893097562205708515148], [241458504178745352744900612061985631045, 184162333313436223014862643216955562864], [222302601796071233403679567140470100891, 175885238140532604596045611689355728756], [230270555280495443463209747554449127757, 261324281329602267747183299438025874851], [246345083094371693758864388035639480439, 251059235628702160939829829274004766773], [174085084424215708261067864608968990931, 287512348480364223587477174394091917910], [179548895624876743709369083813246874679, 251193827308867337127235425638156899778], [215207169964025281188379043359686076327, 183054319130203442041140461823526348318], [182359414140244115854161477891097494465, 230559271741623964301684653941895809955], [224858292811209448567312375324531572861, 292217643391827349760621342656498324903], [278747487954339590139509297069625054828, 258726452392107906570966935838957890913], [316160657532095243047824354804693481361, 208867262461656046823627195745200792629], [274456180119635224494017551427963964105, 289490077305068221215896895405195079897], [211921054014305312551383131318737424629, 242718558902851983435760850743228483261], [280589933576620290865233287231267475126, 266331112221476847671910032147592941798], [190196479105693496182452311740744965577, 224339669168716217943333725501099600553], [227630184444351855593884546610815383002, 251783565425267189241657984486758231073], [219605863144177352033679176569502755697, 325284478827487772645489157765674692654]];
    let f2_b: [[u128; 2]; 100] = [[308952369500670449439528974078638856322, 312060782669695918279236300205228036550], [332139335567313838605424762155618996302, 304914288737209928836335437593295369251], [187813176247726390171868653858627204898, 190490230261523069592228138513188474270], [329261206314728232738310413309920396772, 179235429852190745898283297311367652377], [325354051654780761776638268628177078890, 324205066583550203280610719442830528195], [182829934919023643454729428270035393381, 182474281329811147046528600310534912736], [296705992984758357482837468528080799798, 337787214942738552073741233432123811001], [170456630767760171449637532287884159766, 205770390831338324767807128143312145588], [318454801747612778059950388973124643911, 282441078182195496116481678310242897249], [199614830160497803767111027322945406394, 170767108835369152512069031621629133310], [286099857605814991354149364764438179114, 288042366421119657934785519100170730057], [284972827975029105804010017017216607004, 292834150427608935542467625344466998367], [222442312984086401794643212871165669277, 338374958290032846479040814169955973118], [311412188416449827456940552096383109590, 298709341681257208135691070369334188486], [253185264993940074345755783409411188065, 246560279473299414355163147341725805365], [284962062297479862853548352023640537713, 205238043429478236902872563990455475128], [200469882203578305107119232927514783664, 288124732903370820506976684009068163535], [301960453030629360791160282409956942811, 266446943037249378236972666580535263815], [333314437553769013168096943622752137158, 291108401241109358391911452321262535734], [333591350862527112608449598805040031470, 284718536088399058700861480741563694076], [193302593060888769258844812517289955594, 170710577032583090125869558675220645242], [180444790489426333340294178870171828241, 194984378678097079930008296395285104258], [283341455012975095064937359348745084528, 326682747702724760264268907385330396173], [213321803685512380827717791703027107817, 335307317705409907776862766471807548366], [258668569596199460598322404145335028940, 235793401403758251915950798246512708497], [288747840899594244985154292835940355834, 193999535902873887715317708230350459778], [180426217538849536854032936408089304331, 224319209016700946449044016911279992285], [249601426024642662401063128395573646235, 314038033029503383511028889039408957987], [295792491407573845107686310508769863974, 192637968641716413336967442829621324246], [269180927676266372351410881389571410214, 262703749702567186019744293283669267598], [291217349328060380300575769340319954021, 287178476395255436814949722598137024890], [178379715013985573076049444065470154703, 279834369291394317847131663848892816110], [205729911716145446066121402996684167933, 325366247652056733364829347158602796836], [208605005535310934039386510923381744132, 177676400578315947396202635296311566538], [305285473512022524450103847865338359466, 175971312511585058555413698450782255612], [229553166632429194672384240229609619509, 198139189167155303609918186611918602926], [230910685127622921218619026404037177031, 171522864043818459103253603333226470246], [184918539956477480306971848424921015173, 178235576387608228047519943540311973277], [301138608710716288935613312406925802351, 265613802942803275557375364936092731181], [307586671709241018238840829673952968356, 280226296903574093750779425405465366009], [263595525692507907265084644452555322423, 206758076098848354680614159897532345223], [221014513621512897850214218784028069602, 211859432052588317847187903900179213154], [280065174154683459233739645541602269435, 332222234697679178247664036870540377119], [171642642345265115810485134431747692775, 195954359085860892545321770401565070596], [326538377762332527105363714083557661090, 206118649480395966797850942668509705256], [230531157157034655218596856275457967122, 278879737426111128292080715951988224888], [294267943329046506728469886939110707317, 251557307288840761374082146664943220399], [339779509773580817369188711320032722335, 257305684660530668831544363967769224974], [248866211643271047664391416085965948041, 311772694146790801169008382119083417525], [226677881669551053364680291866168279037, 310267783552082303182819795193873840639], [332760714745168434034607429594006079601, 226436511605227556040791031612871549779], [212753215123521436322132760157948407646, 306220729045238098171470847341694249464], [328682384706243774314436736764223820125, 255405490934377165878738593012828292528], [185810599061174559699829293266736865809, 316747986856770560764742513507258920372], [324543966366582741204628877582623786782, 185111499967856698959536786931758767877], [329324158603550663631124373139872889963, 290810761974936501759367769667878966197], [193328439156425880652797521721270855677, 336199421625272156510862232737282208025], [271984380962099771177729065072923884027, 246497734780688601780570619011935459061], [190469843547860200001260510097408045609, 268820700910006049761050282636867615034], [211417318689812929757076585128587634388, 217636899532821099528736745894897785223], [190876805948095467751547943955648826189, 245006346538688033564458332718388143838], [188251078757953246621324056993259795117, 225318995072076288517253781569562314489], [202292490294944402299818938984496629345, 240557553305379596557655645802026128194], [262539911809149162521377978584612735883, 254556483906734750516854706617712774871], [173848457034150260354443330599820658193, 297163647488881454815500556391055119352], [219493617018342747713032495351632051827, 187878979825127912400782858316183399167], [325221145828899911165987686973546333082, 304185903076241709496793630344385502401], [311009494776135366540471852076046893197, 334676442202365476582969659923417599974], [298087081678182501517781000133826586871, 283069170218850974331980702062854890099], [182497615246871695912509601645518579137, 323460638954100426280127324012845356594], [263969549884310718099911125716026411229, 196386246865999653051852718990952549797], [236102338802645651616425168537643176951, 224431186205169890323552223910530109802], [173229754870019219102103847771482557985, 269830339850374171311805130225546554382], [222293639913106334732607011121511179514, 269187234358147711678596427326809056927], [182689953649613549628386449959696622056, 213918164903751075326425749496315530990], [213434707336016490324112191217828255691, 251956117455235122871962804472932345781], [331902161002113254243564390909408938463, 206488184696768654765829643929013042401], [201769189004384972412651138302202510492, 222918959743203929924232288406213652596], [307985422964117273646236015626162697823, 291074392354212447298884393082962646692], [250414424406498210869227326440243194428, 204338863964986045417165863926317869049], [200498089961873543514910995601010338266, 298901362814386471218774469150903187504], [223188124319866465556851256933735859034, 329051437591060882594725930339891673592], [298229165148893501884150828191947303551, 269953245665952630394445582648028061871], [249004789129553110068172434340965142504, 302162586514640545130564792895850313073], [309750546813556980964398246868926744080, 337411319297314100308829140554946374967], [254837705867891706116944016386013802958, 315914045483830667626721921695262636780], [272842909726799011503799607901574070530, 170892855775935873283349074923806208284], [302224136917079014849504540590796541531, 228835479449188583251934973507933127122], [208659306963321091776538586694897938984, 180842097146239808395189868729224004386], [320387488897279267638302198260127246446, 326277117282078972361923082957571763270], [222806569535988766143425571588144968740, 203246941104603161599344377278472314093], [316518074599496307197558971611025222400, 180043461116888734520497481319705306675], [232404113076579833999773846116509910215, 273579381313471345530538924201674237476], [224796853841316250655878672681938733763, 246769841383527853037569146485644875418], [205216032265310336570358952832655751403, 296189950332203705518446315600313110282], [259673292517168998723991810152607680664, 226848319398376111851825047582877786299], [263430446960263199971110889067060239677, 335314681160472512153855863506369455233], [247425028346801351761963361464866080200, 292127924297224617358332318068842728883], [282701235111484633063826864873243861714, 223666169064189881377718841944197766768], [267920111895604379486980548222275372082, 308624491694471215020169490801447081007]];
    
    //Result of element-wise multiplication of f2_a and f2_b in SageMath when seen as elements of quadratic extension.
    let quad_ext_mul: [[u128; 2]; 100] = [[104604120356372220696806424469112764409, 274290972379764946302554347060565649006], [186228341073523963809014743967245471102, 263647072185003406216683298489654109930], [336989887112496133532057468849206289272, 245833088076036395238648437843159172260], [147380718130724862967718564941632738703, 24161890353672330548305498388788261100], [217171333012943569134947512020520531022, 109100775162520277842535102505197794130], [121395132272072316985994425162361686045, 105906011561042293841800266441136923966], [203309700533212157411206832797530051642, 310752288434924447858477033386118582325], [229953260915606258582874797081803364384, 332445539307683230420509739529569175177], [121746584800120881206318673668701536197, 241862191334434696815680669235474049852], [266447984385149801185372074704679396616, 138050082547709191660157967223540267255], [153073834946771420968429205618494392846, 171052253854076328421607123096029730779], [158577253438199118291733801228566583264, 13376406490202787746522811479731029826], [132014651629903658837013924331335316301, 20948672445459280820078159805274357170], [123125031930689038997308838284756408977, 231910432276071637203287313148397711981], [251090600469804681244343746270544926741, 157793628736729853304948833571378917806], [337986733013232697990128158427357402334, 169607008137172956626647350693677010173], [329996042800480084701266795057605072086, 136565597695189827936324858632305907867], [34396165837190400800191779445164343186, 251887862434929080275699210678321741045], [146334094621192279519699156056812677461, 165448327174717219212228165081720611276], [125370113899683244741207313934121039192, 187924650162705881334907872343292623127], [74730190636053044817829210054382741078, 313133542141756691143861303868342357476], [234343063391817374186726812720301145745, 119036332099183832796340373592682057808], [51078024205950314430188569988021966846, 204116819356394863268675670533995437379], [100918929211461824029085541674548104252, 159832507300832099215689856953853195749], [312644794749833958416214628034467834669, 27142589977584335905047363675444551659], [269049966132379799713312818735016521591, 238099358549294473855490723208896311709], [321797278060178446627664508268138332006, 296828185680110527071544672734526766934], [83823715406205654503474457059853255410, 16109201555345368025181369401636053538], [217300657508247165359902852891774260616, 92483599329547937778375238191742439752], [154098445873306113573199314725031276296, 286291128189576168063409638221394532562], [134854285152809320592054705818079214778, 241756669062369366042810395012121660864], [104655202092196291855995002097811443115, 81485984163318317384773941530857524212], [271819645763112876475183312803940640604, 48058904928049361225823980859526395572], [245353319408806018346676156215597708788, 163064758448802246918236418333185869157], [124854917398338227870091007334821069852, 335176739830041794682480143750515054931], [233712320773201927953854074068251562646, 136232342422615490278413399155301596088], [124977652514402833115171048907132347, 111463177458282320664451010594557308326], [121613038726501569318993378963556987917, 175200049328804579348960760203985709288], [174862712797982853996933935845587366186, 278110416607576198549651597467470110255], [322540366331711735473012026120861328158, 68915372783236688565638029511263560833], [242921850418206454545834052231897446961, 103599738891959975874912892219710062402], [308187374140924281153507833236319932102, 32005707878331126171903296158365368193], [263386461665895532988008919741415752969, 125980890287656846359584846345678342624], [222352018529602133822729508327433472992, 67422055735786893264330518098715085608], [120293688528990684408845577650457502239, 173810752854480603956954160346035708752], [60022821925773344538462736356321574849, 221992795329912806299422806826406121357], [153777316760045900999420678324552422903, 306159207627982761085845792664449491397], [202262911939700255993382502729566938722, 320531173808533853704714027190402707104], [332311033444072521155619632313975867798, 139641633880008403711138447474485065112], [233744678050696642224445713011198901533, 127022120631651839461480544172428308408], [321190754329404923141939888452293106394, 229020890407107398432408956039196617379], [84161043244464270877378393006099130999, 216285714490928223741071749417190211423], [222298730366140530239935154445960354119, 293252406400159756522026433065181562530], [188814790477206752598311530255093824418, 201533654382398219831073030765463248955], [154137863484642623890492931848979004405, 81104331590578085871843054195216327770], [143628613818172619558702166401569071218, 315340647825682022750986079525252502033], [51688309570160228414571474162460962000, 234616801019278190944467234313283146174], [80616372341436218122629705884711428076, 180666092740336901119921899814620106963], [256601761588849112839145496814679620103, 260045835782011511059663120323832139892], [114778011796133901136669432232786546101, 289537372509144067613289516143880716719], [261225278883517382429721472020789154350, 191123220900814045367901917823190232707], [317413352817485866473812132711843132087, 86841650735270558765869419201346928248], [193429835459160670371765941206316817309, 20518808214565558319303957333409950085], [9171506585417418800113913489298214379, 117654662576553209213243216566370708298], [164126434267148676503391136267454999732, 99847161520443172040627491282706277063], [56456055833157027895556893875124197520, 165617611463847517705675446156120961664], [86770855062183260563556422944382708377, 75325129061780131502764310190791442996], [48786150842603524434699549673517033378, 54679440935755893370576703263973231263], [219242990296975387347867626738930247649, 169112879730617605521985899899887179644], [248665349231915333316637232709713566911, 136351477104896118138864838824115872547], [186905675209208772289885743599603033932, 293035865594820036275764077482577124339], [100482916624078486895477161445625655745, 214958178230264235894136421572582477997], [292126824583934108514040282829958724191, 204885500698602836594740758830563568774], [181727988939469460112929113111026476908, 220823737949223521395253274083685050759], [151308094054270904107960380133313671150, 210929471328732392017953707321622083444], [336722455012947014317958116818081204185, 179433014539735145935125717208638339854], [297578035389389102484450768009429547623, 269578124467037133396586394186267256277], [3725317889624294604296202663184602150, 270282846696162218363825297333958764306], [98724950543850358623676828844454290383, 114095449373092266143498084892269323733], [126750519718761337946360520812531221987, 8479278333256431918586406396798132293], [201150784875123167966372818956153870725, 223153187005513300010503419663277426333], [239442263025718530998776462861315088227, 302005128743568596905420658823809915016], [212777623048644568014110360777083044046, 90497034761577846878073029056108883381], [79280622523060095640614678815112200683, 95097919660607933202331673021739503237], [105296871404880717422362270426615709971, 209629428162987910116793312040582341251], [34366469969004147015960831179825011177, 64052044009590383360694910966272900090], [241345107799809007548454137741906736722, 45737098937958864755031549666979605818], [2791176551597373705128277279662669491, 116861386179691035649670289790380344428], [280580191018695620594638127562319033976, 209333895543820733310504655856963137530], [16798213646916157002845109575929039056, 219661607870624736306719078284115036146], [86234114615683572892228329480724336596, 308288874799173281146252469488338911000], [233441306326759846474564433367226302500, 259079320451882725145502917473370336437], [207797845943557903047484262076412286392, 227291278041492766434470707038352133589], [173789642280824525371286650929152985922, 179982829915969417215492870365701596052], [307382266376238987648191943106556038425, 62222882828553020781941694958358589054], [37854894655794421938927428102070146230, 288155281913598823047443537939124623170], [151331095850379584896880836390645873740, 70878486341046113409692154627204389554], [228862767080120440187633770277230971675, 60364698028408845490882307273332385982], [198632345342144700396588888552834938224, 54293011671170606808248085385690521251], [288117513922080544044426609729679172411, 172044859122865972052650404959047669083]];

    let test_mul:Vec<Fp2<Fp>> = quad_ext_mul.iter().map(|a| Fp2::from(*a)).collect();
    let impl_mul:Vec<Fp2<Fp>> = f2_a.iter().zip(f2_b.iter()).map(|(a, b)| Fp2::from(*a) * Fp2::from(*b)).collect();

   assert_eq!(test_mul, impl_mul)
}
#[test]
fn inv_test() {
    let f2_b: [[u128; 2]; 100] = [[308952369500670449439528974078638856322, 312060782669695918279236300205228036550], [332139335567313838605424762155618996302, 304914288737209928836335437593295369251], [187813176247726390171868653858627204898, 190490230261523069592228138513188474270], [329261206314728232738310413309920396772, 179235429852190745898283297311367652377], [325354051654780761776638268628177078890, 324205066583550203280610719442830528195], [182829934919023643454729428270035393381, 182474281329811147046528600310534912736], [296705992984758357482837468528080799798, 337787214942738552073741233432123811001], [170456630767760171449637532287884159766, 205770390831338324767807128143312145588], [318454801747612778059950388973124643911, 282441078182195496116481678310242897249], [199614830160497803767111027322945406394, 170767108835369152512069031621629133310], [286099857605814991354149364764438179114, 288042366421119657934785519100170730057], [284972827975029105804010017017216607004, 292834150427608935542467625344466998367], [222442312984086401794643212871165669277, 338374958290032846479040814169955973118], [311412188416449827456940552096383109590, 298709341681257208135691070369334188486], [253185264993940074345755783409411188065, 246560279473299414355163147341725805365], [284962062297479862853548352023640537713, 205238043429478236902872563990455475128], [200469882203578305107119232927514783664, 288124732903370820506976684009068163535], [301960453030629360791160282409956942811, 266446943037249378236972666580535263815], [333314437553769013168096943622752137158, 291108401241109358391911452321262535734], [333591350862527112608449598805040031470, 284718536088399058700861480741563694076], [193302593060888769258844812517289955594, 170710577032583090125869558675220645242], [180444790489426333340294178870171828241, 194984378678097079930008296395285104258], [283341455012975095064937359348745084528, 326682747702724760264268907385330396173], [213321803685512380827717791703027107817, 335307317705409907776862766471807548366], [258668569596199460598322404145335028940, 235793401403758251915950798246512708497], [288747840899594244985154292835940355834, 193999535902873887715317708230350459778], [180426217538849536854032936408089304331, 224319209016700946449044016911279992285], [249601426024642662401063128395573646235, 314038033029503383511028889039408957987], [295792491407573845107686310508769863974, 192637968641716413336967442829621324246], [269180927676266372351410881389571410214, 262703749702567186019744293283669267598], [291217349328060380300575769340319954021, 287178476395255436814949722598137024890], [178379715013985573076049444065470154703, 279834369291394317847131663848892816110], [205729911716145446066121402996684167933, 325366247652056733364829347158602796836], [208605005535310934039386510923381744132, 177676400578315947396202635296311566538], [305285473512022524450103847865338359466, 175971312511585058555413698450782255612], [229553166632429194672384240229609619509, 198139189167155303609918186611918602926], [230910685127622921218619026404037177031, 171522864043818459103253603333226470246], [184918539956477480306971848424921015173, 178235576387608228047519943540311973277], [301138608710716288935613312406925802351, 265613802942803275557375364936092731181], [307586671709241018238840829673952968356, 280226296903574093750779425405465366009], [263595525692507907265084644452555322423, 206758076098848354680614159897532345223], [221014513621512897850214218784028069602, 211859432052588317847187903900179213154], [280065174154683459233739645541602269435, 332222234697679178247664036870540377119], [171642642345265115810485134431747692775, 195954359085860892545321770401565070596], [326538377762332527105363714083557661090, 206118649480395966797850942668509705256], [230531157157034655218596856275457967122, 278879737426111128292080715951988224888], [294267943329046506728469886939110707317, 251557307288840761374082146664943220399], [339779509773580817369188711320032722335, 257305684660530668831544363967769224974], [248866211643271047664391416085965948041, 311772694146790801169008382119083417525], [226677881669551053364680291866168279037, 310267783552082303182819795193873840639], [332760714745168434034607429594006079601, 226436511605227556040791031612871549779], [212753215123521436322132760157948407646, 306220729045238098171470847341694249464], [328682384706243774314436736764223820125, 255405490934377165878738593012828292528], [185810599061174559699829293266736865809, 316747986856770560764742513507258920372], [324543966366582741204628877582623786782, 185111499967856698959536786931758767877], [329324158603550663631124373139872889963, 290810761974936501759367769667878966197], [193328439156425880652797521721270855677, 336199421625272156510862232737282208025], [271984380962099771177729065072923884027, 246497734780688601780570619011935459061], [190469843547860200001260510097408045609, 268820700910006049761050282636867615034], [211417318689812929757076585128587634388, 217636899532821099528736745894897785223], [190876805948095467751547943955648826189, 245006346538688033564458332718388143838], [188251078757953246621324056993259795117, 225318995072076288517253781569562314489], [202292490294944402299818938984496629345, 240557553305379596557655645802026128194], [262539911809149162521377978584612735883, 254556483906734750516854706617712774871], [173848457034150260354443330599820658193, 297163647488881454815500556391055119352], [219493617018342747713032495351632051827, 187878979825127912400782858316183399167], [325221145828899911165987686973546333082, 304185903076241709496793630344385502401], [311009494776135366540471852076046893197, 334676442202365476582969659923417599974], [298087081678182501517781000133826586871, 283069170218850974331980702062854890099], [182497615246871695912509601645518579137, 323460638954100426280127324012845356594], [263969549884310718099911125716026411229, 196386246865999653051852718990952549797], [236102338802645651616425168537643176951, 224431186205169890323552223910530109802], [173229754870019219102103847771482557985, 269830339850374171311805130225546554382], [222293639913106334732607011121511179514, 269187234358147711678596427326809056927], [182689953649613549628386449959696622056, 213918164903751075326425749496315530990], [213434707336016490324112191217828255691, 251956117455235122871962804472932345781], [331902161002113254243564390909408938463, 206488184696768654765829643929013042401], [201769189004384972412651138302202510492, 222918959743203929924232288406213652596], [307985422964117273646236015626162697823, 291074392354212447298884393082962646692], [250414424406498210869227326440243194428, 204338863964986045417165863926317869049], [200498089961873543514910995601010338266, 298901362814386471218774469150903187504], [223188124319866465556851256933735859034, 329051437591060882594725930339891673592], [298229165148893501884150828191947303551, 269953245665952630394445582648028061871], [249004789129553110068172434340965142504, 302162586514640545130564792895850313073], [309750546813556980964398246868926744080, 337411319297314100308829140554946374967], [254837705867891706116944016386013802958, 315914045483830667626721921695262636780], [272842909726799011503799607901574070530, 170892855775935873283349074923806208284], [302224136917079014849504540590796541531, 228835479449188583251934973507933127122], [208659306963321091776538586694897938984, 180842097146239808395189868729224004386], [320387488897279267638302198260127246446, 326277117282078972361923082957571763270], [222806569535988766143425571588144968740, 203246941104603161599344377278472314093], [316518074599496307197558971611025222400, 180043461116888734520497481319705306675], [232404113076579833999773846116509910215, 273579381313471345530538924201674237476], [224796853841316250655878672681938733763, 246769841383527853037569146485644875418], [205216032265310336570358952832655751403, 296189950332203705518446315600313110282], [259673292517168998723991810152607680664, 226848319398376111851825047582877786299], [263430446960263199971110889067060239677, 335314681160472512153855863506369455233], [247425028346801351761963361464866080200, 292127924297224617358332318068842728883], [282701235111484633063826864873243861714, 223666169064189881377718841944197766768], [267920111895604379486980548222275372082, 308624491694471215020169490801447081007]];
    
    //Result of element-wise inverse of f2_b in SageMath when seen as elements of quadratic extension.
    let quad_ext_inv: [[u128; 2]; 100]  = [[100463754379001786058722642335673688695, 325775359328275388410110206347594192552], [5893579421666260655810001858128277722, 290160319292484288252601811308619193803], [213124638096571138347346681653848603561, 328459623064865350547936699128343075764], [167377619430919527205732217166932350101, 169944927340712596239375771814576841281], [298326677188387658187070900806769646526, 198564371308573796876039687858405031783], [9152899011121368344620524956120542944, 47115458607523187210568981734197057777], [326959973104801469086136477301477971496, 245916885325300658249433211816342866256], [267752840787598308923494759828888482896, 27872655622451767452844811877843320906], [98944919337387017897488601175057900163, 146679682586740527541980534308250585985], [327679408389611462641475420402202728110, 295291302179802395801210162350471589712], [251589722178427528974674805270717214084, 276247602807384202447232775595561605979], [271214074535229163982544739341770261561, 29196814528400640203620555631450233984], [255520286242961473892724903035053112199, 291119819734551346180041353457777660402], [238518499508989001308969257418225829194, 324153459697627625865714483001704207518], [170882170828865401506092689958605749539, 148447232591223413640438741366772701533], [108398157597946198677443473245553408512, 246491358124985557414519512985381227299], [241721631145505886052287761544499163595, 97403112581691003432086095333501314367], [718916743471941063913813987087503031, 177430550076246365380911798592885709906], [189015912528291795088855343546814944744, 160297256633362579921012899531256506176], [269591658352068731873233037441228309808, 323309709486312816289252718414056500882], [43040113789614198282628209438191574187, 226627257731927778740848229821074640502], [139466848079590169720520397601775436188, 306804137661171409228995117178941410215], [170312003356631830206959002750169393830, 91879465711958173342136480365000722492], [96489834699757870329282850487832410389, 308404346268719552751587834025832920870], [29291231780275177879362530586558937171, 229518656203763574590097574485957267326], [284787292188013774036196884340457244232, 306793614082944128288379631301248671649], [5402030440764543847516546464768401936, 220429549753481530194767745696155705528], [62106312136756274700676097470349781294, 209542100874531050105957955331797407501], [247580330177610846509414608243586361975, 200145440041838259626820319266354560141], [218016705567825440591950081933095328393, 286861262093300304459667212348628337631], [49877154037062131780746235983035799123, 195797793664098610300957432521379035496], [126309466108848249456151702030029467984, 11570340798940975552757852628350918397], [150420338017561608266355212956653075312, 287903896042428530545786119993334339820], [117715322170758857807985613268548121805, 158138674897630605241258608805875293985], [317870663662192407249546021467884265412, 37637910732876981723069352682454704591], [143076126415199249923956119012543558349, 262415371497964305434995866941468416333], [138324061465328245159795339290362381232, 311974818806570310127162580450132446231], [187932384196771381568817929212197547682, 60808968760715114192377807538482211514], [101823657826855473700562504620696021017, 36429056504948371319702168483052007931], [239615982945783943851845324478888202715, 63498768498846608183938654171882785752], [176044971199441007831102680227589863973, 312810956507062814748851731640386767231], [66327061173448124405501006708346496808, 309948917103911307227357843614127832600], [92860181865883870696248349262827391743, 173044233022736104247731726442005054494], [9414316316161828890482477445438346514, 168023083711735987722308047271019056984], [186912462297125814074319322081230347713, 61471273873342308386632845829114889795], [85662199977197487605668875558897370113, 142153463665553175661122308597367843893], [147300530374698905046130133346837429270, 67757191718993971233751473162346747920], [78714154039038565381465462476685703007, 64428244169264368860783506912312127482], [305126223593829922582082511696255960081, 5178555952248165068875266008189648343], [258011008574033211982981161577064971673, 79259877094212692052826118981191327641], [68712541068965857895844570960684918147, 212476028241553325075005092061430212841], [61250110442262362630892221823876437258, 131072773679883652576810629258961706187], [90454251516697693937738591128039665244, 14192861120251119105552236602160759414], [78078741154940480554093605645891260241, 192951291837480133499443641257190247526], [333673004976409330933248918458447366850, 302436182219964351138001795710690924174], [176009855764746622591061828756902673183, 125361909688840452171089779515805383663], [70552007259185215487184868544965602478, 139953840615334557020032514222708006145], [304638089118690921969612615976165434673, 143319085817388593494307140811464079627], [304866942042458393376622017451981123648, 245095289578139019283793205304697081017], [8321427645065129131946480373184887407, 76593213556146470814555188698655027558], [85847498572355930170438041247564361647, 13834107239598719587721771994540335535], [31230307777732197930560699981543131443, 175206271103427202687342640897817110086], [42013303172475017804623915851308588405, 328004534231740262807805525186536629921], [74738175892746038719513031777645144007, 316422385328014735529988627596897929160], [102921936429176787240544597817440353213, 37056716840503935052171101896581494884], [34917002090005471781899578643886221847, 222946222696162673287850982810296730753], [42267260805949223511890007963272210695, 53814366330807432393067554291737325029], [152804100636746979286341011112838216127, 254292073165707555216683431073073293218], [133422592065274539752297393452039658442, 125655418131022756889979000068258270286], [334076649668686532379869194899205742, 244391937129731979602809778891146953067], [12885057171169212529209257704524596497, 155131146101905157949339755883920490091], [51095884410368980909948584891113341953, 311866794745280059102133730886002853831], [40776779221523092854555294916400340256, 3289014210607159321588342608929020868], [260227730127741529639965049436861010917, 115776405813013491096367134048782133223], [217184097074655071142162579444225042182, 299709928549933515166507798303584964686], [212453640175449087961422262735199504218, 41427170950298886804403470359349829051], [268987731332949269466289624654896564315, 242862889053089266180990709907090994308], [208918637112861087699458889476063843979, 16500252708097493541342352704448514910], [22225594698900248744895545318266908105, 78784066499618747626148870688512355268], [54633525621868611886801428544206497863, 91275066433081989728328487490870002196], [251442475382597626695044396380439980911, 200077127229831754612325959956212814338], [70010904633166458335791854340926565164, 247100065290760076708928446636306065641], [299158519823543145971174987886975626, 255898356999270074804091153666174832759], [196153191261500272264919774735602622024, 130952330957447044006266013677267365707], [12789454147025529711299444057083251078, 286816687562367855909902737883803659629], [180849451306913930206890127645872235823, 199055464903309161678888730718392580457], [223334228810838613154423593403397809178, 89022202016716975279597640058737444941], [311778693683958418709526010987762975667, 187015698482968616483640461980257620940], [124956146179241588020890226692780452315, 158677724002327739740087320276738107684], [119441163902917777983091728732768941075, 278380769941745959379770926506828300575], [146129479953622120600532924940949306340, 74622548612421648068796170044268595396], [249139959945653886907077442709258488964, 255530017395990686200371883509973903714], [332700807273392477890118469133684854578, 87848577169146107727022708092707486593], [45738632630189276479614628579912408296, 210698137797384600126324344635560672164], [283772296955785212999530362347693227629, 130483913747689072065107379857962413936], [70077457072102989172476067287692147081, 4726053129928505962043311345876939454], [87798375332812414237578974394613917281, 185748776134307925544210456707094084544], [1400400732483364072146187578230114986, 297379271400404266752290833320051922727], [27642382963411547480803171157563000061, 154617367677956130773859643347392873060], [205233180705808932020892382028195041781, 85656418677430528758585508945283898930]];

    let test_inv:Vec<Fp2<Fp>> = quad_ext_inv.iter().map(|a| Fp2::from(*a)).collect();
    let impl_inv:Vec<Fp2<Fp>> = f2_b.iter().map(|b| Fp2::from(*b).invert().unwrap()).collect();

    assert_eq!(test_inv, impl_inv)
}
#[test]

fn div_test() {
    let f2_a: [[u128; 2]; 100] = [[174406971591187532577705298530619297067, 219144869279903914781847181350978435516], [273353028293521134949622872099189388256, 176532942523124545805654851786973969122], [198981816169985501641346527210182162568, 265323234677897595829007649035347126949], [266968125559646267477442838834337788083, 230565065491432223807777880676885238307], [283611569930382170543797387556786379993, 320311955773880910875442119115864551065], [294005113981518242532751606844460156755, 223429944981778806156762332038732289832], [210732426404757464420338703701598751623, 219022710963061799561873887279038158458], [248629953311415512231700469440262894065, 302505193887824181137338825539964029243], [301067984250527614521955973089951710131, 268078175398344758279965849683685025081], [300541728442683048701600656120512381730, 311553934101341713635061860623501863473], [328251708715830175291910815737759552519, 280093269267237269844875815268472625079], [293573563608851668446059642854917948514, 197429240569462326350853629791671038642], [209991387440891093216292930727030725008, 200978239514513835178304242704710858278], [269814779980830229126089063542909050830, 291218352457904147259134072204983403755], [283127497541056998028010894720264869718, 215812238400976691189362992062340258124], [318332808602522965056875924436433937079, 264193515551784286279257201334200385297], [246564613855769992364459547145478990710, 250305453623463730339974355958055213818], [267893748327116225790788212602782700875, 279869293174182091345632657039355898424], [277441184223231718499039856054824479977, 338198699315337348865518273383664698019], [307379648796213556060906100102431002866, 265660111283715789301628045894132992296], [204156632252328444272210650246072601792, 232632431804554730869914942427228663801], [266161027224865530911247179221639154823, 186523858258610815959533523080866228201], [290681593512253573022199871945928392173, 293660212004874245907361220393676981407], [226994754062744436272311197990129751829, 336404698877908911143539681987416561825], [263500661401797224165785434518081132927, 322397685902507165771646803295191815033], [214611557385190178563975370685743774858, 274744441423794217352948844231432798799], [226699703760093194810901962675950842193, 220823866681047959762489679855751824869], [189348118647373921500161996758990638689, 215022642271109592977849264343007365287], [171354918074974526091680703557935224852, 319323126225831315431579717400456404318], [230219402513511552661259494156641323727, 291390827135550181504917868859399016337], [261936105219404796587420984104306950114, 308269541770210745021729575776186183749], [302586702473153683517790117847281515155, 191791142178133864457733153771177363741], [207562456976658795859089815138473200076, 198914479761092970545173733879758068452], [234620263481478077667663107645333133424, 191936541206920876787267435815830559313], [200608582974468186940862776793324866372, 269108159932556131422336549680473644357], [227642739967391709125974048156019925208, 316950052928724349031108155199156902356], [177476305387885923625556941151867829108, 317633642578225990195361379469672337588], [285840390245801352027750853020225443155, 228618436252891052984935890691330403803], [275623215861777922285827585986629135501, 249119419129547744789036458175734558088], [207252424968247720425173048612470511188, 225661857869710104952495864677669872405], [184963389035847465016368421426649833334, 223377022770086530883770720720086154403], [231832770651334170648059077772857143196, 323614763802982786230424536580539219138], [323591133055692951129187463266588937484, 245378302213974027674326962356651522410], [205212211621986006608539427413824555398, 246707946108923410088449967869232095918], [179447058542990065180216122399111317042, 320583828712788265106840481377922099036], [250604600273304930320763015307891253469, 213781570026415919288112772624900720504], [261431978981259678351703972456106709589, 236945234287073600407013159743481009337], [240431756598800771820483111003824160836, 269301911302568014362550332678032017627], [195694955681705789199144659657748352464, 332165182770104088260872456083568720337], [308840952762164815563403493808449488382, 177407521141864774426534017916347556285], [301061493274618792902931005800466873424, 201048326597270662766230852422005658496], [300832066491507440246527377162476062013, 299591901501544687102392979148396283881], [260390111731085200071377235215593088894, 266859136606734281593642390533164026348], [286819110407827932732524931380550938317, 204063829619441272654425963296354048962], [253006067564119864218534975283077258386, 298190356581773744993127157634772411296], [178142023420163004656832803426678084966, 178114599347353441030551553179210135422], [260577369348379108805214349137287127690, 229014718243463412335613501418420031594], [226192344752234292386443876995211991478, 326316357382602195295072571351598338043], [203370514551421496915834667254781615590, 272421822517682029669952180841475300809], [329050953312042147915396811743193441892, 214487085037583246495663912794896630445], [181566191693489726745036506250149601144, 205793524314788121004230800609712437167], [189315886774540971768846357162454904318, 300653042731173892763532220662086304377], [213776461720607525871017077856134245262, 180514187440765578418127079069314736980], [219808710268616328585999447625827969004, 248256807501948668064828338181480564845], [323606520381566497629725356479691541937, 227947891191366650176576457388083446504], [251854458876219917904372933515284831197, 238637863136454667895874022906777089485], [323462134996048656473293650701159402547, 269600576095487885081154604143518689636], [270212435678530101376424604960680211667, 235360230496087202111315256085984173292], [305337634168873644454739545569990473705, 219461855330335304523081184720220480972], [275439646257100762489959591393973837669, 223598118659766656036439094328871131307], [278229616727698593928971599975282595471, 280637185452865724306509968410692705434], [336787481429331481616072165270836092809, 294833441109056072189961741454959534835], [252321822179247184744034404064517925280, 300501666776966818098422265640272652676], [262121214045757074094426801874969317808, 246313447874821962448347652434970196949], [289391802164114755791445354722334628552, 305888089603500677245307495306176307125], [293182346132637147205582082915261700671, 187907956781653407011971327945815118555], [252367434614446978246508341287429071902, 281855853436633642681542617301931715827], [172993424507119854686228227508956353012, 297567001782272919101302096920545638429], [285159706837272952353542128861664342530, 239379755681466538575995625528935131993], [189047243051601303641202590787335593391, 206004117001208181679503727830004502369], [316157761469015661506396796541579662898, 239302931240391603430904372730550333255], [223000960683804875337158054021708845669, 231645935573106877245845718221590225182], [253972157925737779384962355241749120590, 333138121021722339893097562205708515148], [241458504178745352744900612061985631045, 184162333313436223014862643216955562864], [222302601796071233403679567140470100891, 175885238140532604596045611689355728756], [230270555280495443463209747554449127757, 261324281329602267747183299438025874851], [246345083094371693758864388035639480439, 251059235628702160939829829274004766773], [174085084424215708261067864608968990931, 287512348480364223587477174394091917910], [179548895624876743709369083813246874679, 251193827308867337127235425638156899778], [215207169964025281188379043359686076327, 183054319130203442041140461823526348318], [182359414140244115854161477891097494465, 230559271741623964301684653941895809955], [224858292811209448567312375324531572861, 292217643391827349760621342656498324903], [278747487954339590139509297069625054828, 258726452392107906570966935838957890913], [316160657532095243047824354804693481361, 208867262461656046823627195745200792629], [274456180119635224494017551427963964105, 289490077305068221215896895405195079897], [211921054014305312551383131318737424629, 242718558902851983435760850743228483261], [280589933576620290865233287231267475126, 266331112221476847671910032147592941798], [190196479105693496182452311740744965577, 224339669168716217943333725501099600553], [227630184444351855593884546610815383002, 251783565425267189241657984486758231073], [219605863144177352033679176569502755697, 325284478827487772645489157765674692654]];
    let f2_b: [[u128; 2]; 100] = [[308952369500670449439528974078638856322, 312060782669695918279236300205228036550], [332139335567313838605424762155618996302, 304914288737209928836335437593295369251], [187813176247726390171868653858627204898, 190490230261523069592228138513188474270], [329261206314728232738310413309920396772, 179235429852190745898283297311367652377], [325354051654780761776638268628177078890, 324205066583550203280610719442830528195], [182829934919023643454729428270035393381, 182474281329811147046528600310534912736], [296705992984758357482837468528080799798, 337787214942738552073741233432123811001], [170456630767760171449637532287884159766, 205770390831338324767807128143312145588], [318454801747612778059950388973124643911, 282441078182195496116481678310242897249], [199614830160497803767111027322945406394, 170767108835369152512069031621629133310], [286099857605814991354149364764438179114, 288042366421119657934785519100170730057], [284972827975029105804010017017216607004, 292834150427608935542467625344466998367], [222442312984086401794643212871165669277, 338374958290032846479040814169955973118], [311412188416449827456940552096383109590, 298709341681257208135691070369334188486], [253185264993940074345755783409411188065, 246560279473299414355163147341725805365], [284962062297479862853548352023640537713, 205238043429478236902872563990455475128], [200469882203578305107119232927514783664, 288124732903370820506976684009068163535], [301960453030629360791160282409956942811, 266446943037249378236972666580535263815], [333314437553769013168096943622752137158, 291108401241109358391911452321262535734], [333591350862527112608449598805040031470, 284718536088399058700861480741563694076], [193302593060888769258844812517289955594, 170710577032583090125869558675220645242], [180444790489426333340294178870171828241, 194984378678097079930008296395285104258], [283341455012975095064937359348745084528, 326682747702724760264268907385330396173], [213321803685512380827717791703027107817, 335307317705409907776862766471807548366], [258668569596199460598322404145335028940, 235793401403758251915950798246512708497], [288747840899594244985154292835940355834, 193999535902873887715317708230350459778], [180426217538849536854032936408089304331, 224319209016700946449044016911279992285], [249601426024642662401063128395573646235, 314038033029503383511028889039408957987], [295792491407573845107686310508769863974, 192637968641716413336967442829621324246], [269180927676266372351410881389571410214, 262703749702567186019744293283669267598], [291217349328060380300575769340319954021, 287178476395255436814949722598137024890], [178379715013985573076049444065470154703, 279834369291394317847131663848892816110], [205729911716145446066121402996684167933, 325366247652056733364829347158602796836], [208605005535310934039386510923381744132, 177676400578315947396202635296311566538], [305285473512022524450103847865338359466, 175971312511585058555413698450782255612], [229553166632429194672384240229609619509, 198139189167155303609918186611918602926], [230910685127622921218619026404037177031, 171522864043818459103253603333226470246], [184918539956477480306971848424921015173, 178235576387608228047519943540311973277], [301138608710716288935613312406925802351, 265613802942803275557375364936092731181], [307586671709241018238840829673952968356, 280226296903574093750779425405465366009], [263595525692507907265084644452555322423, 206758076098848354680614159897532345223], [221014513621512897850214218784028069602, 211859432052588317847187903900179213154], [280065174154683459233739645541602269435, 332222234697679178247664036870540377119], [171642642345265115810485134431747692775, 195954359085860892545321770401565070596], [326538377762332527105363714083557661090, 206118649480395966797850942668509705256], [230531157157034655218596856275457967122, 278879737426111128292080715951988224888], [294267943329046506728469886939110707317, 251557307288840761374082146664943220399], [339779509773580817369188711320032722335, 257305684660530668831544363967769224974], [248866211643271047664391416085965948041, 311772694146790801169008382119083417525], [226677881669551053364680291866168279037, 310267783552082303182819795193873840639], [332760714745168434034607429594006079601, 226436511605227556040791031612871549779], [212753215123521436322132760157948407646, 306220729045238098171470847341694249464], [328682384706243774314436736764223820125, 255405490934377165878738593012828292528], [185810599061174559699829293266736865809, 316747986856770560764742513507258920372], [324543966366582741204628877582623786782, 185111499967856698959536786931758767877], [329324158603550663631124373139872889963, 290810761974936501759367769667878966197], [193328439156425880652797521721270855677, 336199421625272156510862232737282208025], [271984380962099771177729065072923884027, 246497734780688601780570619011935459061], [190469843547860200001260510097408045609, 268820700910006049761050282636867615034], [211417318689812929757076585128587634388, 217636899532821099528736745894897785223], [190876805948095467751547943955648826189, 245006346538688033564458332718388143838], [188251078757953246621324056993259795117, 225318995072076288517253781569562314489], [202292490294944402299818938984496629345, 240557553305379596557655645802026128194], [262539911809149162521377978584612735883, 254556483906734750516854706617712774871], [173848457034150260354443330599820658193, 297163647488881454815500556391055119352], [219493617018342747713032495351632051827, 187878979825127912400782858316183399167], [325221145828899911165987686973546333082, 304185903076241709496793630344385502401], [311009494776135366540471852076046893197, 334676442202365476582969659923417599974], [298087081678182501517781000133826586871, 283069170218850974331980702062854890099], [182497615246871695912509601645518579137, 323460638954100426280127324012845356594], [263969549884310718099911125716026411229, 196386246865999653051852718990952549797], [236102338802645651616425168537643176951, 224431186205169890323552223910530109802], [173229754870019219102103847771482557985, 269830339850374171311805130225546554382], [222293639913106334732607011121511179514, 269187234358147711678596427326809056927], [182689953649613549628386449959696622056, 213918164903751075326425749496315530990], [213434707336016490324112191217828255691, 251956117455235122871962804472932345781], [331902161002113254243564390909408938463, 206488184696768654765829643929013042401], [201769189004384972412651138302202510492, 222918959743203929924232288406213652596], [307985422964117273646236015626162697823, 291074392354212447298884393082962646692], [250414424406498210869227326440243194428, 204338863964986045417165863926317869049], [200498089961873543514910995601010338266, 298901362814386471218774469150903187504], [223188124319866465556851256933735859034, 329051437591060882594725930339891673592], [298229165148893501884150828191947303551, 269953245665952630394445582648028061871], [249004789129553110068172434340965142504, 302162586514640545130564792895850313073], [309750546813556980964398246868926744080, 337411319297314100308829140554946374967], [254837705867891706116944016386013802958, 315914045483830667626721921695262636780], [272842909726799011503799607901574070530, 170892855775935873283349074923806208284], [302224136917079014849504540590796541531, 228835479449188583251934973507933127122], [208659306963321091776538586694897938984, 180842097146239808395189868729224004386], [320387488897279267638302198260127246446, 326277117282078972361923082957571763270], [222806569535988766143425571588144968740, 203246941104603161599344377278472314093], [316518074599496307197558971611025222400, 180043461116888734520497481319705306675], [232404113076579833999773846116509910215, 273579381313471345530538924201674237476], [224796853841316250655878672681938733763, 246769841383527853037569146485644875418], [205216032265310336570358952832655751403, 296189950332203705518446315600313110282], [259673292517168998723991810152607680664, 226848319398376111851825047582877786299], [263430446960263199971110889067060239677, 335314681160472512153855863506369455233], [247425028346801351761963361464866080200, 292127924297224617358332318068842728883], [282701235111484633063826864873243861714, 223666169064189881377718841944197766768], [267920111895604379486980548222275372082, 308624491694471215020169490801447081007]];

    //Result of element-wise division of f2_a and f2_b in SageMath when seen as elements of quadratic extension.
    let quad_ext_div: [[u128; 2]; 100] = [[33454022812487246727301405749048192948, 149053066603236149515231870312728746942], [270227340962926953434811582810712733916, 336776088234348905338764991782654555118], [234515314920814692910403920357237036232, 86447750374810406268952987150744350205], [22983074515672710074861143424023595770, 96978570271396777663492553441701320969], [308061833552644332643717325186447528098, 105309346616432673182524546154773884780], [309265809589715280431889223674828510649, 120689642917428116766369163753146309210], [108570060666672846282816688323311044233, 239456178295441350960853225616242674525], [47143964218468936221665801634065496806, 129386019119326387473074570483693941368], [198548439799961749319466110736214501352, 178877499192216268572035646509022056026], [233356131242994969550808686061035869766, 192890059086522152010584122668456716129], [302227361953588902515515870540989214118, 138436656859571677900689498389079261438], [245366501330214157159443636653563024455, 34167734904875500976077822278999005690], [231674574043709903980135044523064052135, 290974604470369113476256070684450032317], [9205002386496340349689841726114629368, 77539075385744430759222898903638829379], [282890130959816653699438426279021488257, 174705111409693260673548847893422953505], [264726963436833133831037917191481819140, 189072895933098156807547523300403608423], [295737254977301679643992342950935753674, 330122947718780785535320090473346358230], [142415046862319898700371124723530857391, 152687489345063053758518541477338364291], [150034401390621585626631025271535253453, 195147940754340781496237061514766922451], [142615459745197677722914338648942582209, 136370595940552954663474333123219780103], [66181209449296560667806681067629865120, 284970755145101778477367669972980191786], [328747829593596460069481815341071033956, 189870435795267351948437675849388805184], [208144138070945227942824376078486433791, 282883052016461075288389536305819174855], [336918407744555428306770954403807818025, 26125939137931073477426699462896342251], [34854888002484610896015560030648079381, 264937047678583273795684626106177322322], [116233430657853409409960551571753568697, 242373630237086859989076093937861809639], [133298883870743948450895073199443654885, 191725757392322669328852180334513407994], [3881468014840260975183130727101925251, 126995529638900904945357807729591787837], [185532827641675305532349716829821659869, 61605058746508654315941271830140414669], [79243219799866723474233076098271466863, 30717631659127469005625350947288246580], [111636028361379161846191009678929125221, 226963928844958248119774348042255478193], [64229659586938159117987368478016271608, 318233250468226756673384608242256866869], [307895069063472197826751859110803607774, 20620201493134527033098913151365180184], [44655737767181049110352540088918580487, 114469695261431558834172575494581077536], [236818337154668179498840971985272108710, 272557448955413091788590399622882394158], [278865000389833615296359496685666385817, 101850108222762345270554234039817139829], [217715326808331469505701811376189452285, 195389802093381436622095962912312517467], [209137610440599803421288435523178124347, 327269946061634591181713452755951618336], [333736183256086967725510848024028654316, 298085593571841820398055362050578867734], [297247030835190366605429600668135022542, 249481899961352458487484605471296034869], [57324892463515646878944464948343733112, 124289470030989685054191806472491874536], [227712311238695700196873982965956415168, 240210178993796563056892608788259192535], [280032653566542043817924285541179324951, 214207000329093471307025274647564148384], [171160381010401562014601604401626852527, 101281071149474584674805048395203131841], [47417803442757597550553742259928469457, 305415962864027645551003019626246635321], [176988617056287811313012093240942061640, 303839138229393640171857580252323780665], [299591211965410318425525108440409640589, 15767264063137794055859056060361129502], [135058587990141917915519807246165241857, 306264574518387396752723640772480206916], [303430371137842549917747666823105801662, 52528676763593889728682222580893238230], [301662854517066831819545220147900131068, 278791928033309498978632408906795906896], [127894481955995751972964377750155674229, 146436634888563595088519490939483870118], [6641033279913749030651869731810994187, 198804187124948719332087964540045750096], [7531273468188039562377685657107331409, 322094405989053674439896625649665850751], [61480518292595207542238952217334762834, 148160969122447254083812501331844337844], [220330478816393124375077432950324198905, 9454993228009708560654699394422839733], [128067287122455110542744082472585227837, 182877570012962184295030827891863810138], [181399733211819836035174489453928881462, 154560322898677591218556365340897642964], [144800728694480615973954328093355496370, 154108756311642522134572164483407111234], [117670574275247230001553676516781147812, 11942811070851662196007209353501669700], [327885623703489688351058965019056189385, 306717428853355918754567119751037131209], [240772891601022737842638505073558298227, 310515743900398498392119558414297567813], [205853225334256644108791699698893903398, 278130701749650787241454319772001888606], [220959928217999733302567763203071700266, 54683960240544005378964519405210870185], [49438161283447703128654884395685975926, 265944215463391711680034450451168857536], [165467067591518511551855002598938245697, 33136736496359455734516058183031516069], [53900223883364222928130173716882455768, 120987157218541448899728689526601752012], [338515145347827652363499587102910873614, 114235764132800766978496483707541410387], [63858078866906877679038101290046310169, 92174305268443450846646518405084706956], [162989331991225867412851161536145569267, 320290261642633507300465327965541808427], [339709816776409745421858589806889819794, 235378491187149947215300201898573733123], [260323130688884854480847256805167314848, 202184530373622058285731123843757383809], [28494115957309646083575344513715049842, 32366904815449045499627820804811990436], [87833300555713348902087959882098645082, 220144888703175656669895644104247375700], [259339819249871945221926846305638452308, 145932265988889956206186593375057305293], [194466246691673793837974772554076670695, 104122511181406921014651999465113760751], [291232116882256748898513330792723086355, 158180573150964282007039322376692374791], [280223293064746536525966537864977953629, 173765336279513751634384290651941638072], [205353800772741542989849032924704438389, 38948926836273509630621183766101620330], [282510307379172498705614011211167404320, 49252979495566537641420840491960403118], [315514272017020688915362675943853542719, 49877314303787850123889057899007687265], [223280903271958827287886598471508914937, 99117651764852304994617089890056300324], [254203644174347576796995184233371632913, 99184018301689500369338956828363868073], [90726625264043811455297707531957571856, 275248148270259242524804793963928516994], [263657253414922083472462935625041337714, 58986186604566060128671511343295907111], [253966962441074534398674640155908983961, 288952146755635414643154083820732655186], [75060426994308661136683563553761515541, 77129340217066770230588479224222443629], [7298051880594178376290241716447345055, 301008629170087340215942971447001542300], [393798661846052183503073748540729872, 63102098276350070357413947828569837004], [239321441123282495284915755428063572236, 109257320659256566002286775094425235623], [229567075786883449896825409750132543136, 82003803253534720113011430513554519], [43917107579908588213432550267443468019, 62032749337885326701488439739021237124], [186847363868822805334283400017846989114, 88838030082026482157622563972180570107], [216483001654236769284619105847032705199, 139381547656589553132564012235799729346], [290169772478349442425183972126390636670, 20783986407576444189552854882382416254], [161513826692610741205179281179920523729, 146669148845040211463977648492733706542], [299534985237253300192681418735959516069, 81876976665685359657258834486152020020], [271964420935166867320865094994867288934, 213483013716468068904586847782688747005], [124080879012176497990971346519926110186, 123553622925585996537599681666401455104], [24297972938265560601846269218556161947, 173504995302406681310263887440846181538], [277806156197137674833871110003313077843, 238033273502211324107388997884558765090]];

    let test_div:Vec<Fp2<Fp>> = quad_ext_div.iter().map(|a| Fp2::from(*a)).collect();
    let impl_div:Vec<Fp2<Fp>> = f2_a.iter().zip(f2_b.iter()).map(|(a, b)| Fp2::from(*a)/Fp2::from(*b)).collect();

    assert_eq!(test_div, impl_div)
}

#[test]
//Comparing as_bytes against the actual byte slice respresentation of quadratic extension
fn as_bytes_test() {
    let f2_a: [[u128; 2]; 100] = [[174406971591187532577705298530619297067, 219144869279903914781847181350978435516], [273353028293521134949622872099189388256, 176532942523124545805654851786973969122], [198981816169985501641346527210182162568, 265323234677897595829007649035347126949], [266968125559646267477442838834337788083, 230565065491432223807777880676885238307], [283611569930382170543797387556786379993, 320311955773880910875442119115864551065], [294005113981518242532751606844460156755, 223429944981778806156762332038732289832], [210732426404757464420338703701598751623, 219022710963061799561873887279038158458], [248629953311415512231700469440262894065, 302505193887824181137338825539964029243], [301067984250527614521955973089951710131, 268078175398344758279965849683685025081], [300541728442683048701600656120512381730, 311553934101341713635061860623501863473], [328251708715830175291910815737759552519, 280093269267237269844875815268472625079], [293573563608851668446059642854917948514, 197429240569462326350853629791671038642], [209991387440891093216292930727030725008, 200978239514513835178304242704710858278], [269814779980830229126089063542909050830, 291218352457904147259134072204983403755], [283127497541056998028010894720264869718, 215812238400976691189362992062340258124], [318332808602522965056875924436433937079, 264193515551784286279257201334200385297], [246564613855769992364459547145478990710, 250305453623463730339974355958055213818], [267893748327116225790788212602782700875, 279869293174182091345632657039355898424], [277441184223231718499039856054824479977, 338198699315337348865518273383664698019], [307379648796213556060906100102431002866, 265660111283715789301628045894132992296], [204156632252328444272210650246072601792, 232632431804554730869914942427228663801], [266161027224865530911247179221639154823, 186523858258610815959533523080866228201], [290681593512253573022199871945928392173, 293660212004874245907361220393676981407], [226994754062744436272311197990129751829, 336404698877908911143539681987416561825], [263500661401797224165785434518081132927, 322397685902507165771646803295191815033], [214611557385190178563975370685743774858, 274744441423794217352948844231432798799], [226699703760093194810901962675950842193, 220823866681047959762489679855751824869], [189348118647373921500161996758990638689, 215022642271109592977849264343007365287], [171354918074974526091680703557935224852, 319323126225831315431579717400456404318], [230219402513511552661259494156641323727, 291390827135550181504917868859399016337], [261936105219404796587420984104306950114, 308269541770210745021729575776186183749], [302586702473153683517790117847281515155, 191791142178133864457733153771177363741], [207562456976658795859089815138473200076, 198914479761092970545173733879758068452], [234620263481478077667663107645333133424, 191936541206920876787267435815830559313], [200608582974468186940862776793324866372, 269108159932556131422336549680473644357], [227642739967391709125974048156019925208, 316950052928724349031108155199156902356], [177476305387885923625556941151867829108, 317633642578225990195361379469672337588], [285840390245801352027750853020225443155, 228618436252891052984935890691330403803], [275623215861777922285827585986629135501, 249119419129547744789036458175734558088], [207252424968247720425173048612470511188, 225661857869710104952495864677669872405], [184963389035847465016368421426649833334, 223377022770086530883770720720086154403], [231832770651334170648059077772857143196, 323614763802982786230424536580539219138], [323591133055692951129187463266588937484, 245378302213974027674326962356651522410], [205212211621986006608539427413824555398, 246707946108923410088449967869232095918], [179447058542990065180216122399111317042, 320583828712788265106840481377922099036], [250604600273304930320763015307891253469, 213781570026415919288112772624900720504], [261431978981259678351703972456106709589, 236945234287073600407013159743481009337], [240431756598800771820483111003824160836, 269301911302568014362550332678032017627], [195694955681705789199144659657748352464, 332165182770104088260872456083568720337], [308840952762164815563403493808449488382, 177407521141864774426534017916347556285], [301061493274618792902931005800466873424, 201048326597270662766230852422005658496], [300832066491507440246527377162476062013, 299591901501544687102392979148396283881], [260390111731085200071377235215593088894, 266859136606734281593642390533164026348], [286819110407827932732524931380550938317, 204063829619441272654425963296354048962], [253006067564119864218534975283077258386, 298190356581773744993127157634772411296], [178142023420163004656832803426678084966, 178114599347353441030551553179210135422], [260577369348379108805214349137287127690, 229014718243463412335613501418420031594], [226192344752234292386443876995211991478, 326316357382602195295072571351598338043], [203370514551421496915834667254781615590, 272421822517682029669952180841475300809], [329050953312042147915396811743193441892, 214487085037583246495663912794896630445], [181566191693489726745036506250149601144, 205793524314788121004230800609712437167], [189315886774540971768846357162454904318, 300653042731173892763532220662086304377], [213776461720607525871017077856134245262, 180514187440765578418127079069314736980], [219808710268616328585999447625827969004, 248256807501948668064828338181480564845], [323606520381566497629725356479691541937, 227947891191366650176576457388083446504], [251854458876219917904372933515284831197, 238637863136454667895874022906777089485], [323462134996048656473293650701159402547, 269600576095487885081154604143518689636], [270212435678530101376424604960680211667, 235360230496087202111315256085984173292], [305337634168873644454739545569990473705, 219461855330335304523081184720220480972], [275439646257100762489959591393973837669, 223598118659766656036439094328871131307], [278229616727698593928971599975282595471, 280637185452865724306509968410692705434], [336787481429331481616072165270836092809, 294833441109056072189961741454959534835], [252321822179247184744034404064517925280, 300501666776966818098422265640272652676], [262121214045757074094426801874969317808, 246313447874821962448347652434970196949], [289391802164114755791445354722334628552, 305888089603500677245307495306176307125], [293182346132637147205582082915261700671, 187907956781653407011971327945815118555], [252367434614446978246508341287429071902, 281855853436633642681542617301931715827], [172993424507119854686228227508956353012, 297567001782272919101302096920545638429], [285159706837272952353542128861664342530, 239379755681466538575995625528935131993], [189047243051601303641202590787335593391, 206004117001208181679503727830004502369], [316157761469015661506396796541579662898, 239302931240391603430904372730550333255], [223000960683804875337158054021708845669, 231645935573106877245845718221590225182], [253972157925737779384962355241749120590, 333138121021722339893097562205708515148], [241458504178745352744900612061985631045, 184162333313436223014862643216955562864], [222302601796071233403679567140470100891, 175885238140532604596045611689355728756], [230270555280495443463209747554449127757, 261324281329602267747183299438025874851], [246345083094371693758864388035639480439, 251059235628702160939829829274004766773], [174085084424215708261067864608968990931, 287512348480364223587477174394091917910], [179548895624876743709369083813246874679, 251193827308867337127235425638156899778], [215207169964025281188379043359686076327, 183054319130203442041140461823526348318], [182359414140244115854161477891097494465, 230559271741623964301684653941895809955], [224858292811209448567312375324531572861, 292217643391827349760621342656498324903], [278747487954339590139509297069625054828, 258726452392107906570966935838957890913], [316160657532095243047824354804693481361, 208867262461656046823627195745200792629], [274456180119635224494017551427963964105, 289490077305068221215896895405195079897], [211921054014305312551383131318737424629, 242718558902851983435760850743228483261], [280589933576620290865233287231267475126, 266331112221476847671910032147592941798], [190196479105693496182452311740744965577, 224339669168716217943333725501099600553], [227630184444351855593884546610815383002, 251783565425267189241657984486758231073], [219605863144177352033679176569502755697, 325284478827487772645489157765674692654]];
    
    //Converting into quadratic extension element, integer doubles contain elements less than the Modulus and thus remain
    //unchanged after conversion. 
    let f2_a_as_f128p2:Vec<Fp2<Fp>> = f2_a.iter().map(|a| Fp2::from(*a)).collect();

    //Converting backing integer double into byte slices elementwise and concatenating.
    let test_as_bytes:Vec<[u8; 32]> = vec![[43, 13, 15, 186, 210, 71, 89, 120, 189, 255, 204, 199, 151, 143, 53, 131, 188, 185, 187, 191, 140, 26, 110, 40, 216, 24, 100, 70, 63, 196, 221, 164], [224, 115, 35, 3, 57, 36, 202, 78, 238, 234, 51, 131, 213, 224, 165, 205, 226, 250, 48, 211, 174, 52, 67, 158, 180, 150, 34, 113, 13, 2, 207, 132], [136, 56, 110, 213, 159, 13, 166, 69, 238, 141, 162, 5, 250, 128, 178, 149, 165, 106, 113, 120, 106, 222, 167, 162, 57, 12, 198, 88, 113, 101, 155, 199], [179, 176, 167, 9, 37, 198, 30, 110, 196, 205, 49, 27, 211, 48, 216, 200, 35, 146, 254, 48, 201, 233, 24, 83, 135, 217, 35, 106, 100, 55, 117, 173], [217, 156, 237, 71, 71, 101, 163, 136, 73, 94, 59, 149, 252, 153, 93, 213, 153, 46, 16, 137, 45, 133, 46, 183, 33, 31, 137, 40, 182, 214, 249, 240], [83, 199, 220, 187, 6, 187, 186, 134, 43, 251, 90, 174, 69, 83, 47, 221, 40, 151, 57, 128, 118, 109, 5, 223, 143, 16, 205, 109, 202, 10, 23, 168], [135, 75, 247, 176, 236, 20, 245, 81, 89, 26, 1, 115, 202, 150, 137, 158, 122, 86, 81, 229, 18, 95, 58, 206, 120, 48, 106, 140, 96, 61, 198, 164], [241, 241, 30, 5, 104, 108, 3, 203, 223, 90, 127, 140, 32, 99, 12, 187, 59, 201, 6, 218, 45, 236, 102, 77, 60, 207, 186, 89, 145, 97, 148, 227], [179, 123, 171, 118, 38, 87, 155, 25, 135, 184, 72, 108, 169, 149, 127, 226, 57, 37, 52, 234, 198, 171, 132, 108, 155, 207, 244, 213, 129, 250, 173, 201], [34, 3, 34, 93, 199, 88, 245, 166, 177, 67, 180, 75, 63, 59, 26, 226, 49, 170, 21, 135, 224, 107, 215, 204, 219, 116, 133, 175, 231, 26, 99, 234], [7, 84, 10, 229, 67, 246, 157, 85, 240, 106, 34, 63, 193, 250, 242, 246, 183, 151, 252, 190, 90, 249, 168, 128, 36, 114, 37, 12, 95, 0, 184, 210], [98, 68, 126, 201, 156, 121, 180, 185, 49, 40, 241, 50, 50, 54, 220, 220, 178, 50, 182, 102, 68, 166, 94, 12, 212, 232, 110, 236, 22, 125, 135, 148], [144, 153, 246, 175, 11, 148, 14, 83, 1, 117, 136, 195, 191, 222, 250, 157, 38, 118, 51, 124, 79, 9, 64, 98, 98, 170, 20, 64, 63, 0, 51, 151], [206, 31, 224, 107, 67, 178, 251, 40, 161, 137, 51, 62, 185, 111, 252, 202, 235, 4, 86, 168, 253, 253, 224, 112, 68, 170, 204, 48, 82, 157, 22, 219], [86, 151, 0, 174, 214, 218, 88, 43, 74, 93, 25, 13, 96, 95, 0, 213, 76, 217, 199, 210, 37, 190, 10, 72, 244, 240, 95, 226, 219, 236, 91, 162], [183, 162, 186, 252, 196, 232, 71, 14, 249, 169, 72, 228, 56, 171, 124, 239, 17, 63, 129, 125, 55, 232, 220, 202, 236, 196, 166, 78, 253, 209, 193, 198], [118, 235, 1, 19, 113, 200, 156, 131, 159, 142, 44, 181, 7, 158, 126, 185, 250, 154, 86, 97, 196, 147, 189, 105, 101, 48, 116, 162, 171, 19, 79, 188], [75, 85, 145, 41, 253, 29, 175, 185, 241, 161, 30, 239, 140, 117, 138, 201, 56, 106, 25, 206, 127, 46, 164, 243, 82, 212, 170, 79, 127, 221, 140, 210], [233, 44, 162, 241, 102, 170, 101, 161, 230, 53, 250, 181, 123, 58, 185, 208, 163, 194, 67, 229, 35, 112, 22, 75, 52, 248, 41, 98, 65, 179, 110, 254], [242, 80, 72, 36, 33, 89, 142, 144, 239, 113, 50, 239, 191, 42, 63, 231, 40, 137, 36, 157, 107, 77, 16, 239, 159, 134, 233, 228, 189, 70, 220, 199], [192, 140, 193, 0, 233, 68, 110, 100, 164, 63, 108, 155, 27, 35, 151, 153, 249, 239, 153, 17, 119, 235, 175, 218, 255, 4, 48, 203, 107, 96, 3, 175], [135, 204, 196, 154, 255, 88, 87, 250, 114, 88, 71, 240, 205, 191, 60, 200, 233, 231, 124, 19, 30, 150, 5, 240, 253, 205, 63, 189, 58, 48, 83, 140], [237, 189, 88, 221, 205, 55, 193, 255, 22, 27, 156, 211, 15, 61, 175, 218, 159, 68, 42, 43, 57, 90, 88, 250, 150, 217, 131, 182, 74, 230, 236, 220], [21, 215, 63, 243, 13, 243, 252, 15, 108, 207, 200, 185, 114, 153, 197, 170, 161, 24, 224, 143, 94, 20, 176, 78, 204, 131, 89, 112, 52, 48, 21, 253], [127, 89, 2, 249, 122, 161, 225, 237, 90, 144, 226, 121, 164, 97, 60, 198, 121, 211, 193, 179, 107, 181, 201, 186, 9, 126, 178, 121, 37, 137, 139, 242], [138, 60, 66, 34, 8, 178, 31, 152, 186, 220, 88, 224, 182, 174, 116, 161, 79, 2, 219, 242, 237, 166, 84, 67, 29, 136, 153, 65, 204, 218, 177, 206], [81, 241, 93, 185, 128, 172, 72, 1, 213, 204, 39, 88, 88, 198, 140, 170, 229, 133, 200, 111, 49, 111, 239, 242, 164, 94, 165, 212, 53, 33, 33, 166], [97, 206, 86, 244, 125, 21, 141, 11, 84, 31, 242, 114, 4, 31, 115, 142, 167, 8, 0, 233, 7, 95, 230, 143, 149, 249, 154, 153, 195, 218, 195, 161], [20, 216, 94, 147, 238, 97, 251, 97, 99, 77, 79, 150, 188, 193, 233, 128, 94, 29, 141, 67, 150, 21, 210, 3, 122, 236, 166, 153, 166, 101, 59, 240], [207, 74, 25, 137, 62, 197, 67, 221, 120, 134, 142, 66, 228, 164, 50, 173, 145, 15, 223, 68, 68, 118, 63, 77, 54, 204, 13, 173, 250, 212, 55, 219], [226, 63, 25, 209, 17, 156, 239, 229, 179, 145, 213, 44, 17, 15, 15, 197, 69, 176, 34, 77, 202, 77, 130, 117, 74, 19, 220, 93, 220, 141, 234, 231], [147, 58, 189, 84, 102, 132, 36, 28, 126, 255, 63, 85, 64, 20, 164, 227, 29, 201, 71, 19, 145, 228, 30, 34, 170, 151, 33, 131, 96, 161, 73, 144], [204, 201, 145, 217, 211, 174, 237, 114, 80, 19, 68, 53, 59, 19, 39, 156, 228, 26, 146, 54, 21, 178, 182, 144, 155, 181, 239, 13, 9, 137, 165, 149], [112, 88, 153, 61, 31, 2, 197, 75, 38, 201, 89, 238, 22, 56, 130, 176, 81, 26, 184, 14, 93, 99, 25, 114, 164, 63, 130, 67, 26, 162, 101, 144], [68, 75, 4, 6, 77, 57, 24, 3, 52, 121, 247, 195, 197, 206, 235, 150, 69, 29, 159, 160, 233, 4, 45, 190, 99, 235, 29, 89, 170, 88, 116, 202], [216, 32, 165, 105, 217, 136, 186, 165, 79, 171, 196, 174, 158, 101, 66, 171, 212, 217, 151, 187, 91, 52, 245, 58, 15, 192, 120, 156, 26, 92, 114, 238], [116, 251, 228, 192, 90, 62, 184, 1, 40, 175, 239, 198, 110, 177, 132, 133, 180, 80, 220, 199, 30, 109, 155, 234, 96, 109, 170, 1, 173, 3, 246, 238], [83, 21, 157, 9, 41, 244, 204, 150, 111, 112, 238, 247, 79, 219, 10, 215, 219, 237, 55, 105, 185, 160, 248, 28, 239, 186, 165, 41, 41, 79, 254, 171], [141, 236, 178, 201, 14, 243, 234, 2, 219, 213, 204, 8, 185, 25, 91, 207, 136, 45, 5, 25, 83, 146, 246, 34, 115, 190, 1, 185, 167, 167, 106, 187], [84, 214, 49, 113, 228, 190, 192, 254, 127, 142, 127, 29, 121, 93, 235, 155, 21, 35, 13, 76, 163, 171, 238, 24, 205, 18, 57, 145, 151, 228, 196, 169], [118, 31, 251, 100, 150, 210, 151, 222, 222, 68, 252, 30, 40, 167, 38, 139, 163, 188, 240, 0, 140, 185, 151, 30, 149, 201, 47, 53, 134, 217, 12, 168], [156, 111, 165, 242, 127, 58, 235, 177, 14, 45, 244, 13, 21, 94, 105, 174, 194, 252, 74, 94, 98, 235, 34, 80, 62, 171, 154, 67, 184, 239, 117, 243], [12, 205, 59, 175, 212, 146, 98, 43, 152, 96, 8, 77, 162, 98, 113, 243, 106, 121, 75, 57, 152, 167, 138, 130, 172, 251, 160, 178, 89, 36, 154, 184], [134, 201, 94, 94, 216, 166, 62, 173, 10, 238, 67, 92, 48, 111, 98, 154, 174, 34, 139, 143, 32, 32, 209, 3, 89, 155, 78, 21, 219, 56, 154, 185], [50, 6, 249, 209, 92, 125, 93, 192, 59, 138, 221, 169, 16, 63, 0, 135, 92, 167, 104, 202, 216, 163, 252, 205, 71, 25, 215, 20, 21, 51, 46, 241], [221, 32, 75, 215, 37, 73, 42, 95, 216, 4, 183, 47, 189, 176, 136, 188, 120, 135, 120, 103, 85, 14, 240, 56, 109, 179, 22, 156, 45, 213, 212, 160], [85, 82, 194, 154, 115, 213, 140, 149, 1, 163, 108, 124, 185, 247, 173, 196, 185, 84, 129, 243, 235, 222, 49, 108, 75, 50, 190, 30, 0, 254, 65, 178], [68, 128, 53, 178, 191, 222, 235, 101, 233, 121, 116, 120, 210, 120, 225, 180, 219, 72, 139, 46, 199, 209, 35, 175, 78, 86, 63, 114, 88, 169, 153, 202], [208, 141, 71, 196, 69, 131, 102, 141, 140, 255, 26, 46, 62, 122, 57, 147, 209, 249, 205, 191, 32, 243, 160, 208, 254, 23, 243, 52, 236, 175, 228, 249], [254, 133, 255, 181, 55, 90, 55, 63, 53, 45, 100, 11, 153, 154, 88, 232, 189, 33, 191, 59, 232, 205, 143, 53, 111, 233, 41, 137, 27, 114, 119, 133], [80, 252, 255, 135, 38, 204, 47, 142, 17, 101, 244, 201, 161, 85, 126, 226, 128, 147, 39, 230, 176, 80, 253, 201, 80, 131, 99, 154, 206, 127, 64, 151], [61, 5, 34, 0, 137, 72, 133, 34, 134, 70, 6, 172, 4, 38, 82, 226, 233, 199, 131, 153, 106, 3, 242, 40, 224, 16, 166, 216, 41, 77, 99, 225], [126, 167, 237, 20, 182, 66, 56, 148, 142, 95, 54, 3, 180, 79, 229, 195, 236, 201, 148, 58, 66, 118, 206, 110, 224, 141, 18, 31, 65, 51, 195, 200], [205, 174, 161, 200, 97, 16, 236, 152, 176, 149, 213, 34, 241, 89, 199, 215, 194, 155, 1, 51, 245, 100, 40, 245, 174, 26, 14, 180, 149, 67, 133, 153], [146, 28, 151, 29, 251, 15, 205, 92, 52, 96, 185, 194, 55, 50, 87, 190, 160, 163, 250, 235, 171, 222, 80, 164, 159, 90, 189, 240, 169, 95, 85, 224], [102, 21, 160, 44, 180, 241, 158, 211, 128, 60, 110, 166, 221, 231, 4, 134, 126, 183, 230, 17, 133, 126, 119, 20, 52, 236, 12, 48, 193, 159, 255, 133], [138, 34, 221, 221, 215, 186, 107, 85, 229, 196, 168, 109, 55, 96, 9, 196, 106, 208, 123, 94, 70, 62, 64, 217, 136, 27, 95, 20, 95, 161, 74, 172], [182, 25, 220, 124, 223, 18, 109, 179, 222, 198, 110, 93, 157, 15, 43, 170, 251, 143, 255, 2, 19, 178, 9, 119, 21, 148, 21, 44, 145, 62, 126, 245], [230, 157, 84, 104, 74, 117, 144, 60, 24, 67, 205, 68, 131, 188, 255, 152, 201, 93, 133, 204, 255, 136, 21, 80, 194, 104, 76, 54, 216, 136, 242, 204], [100, 166, 11, 30, 175, 88, 196, 163, 8, 188, 20, 76, 142, 232, 140, 247, 173, 130, 194, 100, 212, 82, 122, 57, 95, 114, 181, 249, 192, 181, 92, 161], [120, 159, 3, 133, 47, 9, 13, 124, 4, 71, 197, 99, 101, 96, 152, 136, 175, 119, 10, 127, 176, 104, 46, 223, 52, 213, 200, 18, 30, 100, 210, 154], [254, 109, 27, 6, 17, 240, 227, 151, 133, 110, 216, 4, 221, 233, 108, 142, 121, 2, 83, 179, 247, 44, 254, 98, 119, 6, 80, 36, 119, 171, 47, 226], [142, 43, 196, 206, 114, 248, 187, 8, 126, 1, 207, 185, 81, 217, 211, 160, 84, 99, 108, 20, 15, 90, 45, 96, 185, 134, 196, 244, 148, 196, 205, 135], [236, 103, 153, 141, 220, 131, 238, 210, 253, 9, 5, 135, 34, 158, 93, 165, 109, 200, 138, 179, 132, 236, 254, 39, 184, 249, 208, 74, 158, 133, 196, 186], [177, 205, 222, 198, 36, 167, 230, 147, 180, 2, 114, 168, 73, 89, 116, 243, 232, 2, 221, 17, 131, 89, 19, 75, 43, 145, 117, 157, 188, 42, 125, 171], [221, 219, 163, 14, 17, 250, 217, 134, 228, 232, 210, 155, 134, 103, 121, 189, 205, 181, 124, 187, 11, 167, 86, 90, 127, 39, 198, 189, 11, 251, 135, 179], [51, 140, 106, 212, 26, 254, 155, 1, 93, 168, 29, 226, 137, 138, 88, 243, 100, 41, 0, 52, 128, 16, 247, 127, 167, 209, 210, 27, 168, 46, 211, 202], [211, 116, 54, 125, 93, 184, 107, 71, 154, 30, 12, 200, 169, 5, 73, 203, 236, 220, 249, 95, 189, 62, 147, 68, 76, 50, 247, 182, 71, 187, 16, 177], [233, 247, 86, 193, 212, 27, 100, 124, 168, 44, 229, 208, 167, 227, 181, 229, 204, 101, 58, 128, 152, 31, 128, 135, 237, 178, 202, 183, 221, 208, 26, 165], [101, 31, 153, 153, 216, 134, 213, 175, 125, 221, 209, 225, 10, 191, 55, 207, 171, 152, 80, 177, 91, 36, 114, 165, 152, 89, 162, 170, 100, 110, 55, 168], [143, 86, 159, 235, 122, 55, 166, 161, 154, 214, 75, 250, 52, 19, 81, 209, 154, 92, 10, 225, 9, 230, 71, 28, 222, 24, 251, 122, 130, 193, 32, 211], [137, 31, 142, 187, 48, 10, 208, 105, 245, 216, 169, 122, 215, 232, 94, 253, 243, 98, 117, 110, 103, 187, 107, 131, 80, 3, 42, 226, 243, 218, 206, 221], [160, 169, 11, 9, 247, 39, 43, 118, 132, 207, 69, 210, 80, 106, 211, 189, 132, 233, 213, 134, 109, 233, 229, 13, 218, 55, 81, 252, 13, 132, 18, 226], [176, 81, 252, 112, 130, 216, 109, 53, 59, 158, 72, 9, 163, 181, 50, 197, 213, 187, 242, 220, 164, 114, 61, 239, 208, 123, 151, 86, 151, 62, 78, 185], [200, 90, 168, 65, 117, 153, 249, 30, 42, 11, 177, 76, 112, 213, 182, 217, 181, 31, 145, 42, 84, 42, 37, 69, 68, 27, 211, 44, 52, 231, 31, 230], [63, 90, 243, 111, 135, 111, 248, 105, 109, 148, 176, 112, 175, 221, 144, 220, 219, 82, 100, 105, 196, 32, 81, 209, 127, 234, 251, 40, 142, 193, 93, 141], [30, 228, 55, 237, 141, 114, 177, 231, 60, 105, 46, 177, 46, 51, 220, 189, 243, 236, 226, 185, 123, 21, 236, 230, 205, 1, 27, 241, 122, 118, 11, 212], [244, 209, 8, 86, 206, 98, 168, 95, 224, 89, 117, 67, 87, 82, 37, 130, 29, 184, 176, 175, 231, 186, 234, 76, 30, 100, 228, 60, 230, 81, 221, 223], [2, 114, 225, 153, 137, 240, 140, 106, 26, 60, 201, 125, 7, 195, 135, 214, 89, 43, 89, 141, 172, 215, 45, 56, 31, 153, 173, 34, 44, 221, 22, 180], [175, 157, 171, 251, 73, 133, 136, 54, 211, 171, 20, 136, 180, 44, 57, 142, 97, 143, 65, 60, 153, 53, 193, 114, 95, 247, 32, 120, 35, 243, 250, 154], [50, 150, 189, 146, 22, 223, 5, 81, 185, 98, 70, 123, 30, 197, 217, 237, 71, 175, 216, 168, 184, 133, 79, 237, 117, 48, 138, 93, 111, 17, 8, 180], [101, 18, 203, 126, 71, 117, 116, 59, 169, 91, 231, 92, 59, 108, 196, 167, 30, 225, 201, 112, 242, 125, 123, 238, 8, 187, 221, 212, 102, 98, 69, 174], [78, 6, 17, 236, 53, 233, 115, 243, 18, 15, 138, 111, 38, 66, 17, 191, 76, 119, 118, 54, 31, 244, 126, 76, 109, 243, 184, 103, 123, 17, 160, 250], [69, 235, 181, 130, 27, 21, 255, 108, 152, 95, 72, 224, 98, 55, 167, 181, 112, 91, 97, 163, 86, 79, 226, 217, 158, 7, 171, 113, 15, 96, 140, 138], [155, 147, 203, 33, 132, 136, 150, 81, 55, 254, 45, 249, 122, 236, 61, 167, 116, 87, 247, 231, 28, 9, 64, 173, 250, 231, 248, 202, 194, 67, 82, 132], [77, 121, 46, 231, 122, 138, 156, 114, 216, 10, 246, 242, 234, 126, 60, 173, 163, 157, 187, 198, 161, 208, 4, 89, 34, 35, 176, 3, 210, 57, 153, 196], [119, 144, 155, 64, 118, 12, 185, 88, 66, 225, 244, 241, 83, 86, 84, 185, 53, 64, 18, 123, 5, 197, 106, 106, 122, 195, 76, 29, 254, 63, 224, 188], [211, 224, 222, 104, 103, 223, 201, 200, 97, 73, 192, 140, 84, 145, 247, 130, 86, 210, 110, 251, 85, 54, 253, 47, 233, 59, 67, 192, 55, 221, 76, 216], [55, 52, 65, 179, 195, 73, 65, 115, 241, 44, 93, 88, 5, 220, 19, 135, 194, 149, 152, 27, 255, 71, 30, 89, 208, 85, 232, 242, 223, 43, 250, 188], [167, 39, 159, 76, 198, 183, 9, 193, 140, 248, 165, 134, 174, 100, 231, 161, 30, 166, 14, 50, 127, 78, 144, 61, 105, 24, 119, 76, 190, 250, 182, 137], [193, 3, 106, 143, 130, 47, 156, 94, 102, 98, 90, 58, 72, 37, 49, 137, 163, 75, 217, 50, 62, 4, 224, 194, 129, 121, 216, 2, 189, 25, 116, 173], [125, 64, 201, 158, 137, 197, 235, 86, 125, 74, 180, 157, 198, 33, 42, 169, 167, 85, 97, 72, 186, 205, 12, 18, 101, 242, 133, 0, 43, 18, 215, 219], [108, 22, 50, 3, 98, 80, 126, 65, 75, 83, 216, 207, 58, 208, 180, 209, 97, 237, 149, 227, 248, 155, 57, 179, 13, 146, 191, 4, 247, 230, 164, 194], [145, 55, 224, 242, 16, 143, 114, 177, 205, 139, 198, 239, 231, 83, 218, 237, 53, 100, 144, 8, 136, 240, 180, 92, 224, 166, 218, 200, 27, 95, 34, 157], [201, 202, 15, 71, 33, 150, 202, 165, 27, 246, 51, 21, 107, 86, 122, 206, 217, 48, 113, 172, 169, 119, 64, 41, 145, 170, 77, 247, 198, 194, 201, 217], [245, 208, 231, 39, 193, 40, 46, 36, 60, 85, 244, 20, 168, 130, 110, 159, 189, 198, 133, 175, 18, 36, 143, 240, 131, 59, 209, 112, 225, 228, 153, 182], [182, 14, 121, 44, 120, 91, 177, 59, 161, 30, 90, 244, 207, 167, 23, 211, 230, 144, 242, 161, 111, 185, 37, 144, 199, 95, 170, 104, 164, 129, 93, 200], [201, 157, 239, 206, 79, 197, 17, 73, 235, 172, 172, 213, 106, 130, 22, 143, 169, 234, 131, 84, 16, 184, 88, 140, 14, 66, 106, 245, 167, 63, 198, 168], [218, 53, 241, 34, 18, 154, 121, 112, 181, 163, 205, 179, 149, 250, 63, 171, 33, 44, 53, 213, 214, 10, 3, 4, 104, 213, 89, 117, 53, 192, 107, 189], [113, 235, 222, 21, 71, 125, 202, 238, 117, 252, 60, 222, 255, 140, 54, 165, 46, 240, 157, 198, 87, 120, 242, 130, 123, 178, 81, 193, 6, 131, 183, 244]];
    let impl_as_bytes:Vec<_> = f2_a_as_f128p2.iter().map(|a: &Fp2<Fp>| a.as_bytes()).collect();

    assert_eq!(test_as_bytes, impl_as_bytes)
}
//Comparing the write_into resulting byte slice aganst as_bytes result.
#[test]
fn serialisable_test() {
    let f2_a: [[u128; 2]; 100] = [[174406971591187532577705298530619297067, 219144869279903914781847181350978435516], [273353028293521134949622872099189388256, 176532942523124545805654851786973969122], [198981816169985501641346527210182162568, 265323234677897595829007649035347126949], [266968125559646267477442838834337788083, 230565065491432223807777880676885238307], [283611569930382170543797387556786379993, 320311955773880910875442119115864551065], [294005113981518242532751606844460156755, 223429944981778806156762332038732289832], [210732426404757464420338703701598751623, 219022710963061799561873887279038158458], [248629953311415512231700469440262894065, 302505193887824181137338825539964029243], [301067984250527614521955973089951710131, 268078175398344758279965849683685025081], [300541728442683048701600656120512381730, 311553934101341713635061860623501863473], [328251708715830175291910815737759552519, 280093269267237269844875815268472625079], [293573563608851668446059642854917948514, 197429240569462326350853629791671038642], [209991387440891093216292930727030725008, 200978239514513835178304242704710858278], [269814779980830229126089063542909050830, 291218352457904147259134072204983403755], [283127497541056998028010894720264869718, 215812238400976691189362992062340258124], [318332808602522965056875924436433937079, 264193515551784286279257201334200385297], [246564613855769992364459547145478990710, 250305453623463730339974355958055213818], [267893748327116225790788212602782700875, 279869293174182091345632657039355898424], [277441184223231718499039856054824479977, 338198699315337348865518273383664698019], [307379648796213556060906100102431002866, 265660111283715789301628045894132992296], [204156632252328444272210650246072601792, 232632431804554730869914942427228663801], [266161027224865530911247179221639154823, 186523858258610815959533523080866228201], [290681593512253573022199871945928392173, 293660212004874245907361220393676981407], [226994754062744436272311197990129751829, 336404698877908911143539681987416561825], [263500661401797224165785434518081132927, 322397685902507165771646803295191815033], [214611557385190178563975370685743774858, 274744441423794217352948844231432798799], [226699703760093194810901962675950842193, 220823866681047959762489679855751824869], [189348118647373921500161996758990638689, 215022642271109592977849264343007365287], [171354918074974526091680703557935224852, 319323126225831315431579717400456404318], [230219402513511552661259494156641323727, 291390827135550181504917868859399016337], [261936105219404796587420984104306950114, 308269541770210745021729575776186183749], [302586702473153683517790117847281515155, 191791142178133864457733153771177363741], [207562456976658795859089815138473200076, 198914479761092970545173733879758068452], [234620263481478077667663107645333133424, 191936541206920876787267435815830559313], [200608582974468186940862776793324866372, 269108159932556131422336549680473644357], [227642739967391709125974048156019925208, 316950052928724349031108155199156902356], [177476305387885923625556941151867829108, 317633642578225990195361379469672337588], [285840390245801352027750853020225443155, 228618436252891052984935890691330403803], [275623215861777922285827585986629135501, 249119419129547744789036458175734558088], [207252424968247720425173048612470511188, 225661857869710104952495864677669872405], [184963389035847465016368421426649833334, 223377022770086530883770720720086154403], [231832770651334170648059077772857143196, 323614763802982786230424536580539219138], [323591133055692951129187463266588937484, 245378302213974027674326962356651522410], [205212211621986006608539427413824555398, 246707946108923410088449967869232095918], [179447058542990065180216122399111317042, 320583828712788265106840481377922099036], [250604600273304930320763015307891253469, 213781570026415919288112772624900720504], [261431978981259678351703972456106709589, 236945234287073600407013159743481009337], [240431756598800771820483111003824160836, 269301911302568014362550332678032017627], [195694955681705789199144659657748352464, 332165182770104088260872456083568720337], [308840952762164815563403493808449488382, 177407521141864774426534017916347556285], [301061493274618792902931005800466873424, 201048326597270662766230852422005658496], [300832066491507440246527377162476062013, 299591901501544687102392979148396283881], [260390111731085200071377235215593088894, 266859136606734281593642390533164026348], [286819110407827932732524931380550938317, 204063829619441272654425963296354048962], [253006067564119864218534975283077258386, 298190356581773744993127157634772411296], [178142023420163004656832803426678084966, 178114599347353441030551553179210135422], [260577369348379108805214349137287127690, 229014718243463412335613501418420031594], [226192344752234292386443876995211991478, 326316357382602195295072571351598338043], [203370514551421496915834667254781615590, 272421822517682029669952180841475300809], [329050953312042147915396811743193441892, 214487085037583246495663912794896630445], [181566191693489726745036506250149601144, 205793524314788121004230800609712437167], [189315886774540971768846357162454904318, 300653042731173892763532220662086304377], [213776461720607525871017077856134245262, 180514187440765578418127079069314736980], [219808710268616328585999447625827969004, 248256807501948668064828338181480564845], [323606520381566497629725356479691541937, 227947891191366650176576457388083446504], [251854458876219917904372933515284831197, 238637863136454667895874022906777089485], [323462134996048656473293650701159402547, 269600576095487885081154604143518689636], [270212435678530101376424604960680211667, 235360230496087202111315256085984173292], [305337634168873644454739545569990473705, 219461855330335304523081184720220480972], [275439646257100762489959591393973837669, 223598118659766656036439094328871131307], [278229616727698593928971599975282595471, 280637185452865724306509968410692705434], [336787481429331481616072165270836092809, 294833441109056072189961741454959534835], [252321822179247184744034404064517925280, 300501666776966818098422265640272652676], [262121214045757074094426801874969317808, 246313447874821962448347652434970196949], [289391802164114755791445354722334628552, 305888089603500677245307495306176307125], [293182346132637147205582082915261700671, 187907956781653407011971327945815118555], [252367434614446978246508341287429071902, 281855853436633642681542617301931715827], [172993424507119854686228227508956353012, 297567001782272919101302096920545638429], [285159706837272952353542128861664342530, 239379755681466538575995625528935131993], [189047243051601303641202590787335593391, 206004117001208181679503727830004502369], [316157761469015661506396796541579662898, 239302931240391603430904372730550333255], [223000960683804875337158054021708845669, 231645935573106877245845718221590225182], [253972157925737779384962355241749120590, 333138121021722339893097562205708515148], [241458504178745352744900612061985631045, 184162333313436223014862643216955562864], [222302601796071233403679567140470100891, 175885238140532604596045611689355728756], [230270555280495443463209747554449127757, 261324281329602267747183299438025874851], [246345083094371693758864388035639480439, 251059235628702160939829829274004766773], [174085084424215708261067864608968990931, 287512348480364223587477174394091917910], [179548895624876743709369083813246874679, 251193827308867337127235425638156899778], [215207169964025281188379043359686076327, 183054319130203442041140461823526348318], [182359414140244115854161477891097494465, 230559271741623964301684653941895809955], [224858292811209448567312375324531572861, 292217643391827349760621342656498324903], [278747487954339590139509297069625054828, 258726452392107906570966935838957890913], [316160657532095243047824354804693481361, 208867262461656046823627195745200792629], [274456180119635224494017551427963964105, 289490077305068221215896895405195079897], [211921054014305312551383131318737424629, 242718558902851983435760850743228483261], [280589933576620290865233287231267475126, 266331112221476847671910032147592941798], [190196479105693496182452311740744965577, 224339669168716217943333725501099600553], [227630184444351855593884546610815383002, 251783565425267189241657984486758231073], [219605863144177352033679176569502755697, 325284478827487772645489157765674692654]];
    let f2_a_as_f128p2:Vec<Fp2<Fp>> = f2_a.iter().map(|a| Fp2::from(*a)).collect();

    //Elements of f2_a as concatenated byte slices of their entries using the .to_le_bytes() method.
    let test_as_bytes:Vec<[u8; 32]> = vec![[43, 13, 15, 186, 210, 71, 89, 120, 189, 255, 204, 199, 151, 143, 53, 131, 188, 185, 187, 191, 140, 26, 110, 40, 216, 24, 100, 70, 63, 196, 221, 164], [224, 115, 35, 3, 57, 36, 202, 78, 238, 234, 51, 131, 213, 224, 165, 205, 226, 250, 48, 211, 174, 52, 67, 158, 180, 150, 34, 113, 13, 2, 207, 132], [136, 56, 110, 213, 159, 13, 166, 69, 238, 141, 162, 5, 250, 128, 178, 149, 165, 106, 113, 120, 106, 222, 167, 162, 57, 12, 198, 88, 113, 101, 155, 199], [179, 176, 167, 9, 37, 198, 30, 110, 196, 205, 49, 27, 211, 48, 216, 200, 35, 146, 254, 48, 201, 233, 24, 83, 135, 217, 35, 106, 100, 55, 117, 173], [217, 156, 237, 71, 71, 101, 163, 136, 73, 94, 59, 149, 252, 153, 93, 213, 153, 46, 16, 137, 45, 133, 46, 183, 33, 31, 137, 40, 182, 214, 249, 240], [83, 199, 220, 187, 6, 187, 186, 134, 43, 251, 90, 174, 69, 83, 47, 221, 40, 151, 57, 128, 118, 109, 5, 223, 143, 16, 205, 109, 202, 10, 23, 168], [135, 75, 247, 176, 236, 20, 245, 81, 89, 26, 1, 115, 202, 150, 137, 158, 122, 86, 81, 229, 18, 95, 58, 206, 120, 48, 106, 140, 96, 61, 198, 164], [241, 241, 30, 5, 104, 108, 3, 203, 223, 90, 127, 140, 32, 99, 12, 187, 59, 201, 6, 218, 45, 236, 102, 77, 60, 207, 186, 89, 145, 97, 148, 227], [179, 123, 171, 118, 38, 87, 155, 25, 135, 184, 72, 108, 169, 149, 127, 226, 57, 37, 52, 234, 198, 171, 132, 108, 155, 207, 244, 213, 129, 250, 173, 201], [34, 3, 34, 93, 199, 88, 245, 166, 177, 67, 180, 75, 63, 59, 26, 226, 49, 170, 21, 135, 224, 107, 215, 204, 219, 116, 133, 175, 231, 26, 99, 234], [7, 84, 10, 229, 67, 246, 157, 85, 240, 106, 34, 63, 193, 250, 242, 246, 183, 151, 252, 190, 90, 249, 168, 128, 36, 114, 37, 12, 95, 0, 184, 210], [98, 68, 126, 201, 156, 121, 180, 185, 49, 40, 241, 50, 50, 54, 220, 220, 178, 50, 182, 102, 68, 166, 94, 12, 212, 232, 110, 236, 22, 125, 135, 148], [144, 153, 246, 175, 11, 148, 14, 83, 1, 117, 136, 195, 191, 222, 250, 157, 38, 118, 51, 124, 79, 9, 64, 98, 98, 170, 20, 64, 63, 0, 51, 151], [206, 31, 224, 107, 67, 178, 251, 40, 161, 137, 51, 62, 185, 111, 252, 202, 235, 4, 86, 168, 253, 253, 224, 112, 68, 170, 204, 48, 82, 157, 22, 219], [86, 151, 0, 174, 214, 218, 88, 43, 74, 93, 25, 13, 96, 95, 0, 213, 76, 217, 199, 210, 37, 190, 10, 72, 244, 240, 95, 226, 219, 236, 91, 162], [183, 162, 186, 252, 196, 232, 71, 14, 249, 169, 72, 228, 56, 171, 124, 239, 17, 63, 129, 125, 55, 232, 220, 202, 236, 196, 166, 78, 253, 209, 193, 198], [118, 235, 1, 19, 113, 200, 156, 131, 159, 142, 44, 181, 7, 158, 126, 185, 250, 154, 86, 97, 196, 147, 189, 105, 101, 48, 116, 162, 171, 19, 79, 188], [75, 85, 145, 41, 253, 29, 175, 185, 241, 161, 30, 239, 140, 117, 138, 201, 56, 106, 25, 206, 127, 46, 164, 243, 82, 212, 170, 79, 127, 221, 140, 210], [233, 44, 162, 241, 102, 170, 101, 161, 230, 53, 250, 181, 123, 58, 185, 208, 163, 194, 67, 229, 35, 112, 22, 75, 52, 248, 41, 98, 65, 179, 110, 254], [242, 80, 72, 36, 33, 89, 142, 144, 239, 113, 50, 239, 191, 42, 63, 231, 40, 137, 36, 157, 107, 77, 16, 239, 159, 134, 233, 228, 189, 70, 220, 199], [192, 140, 193, 0, 233, 68, 110, 100, 164, 63, 108, 155, 27, 35, 151, 153, 249, 239, 153, 17, 119, 235, 175, 218, 255, 4, 48, 203, 107, 96, 3, 175], [135, 204, 196, 154, 255, 88, 87, 250, 114, 88, 71, 240, 205, 191, 60, 200, 233, 231, 124, 19, 30, 150, 5, 240, 253, 205, 63, 189, 58, 48, 83, 140], [237, 189, 88, 221, 205, 55, 193, 255, 22, 27, 156, 211, 15, 61, 175, 218, 159, 68, 42, 43, 57, 90, 88, 250, 150, 217, 131, 182, 74, 230, 236, 220], [21, 215, 63, 243, 13, 243, 252, 15, 108, 207, 200, 185, 114, 153, 197, 170, 161, 24, 224, 143, 94, 20, 176, 78, 204, 131, 89, 112, 52, 48, 21, 253], [127, 89, 2, 249, 122, 161, 225, 237, 90, 144, 226, 121, 164, 97, 60, 198, 121, 211, 193, 179, 107, 181, 201, 186, 9, 126, 178, 121, 37, 137, 139, 242], [138, 60, 66, 34, 8, 178, 31, 152, 186, 220, 88, 224, 182, 174, 116, 161, 79, 2, 219, 242, 237, 166, 84, 67, 29, 136, 153, 65, 204, 218, 177, 206], [81, 241, 93, 185, 128, 172, 72, 1, 213, 204, 39, 88, 88, 198, 140, 170, 229, 133, 200, 111, 49, 111, 239, 242, 164, 94, 165, 212, 53, 33, 33, 166], [97, 206, 86, 244, 125, 21, 141, 11, 84, 31, 242, 114, 4, 31, 115, 142, 167, 8, 0, 233, 7, 95, 230, 143, 149, 249, 154, 153, 195, 218, 195, 161], [20, 216, 94, 147, 238, 97, 251, 97, 99, 77, 79, 150, 188, 193, 233, 128, 94, 29, 141, 67, 150, 21, 210, 3, 122, 236, 166, 153, 166, 101, 59, 240], [207, 74, 25, 137, 62, 197, 67, 221, 120, 134, 142, 66, 228, 164, 50, 173, 145, 15, 223, 68, 68, 118, 63, 77, 54, 204, 13, 173, 250, 212, 55, 219], [226, 63, 25, 209, 17, 156, 239, 229, 179, 145, 213, 44, 17, 15, 15, 197, 69, 176, 34, 77, 202, 77, 130, 117, 74, 19, 220, 93, 220, 141, 234, 231], [147, 58, 189, 84, 102, 132, 36, 28, 126, 255, 63, 85, 64, 20, 164, 227, 29, 201, 71, 19, 145, 228, 30, 34, 170, 151, 33, 131, 96, 161, 73, 144], [204, 201, 145, 217, 211, 174, 237, 114, 80, 19, 68, 53, 59, 19, 39, 156, 228, 26, 146, 54, 21, 178, 182, 144, 155, 181, 239, 13, 9, 137, 165, 149], [112, 88, 153, 61, 31, 2, 197, 75, 38, 201, 89, 238, 22, 56, 130, 176, 81, 26, 184, 14, 93, 99, 25, 114, 164, 63, 130, 67, 26, 162, 101, 144], [68, 75, 4, 6, 77, 57, 24, 3, 52, 121, 247, 195, 197, 206, 235, 150, 69, 29, 159, 160, 233, 4, 45, 190, 99, 235, 29, 89, 170, 88, 116, 202], [216, 32, 165, 105, 217, 136, 186, 165, 79, 171, 196, 174, 158, 101, 66, 171, 212, 217, 151, 187, 91, 52, 245, 58, 15, 192, 120, 156, 26, 92, 114, 238], [116, 251, 228, 192, 90, 62, 184, 1, 40, 175, 239, 198, 110, 177, 132, 133, 180, 80, 220, 199, 30, 109, 155, 234, 96, 109, 170, 1, 173, 3, 246, 238], [83, 21, 157, 9, 41, 244, 204, 150, 111, 112, 238, 247, 79, 219, 10, 215, 219, 237, 55, 105, 185, 160, 248, 28, 239, 186, 165, 41, 41, 79, 254, 171], [141, 236, 178, 201, 14, 243, 234, 2, 219, 213, 204, 8, 185, 25, 91, 207, 136, 45, 5, 25, 83, 146, 246, 34, 115, 190, 1, 185, 167, 167, 106, 187], [84, 214, 49, 113, 228, 190, 192, 254, 127, 142, 127, 29, 121, 93, 235, 155, 21, 35, 13, 76, 163, 171, 238, 24, 205, 18, 57, 145, 151, 228, 196, 169], [118, 31, 251, 100, 150, 210, 151, 222, 222, 68, 252, 30, 40, 167, 38, 139, 163, 188, 240, 0, 140, 185, 151, 30, 149, 201, 47, 53, 134, 217, 12, 168], [156, 111, 165, 242, 127, 58, 235, 177, 14, 45, 244, 13, 21, 94, 105, 174, 194, 252, 74, 94, 98, 235, 34, 80, 62, 171, 154, 67, 184, 239, 117, 243], [12, 205, 59, 175, 212, 146, 98, 43, 152, 96, 8, 77, 162, 98, 113, 243, 106, 121, 75, 57, 152, 167, 138, 130, 172, 251, 160, 178, 89, 36, 154, 184], [134, 201, 94, 94, 216, 166, 62, 173, 10, 238, 67, 92, 48, 111, 98, 154, 174, 34, 139, 143, 32, 32, 209, 3, 89, 155, 78, 21, 219, 56, 154, 185], [50, 6, 249, 209, 92, 125, 93, 192, 59, 138, 221, 169, 16, 63, 0, 135, 92, 167, 104, 202, 216, 163, 252, 205, 71, 25, 215, 20, 21, 51, 46, 241], [221, 32, 75, 215, 37, 73, 42, 95, 216, 4, 183, 47, 189, 176, 136, 188, 120, 135, 120, 103, 85, 14, 240, 56, 109, 179, 22, 156, 45, 213, 212, 160], [85, 82, 194, 154, 115, 213, 140, 149, 1, 163, 108, 124, 185, 247, 173, 196, 185, 84, 129, 243, 235, 222, 49, 108, 75, 50, 190, 30, 0, 254, 65, 178], [68, 128, 53, 178, 191, 222, 235, 101, 233, 121, 116, 120, 210, 120, 225, 180, 219, 72, 139, 46, 199, 209, 35, 175, 78, 86, 63, 114, 88, 169, 153, 202], [208, 141, 71, 196, 69, 131, 102, 141, 140, 255, 26, 46, 62, 122, 57, 147, 209, 249, 205, 191, 32, 243, 160, 208, 254, 23, 243, 52, 236, 175, 228, 249], [254, 133, 255, 181, 55, 90, 55, 63, 53, 45, 100, 11, 153, 154, 88, 232, 189, 33, 191, 59, 232, 205, 143, 53, 111, 233, 41, 137, 27, 114, 119, 133], [80, 252, 255, 135, 38, 204, 47, 142, 17, 101, 244, 201, 161, 85, 126, 226, 128, 147, 39, 230, 176, 80, 253, 201, 80, 131, 99, 154, 206, 127, 64, 151], [61, 5, 34, 0, 137, 72, 133, 34, 134, 70, 6, 172, 4, 38, 82, 226, 233, 199, 131, 153, 106, 3, 242, 40, 224, 16, 166, 216, 41, 77, 99, 225], [126, 167, 237, 20, 182, 66, 56, 148, 142, 95, 54, 3, 180, 79, 229, 195, 236, 201, 148, 58, 66, 118, 206, 110, 224, 141, 18, 31, 65, 51, 195, 200], [205, 174, 161, 200, 97, 16, 236, 152, 176, 149, 213, 34, 241, 89, 199, 215, 194, 155, 1, 51, 245, 100, 40, 245, 174, 26, 14, 180, 149, 67, 133, 153], [146, 28, 151, 29, 251, 15, 205, 92, 52, 96, 185, 194, 55, 50, 87, 190, 160, 163, 250, 235, 171, 222, 80, 164, 159, 90, 189, 240, 169, 95, 85, 224], [102, 21, 160, 44, 180, 241, 158, 211, 128, 60, 110, 166, 221, 231, 4, 134, 126, 183, 230, 17, 133, 126, 119, 20, 52, 236, 12, 48, 193, 159, 255, 133], [138, 34, 221, 221, 215, 186, 107, 85, 229, 196, 168, 109, 55, 96, 9, 196, 106, 208, 123, 94, 70, 62, 64, 217, 136, 27, 95, 20, 95, 161, 74, 172], [182, 25, 220, 124, 223, 18, 109, 179, 222, 198, 110, 93, 157, 15, 43, 170, 251, 143, 255, 2, 19, 178, 9, 119, 21, 148, 21, 44, 145, 62, 126, 245], [230, 157, 84, 104, 74, 117, 144, 60, 24, 67, 205, 68, 131, 188, 255, 152, 201, 93, 133, 204, 255, 136, 21, 80, 194, 104, 76, 54, 216, 136, 242, 204], [100, 166, 11, 30, 175, 88, 196, 163, 8, 188, 20, 76, 142, 232, 140, 247, 173, 130, 194, 100, 212, 82, 122, 57, 95, 114, 181, 249, 192, 181, 92, 161], [120, 159, 3, 133, 47, 9, 13, 124, 4, 71, 197, 99, 101, 96, 152, 136, 175, 119, 10, 127, 176, 104, 46, 223, 52, 213, 200, 18, 30, 100, 210, 154], [254, 109, 27, 6, 17, 240, 227, 151, 133, 110, 216, 4, 221, 233, 108, 142, 121, 2, 83, 179, 247, 44, 254, 98, 119, 6, 80, 36, 119, 171, 47, 226], [142, 43, 196, 206, 114, 248, 187, 8, 126, 1, 207, 185, 81, 217, 211, 160, 84, 99, 108, 20, 15, 90, 45, 96, 185, 134, 196, 244, 148, 196, 205, 135], [236, 103, 153, 141, 220, 131, 238, 210, 253, 9, 5, 135, 34, 158, 93, 165, 109, 200, 138, 179, 132, 236, 254, 39, 184, 249, 208, 74, 158, 133, 196, 186], [177, 205, 222, 198, 36, 167, 230, 147, 180, 2, 114, 168, 73, 89, 116, 243, 232, 2, 221, 17, 131, 89, 19, 75, 43, 145, 117, 157, 188, 42, 125, 171], [221, 219, 163, 14, 17, 250, 217, 134, 228, 232, 210, 155, 134, 103, 121, 189, 205, 181, 124, 187, 11, 167, 86, 90, 127, 39, 198, 189, 11, 251, 135, 179], [51, 140, 106, 212, 26, 254, 155, 1, 93, 168, 29, 226, 137, 138, 88, 243, 100, 41, 0, 52, 128, 16, 247, 127, 167, 209, 210, 27, 168, 46, 211, 202], [211, 116, 54, 125, 93, 184, 107, 71, 154, 30, 12, 200, 169, 5, 73, 203, 236, 220, 249, 95, 189, 62, 147, 68, 76, 50, 247, 182, 71, 187, 16, 177], [233, 247, 86, 193, 212, 27, 100, 124, 168, 44, 229, 208, 167, 227, 181, 229, 204, 101, 58, 128, 152, 31, 128, 135, 237, 178, 202, 183, 221, 208, 26, 165], [101, 31, 153, 153, 216, 134, 213, 175, 125, 221, 209, 225, 10, 191, 55, 207, 171, 152, 80, 177, 91, 36, 114, 165, 152, 89, 162, 170, 100, 110, 55, 168], [143, 86, 159, 235, 122, 55, 166, 161, 154, 214, 75, 250, 52, 19, 81, 209, 154, 92, 10, 225, 9, 230, 71, 28, 222, 24, 251, 122, 130, 193, 32, 211], [137, 31, 142, 187, 48, 10, 208, 105, 245, 216, 169, 122, 215, 232, 94, 253, 243, 98, 117, 110, 103, 187, 107, 131, 80, 3, 42, 226, 243, 218, 206, 221], [160, 169, 11, 9, 247, 39, 43, 118, 132, 207, 69, 210, 80, 106, 211, 189, 132, 233, 213, 134, 109, 233, 229, 13, 218, 55, 81, 252, 13, 132, 18, 226], [176, 81, 252, 112, 130, 216, 109, 53, 59, 158, 72, 9, 163, 181, 50, 197, 213, 187, 242, 220, 164, 114, 61, 239, 208, 123, 151, 86, 151, 62, 78, 185], [200, 90, 168, 65, 117, 153, 249, 30, 42, 11, 177, 76, 112, 213, 182, 217, 181, 31, 145, 42, 84, 42, 37, 69, 68, 27, 211, 44, 52, 231, 31, 230], [63, 90, 243, 111, 135, 111, 248, 105, 109, 148, 176, 112, 175, 221, 144, 220, 219, 82, 100, 105, 196, 32, 81, 209, 127, 234, 251, 40, 142, 193, 93, 141], [30, 228, 55, 237, 141, 114, 177, 231, 60, 105, 46, 177, 46, 51, 220, 189, 243, 236, 226, 185, 123, 21, 236, 230, 205, 1, 27, 241, 122, 118, 11, 212], [244, 209, 8, 86, 206, 98, 168, 95, 224, 89, 117, 67, 87, 82, 37, 130, 29, 184, 176, 175, 231, 186, 234, 76, 30, 100, 228, 60, 230, 81, 221, 223], [2, 114, 225, 153, 137, 240, 140, 106, 26, 60, 201, 125, 7, 195, 135, 214, 89, 43, 89, 141, 172, 215, 45, 56, 31, 153, 173, 34, 44, 221, 22, 180], [175, 157, 171, 251, 73, 133, 136, 54, 211, 171, 20, 136, 180, 44, 57, 142, 97, 143, 65, 60, 153, 53, 193, 114, 95, 247, 32, 120, 35, 243, 250, 154], [50, 150, 189, 146, 22, 223, 5, 81, 185, 98, 70, 123, 30, 197, 217, 237, 71, 175, 216, 168, 184, 133, 79, 237, 117, 48, 138, 93, 111, 17, 8, 180], [101, 18, 203, 126, 71, 117, 116, 59, 169, 91, 231, 92, 59, 108, 196, 167, 30, 225, 201, 112, 242, 125, 123, 238, 8, 187, 221, 212, 102, 98, 69, 174], [78, 6, 17, 236, 53, 233, 115, 243, 18, 15, 138, 111, 38, 66, 17, 191, 76, 119, 118, 54, 31, 244, 126, 76, 109, 243, 184, 103, 123, 17, 160, 250], [69, 235, 181, 130, 27, 21, 255, 108, 152, 95, 72, 224, 98, 55, 167, 181, 112, 91, 97, 163, 86, 79, 226, 217, 158, 7, 171, 113, 15, 96, 140, 138], [155, 147, 203, 33, 132, 136, 150, 81, 55, 254, 45, 249, 122, 236, 61, 167, 116, 87, 247, 231, 28, 9, 64, 173, 250, 231, 248, 202, 194, 67, 82, 132], [77, 121, 46, 231, 122, 138, 156, 114, 216, 10, 246, 242, 234, 126, 60, 173, 163, 157, 187, 198, 161, 208, 4, 89, 34, 35, 176, 3, 210, 57, 153, 196], [119, 144, 155, 64, 118, 12, 185, 88, 66, 225, 244, 241, 83, 86, 84, 185, 53, 64, 18, 123, 5, 197, 106, 106, 122, 195, 76, 29, 254, 63, 224, 188], [211, 224, 222, 104, 103, 223, 201, 200, 97, 73, 192, 140, 84, 145, 247, 130, 86, 210, 110, 251, 85, 54, 253, 47, 233, 59, 67, 192, 55, 221, 76, 216], [55, 52, 65, 179, 195, 73, 65, 115, 241, 44, 93, 88, 5, 220, 19, 135, 194, 149, 152, 27, 255, 71, 30, 89, 208, 85, 232, 242, 223, 43, 250, 188], [167, 39, 159, 76, 198, 183, 9, 193, 140, 248, 165, 134, 174, 100, 231, 161, 30, 166, 14, 50, 127, 78, 144, 61, 105, 24, 119, 76, 190, 250, 182, 137], [193, 3, 106, 143, 130, 47, 156, 94, 102, 98, 90, 58, 72, 37, 49, 137, 163, 75, 217, 50, 62, 4, 224, 194, 129, 121, 216, 2, 189, 25, 116, 173], [125, 64, 201, 158, 137, 197, 235, 86, 125, 74, 180, 157, 198, 33, 42, 169, 167, 85, 97, 72, 186, 205, 12, 18, 101, 242, 133, 0, 43, 18, 215, 219], [108, 22, 50, 3, 98, 80, 126, 65, 75, 83, 216, 207, 58, 208, 180, 209, 97, 237, 149, 227, 248, 155, 57, 179, 13, 146, 191, 4, 247, 230, 164, 194], [145, 55, 224, 242, 16, 143, 114, 177, 205, 139, 198, 239, 231, 83, 218, 237, 53, 100, 144, 8, 136, 240, 180, 92, 224, 166, 218, 200, 27, 95, 34, 157], [201, 202, 15, 71, 33, 150, 202, 165, 27, 246, 51, 21, 107, 86, 122, 206, 217, 48, 113, 172, 169, 119, 64, 41, 145, 170, 77, 247, 198, 194, 201, 217], [245, 208, 231, 39, 193, 40, 46, 36, 60, 85, 244, 20, 168, 130, 110, 159, 189, 198, 133, 175, 18, 36, 143, 240, 131, 59, 209, 112, 225, 228, 153, 182], [182, 14, 121, 44, 120, 91, 177, 59, 161, 30, 90, 244, 207, 167, 23, 211, 230, 144, 242, 161, 111, 185, 37, 144, 199, 95, 170, 104, 164, 129, 93, 200], [201, 157, 239, 206, 79, 197, 17, 73, 235, 172, 172, 213, 106, 130, 22, 143, 169, 234, 131, 84, 16, 184, 88, 140, 14, 66, 106, 245, 167, 63, 198, 168], [218, 53, 241, 34, 18, 154, 121, 112, 181, 163, 205, 179, 149, 250, 63, 171, 33, 44, 53, 213, 214, 10, 3, 4, 104, 213, 89, 117, 53, 192, 107, 189], [113, 235, 222, 21, 71, 125, 202, 238, 117, 252, 60, 222, 255, 140, 54, 165, 46, 240, 157, 198, 87, 120, 242, 130, 123, 178, 81, 193, 6, 131, 183, 244]];
    
    //Checking if byte-slice conversion is equivalent to actual representation.
    for i in 1..100{
        let mut bytes= Vec::new();
        f2_a_as_f128p2[i].write_into(&mut bytes);
        assert_eq!(bytes,test_as_bytes[i]);
    }
}

#[test]

fn deserialisable_test() {
    let f2_a: [[u128; 2]; 100] = [[174406971591187532577705298530619297067, 219144869279903914781847181350978435516], [273353028293521134949622872099189388256, 176532942523124545805654851786973969122], [198981816169985501641346527210182162568, 265323234677897595829007649035347126949], [266968125559646267477442838834337788083, 230565065491432223807777880676885238307], [283611569930382170543797387556786379993, 320311955773880910875442119115864551065], [294005113981518242532751606844460156755, 223429944981778806156762332038732289832], [210732426404757464420338703701598751623, 219022710963061799561873887279038158458], [248629953311415512231700469440262894065, 302505193887824181137338825539964029243], [301067984250527614521955973089951710131, 268078175398344758279965849683685025081], [300541728442683048701600656120512381730, 311553934101341713635061860623501863473], [328251708715830175291910815737759552519, 280093269267237269844875815268472625079], [293573563608851668446059642854917948514, 197429240569462326350853629791671038642], [209991387440891093216292930727030725008, 200978239514513835178304242704710858278], [269814779980830229126089063542909050830, 291218352457904147259134072204983403755], [283127497541056998028010894720264869718, 215812238400976691189362992062340258124], [318332808602522965056875924436433937079, 264193515551784286279257201334200385297], [246564613855769992364459547145478990710, 250305453623463730339974355958055213818], [267893748327116225790788212602782700875, 279869293174182091345632657039355898424], [277441184223231718499039856054824479977, 338198699315337348865518273383664698019], [307379648796213556060906100102431002866, 265660111283715789301628045894132992296], [204156632252328444272210650246072601792, 232632431804554730869914942427228663801], [266161027224865530911247179221639154823, 186523858258610815959533523080866228201], [290681593512253573022199871945928392173, 293660212004874245907361220393676981407], [226994754062744436272311197990129751829, 336404698877908911143539681987416561825], [263500661401797224165785434518081132927, 322397685902507165771646803295191815033], [214611557385190178563975370685743774858, 274744441423794217352948844231432798799], [226699703760093194810901962675950842193, 220823866681047959762489679855751824869], [189348118647373921500161996758990638689, 215022642271109592977849264343007365287], [171354918074974526091680703557935224852, 319323126225831315431579717400456404318], [230219402513511552661259494156641323727, 291390827135550181504917868859399016337], [261936105219404796587420984104306950114, 308269541770210745021729575776186183749], [302586702473153683517790117847281515155, 191791142178133864457733153771177363741], [207562456976658795859089815138473200076, 198914479761092970545173733879758068452], [234620263481478077667663107645333133424, 191936541206920876787267435815830559313], [200608582974468186940862776793324866372, 269108159932556131422336549680473644357], [227642739967391709125974048156019925208, 316950052928724349031108155199156902356], [177476305387885923625556941151867829108, 317633642578225990195361379469672337588], [285840390245801352027750853020225443155, 228618436252891052984935890691330403803], [275623215861777922285827585986629135501, 249119419129547744789036458175734558088], [207252424968247720425173048612470511188, 225661857869710104952495864677669872405], [184963389035847465016368421426649833334, 223377022770086530883770720720086154403], [231832770651334170648059077772857143196, 323614763802982786230424536580539219138], [323591133055692951129187463266588937484, 245378302213974027674326962356651522410], [205212211621986006608539427413824555398, 246707946108923410088449967869232095918], [179447058542990065180216122399111317042, 320583828712788265106840481377922099036], [250604600273304930320763015307891253469, 213781570026415919288112772624900720504], [261431978981259678351703972456106709589, 236945234287073600407013159743481009337], [240431756598800771820483111003824160836, 269301911302568014362550332678032017627], [195694955681705789199144659657748352464, 332165182770104088260872456083568720337], [308840952762164815563403493808449488382, 177407521141864774426534017916347556285], [301061493274618792902931005800466873424, 201048326597270662766230852422005658496], [300832066491507440246527377162476062013, 299591901501544687102392979148396283881], [260390111731085200071377235215593088894, 266859136606734281593642390533164026348], [286819110407827932732524931380550938317, 204063829619441272654425963296354048962], [253006067564119864218534975283077258386, 298190356581773744993127157634772411296], [178142023420163004656832803426678084966, 178114599347353441030551553179210135422], [260577369348379108805214349137287127690, 229014718243463412335613501418420031594], [226192344752234292386443876995211991478, 326316357382602195295072571351598338043], [203370514551421496915834667254781615590, 272421822517682029669952180841475300809], [329050953312042147915396811743193441892, 214487085037583246495663912794896630445], [181566191693489726745036506250149601144, 205793524314788121004230800609712437167], [189315886774540971768846357162454904318, 300653042731173892763532220662086304377], [213776461720607525871017077856134245262, 180514187440765578418127079069314736980], [219808710268616328585999447625827969004, 248256807501948668064828338181480564845], [323606520381566497629725356479691541937, 227947891191366650176576457388083446504], [251854458876219917904372933515284831197, 238637863136454667895874022906777089485], [323462134996048656473293650701159402547, 269600576095487885081154604143518689636], [270212435678530101376424604960680211667, 235360230496087202111315256085984173292], [305337634168873644454739545569990473705, 219461855330335304523081184720220480972], [275439646257100762489959591393973837669, 223598118659766656036439094328871131307], [278229616727698593928971599975282595471, 280637185452865724306509968410692705434], [336787481429331481616072165270836092809, 294833441109056072189961741454959534835], [252321822179247184744034404064517925280, 300501666776966818098422265640272652676], [262121214045757074094426801874969317808, 246313447874821962448347652434970196949], [289391802164114755791445354722334628552, 305888089603500677245307495306176307125], [293182346132637147205582082915261700671, 187907956781653407011971327945815118555], [252367434614446978246508341287429071902, 281855853436633642681542617301931715827], [172993424507119854686228227508956353012, 297567001782272919101302096920545638429], [285159706837272952353542128861664342530, 239379755681466538575995625528935131993], [189047243051601303641202590787335593391, 206004117001208181679503727830004502369], [316157761469015661506396796541579662898, 239302931240391603430904372730550333255], [223000960683804875337158054021708845669, 231645935573106877245845718221590225182], [253972157925737779384962355241749120590, 333138121021722339893097562205708515148], [241458504178745352744900612061985631045, 184162333313436223014862643216955562864], [222302601796071233403679567140470100891, 175885238140532604596045611689355728756], [230270555280495443463209747554449127757, 261324281329602267747183299438025874851], [246345083094371693758864388035639480439, 251059235628702160939829829274004766773], [174085084424215708261067864608968990931, 287512348480364223587477174394091917910], [179548895624876743709369083813246874679, 251193827308867337127235425638156899778], [215207169964025281188379043359686076327, 183054319130203442041140461823526348318], [182359414140244115854161477891097494465, 230559271741623964301684653941895809955], [224858292811209448567312375324531572861, 292217643391827349760621342656498324903], [278747487954339590139509297069625054828, 258726452392107906570966935838957890913], [316160657532095243047824354804693481361, 208867262461656046823627195745200792629], [274456180119635224494017551427963964105, 289490077305068221215896895405195079897], [211921054014305312551383131318737424629, 242718558902851983435760850743228483261], [280589933576620290865233287231267475126, 266331112221476847671910032147592941798], [190196479105693496182452311740744965577, 224339669168716217943333725501099600553], [227630184444351855593884546610815383002, 251783565425267189241657984486758231073], [219605863144177352033679176569502755697, 325284478827487772645489157765674692654]];
    let f2_a_as_f128p2:Vec<Fp2<Fp>> = f2_a.iter().map(|a| Fp2::from(*a)).collect();

    //Elements of f2_a as concatenated byte slices of their entries using the .to_le_bytes() method.
    let test_as_bytes:[[u8;32];100] = [[43, 13, 15, 186, 210, 71, 89, 120, 189, 255, 204, 199, 151, 143, 53, 131, 188, 185, 187, 191, 140, 26, 110, 40, 216, 24, 100, 70, 63, 196, 221, 164], [224, 115, 35, 3, 57, 36, 202, 78, 238, 234, 51, 131, 213, 224, 165, 205, 226, 250, 48, 211, 174, 52, 67, 158, 180, 150, 34, 113, 13, 2, 207, 132], [136, 56, 110, 213, 159, 13, 166, 69, 238, 141, 162, 5, 250, 128, 178, 149, 165, 106, 113, 120, 106, 222, 167, 162, 57, 12, 198, 88, 113, 101, 155, 199], [179, 176, 167, 9, 37, 198, 30, 110, 196, 205, 49, 27, 211, 48, 216, 200, 35, 146, 254, 48, 201, 233, 24, 83, 135, 217, 35, 106, 100, 55, 117, 173], [217, 156, 237, 71, 71, 101, 163, 136, 73, 94, 59, 149, 252, 153, 93, 213, 153, 46, 16, 137, 45, 133, 46, 183, 33, 31, 137, 40, 182, 214, 249, 240], [83, 199, 220, 187, 6, 187, 186, 134, 43, 251, 90, 174, 69, 83, 47, 221, 40, 151, 57, 128, 118, 109, 5, 223, 143, 16, 205, 109, 202, 10, 23, 168], [135, 75, 247, 176, 236, 20, 245, 81, 89, 26, 1, 115, 202, 150, 137, 158, 122, 86, 81, 229, 18, 95, 58, 206, 120, 48, 106, 140, 96, 61, 198, 164], [241, 241, 30, 5, 104, 108, 3, 203, 223, 90, 127, 140, 32, 99, 12, 187, 59, 201, 6, 218, 45, 236, 102, 77, 60, 207, 186, 89, 145, 97, 148, 227], [179, 123, 171, 118, 38, 87, 155, 25, 135, 184, 72, 108, 169, 149, 127, 226, 57, 37, 52, 234, 198, 171, 132, 108, 155, 207, 244, 213, 129, 250, 173, 201], [34, 3, 34, 93, 199, 88, 245, 166, 177, 67, 180, 75, 63, 59, 26, 226, 49, 170, 21, 135, 224, 107, 215, 204, 219, 116, 133, 175, 231, 26, 99, 234], [7, 84, 10, 229, 67, 246, 157, 85, 240, 106, 34, 63, 193, 250, 242, 246, 183, 151, 252, 190, 90, 249, 168, 128, 36, 114, 37, 12, 95, 0, 184, 210], [98, 68, 126, 201, 156, 121, 180, 185, 49, 40, 241, 50, 50, 54, 220, 220, 178, 50, 182, 102, 68, 166, 94, 12, 212, 232, 110, 236, 22, 125, 135, 148], [144, 153, 246, 175, 11, 148, 14, 83, 1, 117, 136, 195, 191, 222, 250, 157, 38, 118, 51, 124, 79, 9, 64, 98, 98, 170, 20, 64, 63, 0, 51, 151], [206, 31, 224, 107, 67, 178, 251, 40, 161, 137, 51, 62, 185, 111, 252, 202, 235, 4, 86, 168, 253, 253, 224, 112, 68, 170, 204, 48, 82, 157, 22, 219], [86, 151, 0, 174, 214, 218, 88, 43, 74, 93, 25, 13, 96, 95, 0, 213, 76, 217, 199, 210, 37, 190, 10, 72, 244, 240, 95, 226, 219, 236, 91, 162], [183, 162, 186, 252, 196, 232, 71, 14, 249, 169, 72, 228, 56, 171, 124, 239, 17, 63, 129, 125, 55, 232, 220, 202, 236, 196, 166, 78, 253, 209, 193, 198], [118, 235, 1, 19, 113, 200, 156, 131, 159, 142, 44, 181, 7, 158, 126, 185, 250, 154, 86, 97, 196, 147, 189, 105, 101, 48, 116, 162, 171, 19, 79, 188], [75, 85, 145, 41, 253, 29, 175, 185, 241, 161, 30, 239, 140, 117, 138, 201, 56, 106, 25, 206, 127, 46, 164, 243, 82, 212, 170, 79, 127, 221, 140, 210], [233, 44, 162, 241, 102, 170, 101, 161, 230, 53, 250, 181, 123, 58, 185, 208, 163, 194, 67, 229, 35, 112, 22, 75, 52, 248, 41, 98, 65, 179, 110, 254], [242, 80, 72, 36, 33, 89, 142, 144, 239, 113, 50, 239, 191, 42, 63, 231, 40, 137, 36, 157, 107, 77, 16, 239, 159, 134, 233, 228, 189, 70, 220, 199], [192, 140, 193, 0, 233, 68, 110, 100, 164, 63, 108, 155, 27, 35, 151, 153, 249, 239, 153, 17, 119, 235, 175, 218, 255, 4, 48, 203, 107, 96, 3, 175], [135, 204, 196, 154, 255, 88, 87, 250, 114, 88, 71, 240, 205, 191, 60, 200, 233, 231, 124, 19, 30, 150, 5, 240, 253, 205, 63, 189, 58, 48, 83, 140], [237, 189, 88, 221, 205, 55, 193, 255, 22, 27, 156, 211, 15, 61, 175, 218, 159, 68, 42, 43, 57, 90, 88, 250, 150, 217, 131, 182, 74, 230, 236, 220], [21, 215, 63, 243, 13, 243, 252, 15, 108, 207, 200, 185, 114, 153, 197, 170, 161, 24, 224, 143, 94, 20, 176, 78, 204, 131, 89, 112, 52, 48, 21, 253], [127, 89, 2, 249, 122, 161, 225, 237, 90, 144, 226, 121, 164, 97, 60, 198, 121, 211, 193, 179, 107, 181, 201, 186, 9, 126, 178, 121, 37, 137, 139, 242], [138, 60, 66, 34, 8, 178, 31, 152, 186, 220, 88, 224, 182, 174, 116, 161, 79, 2, 219, 242, 237, 166, 84, 67, 29, 136, 153, 65, 204, 218, 177, 206], [81, 241, 93, 185, 128, 172, 72, 1, 213, 204, 39, 88, 88, 198, 140, 170, 229, 133, 200, 111, 49, 111, 239, 242, 164, 94, 165, 212, 53, 33, 33, 166], [97, 206, 86, 244, 125, 21, 141, 11, 84, 31, 242, 114, 4, 31, 115, 142, 167, 8, 0, 233, 7, 95, 230, 143, 149, 249, 154, 153, 195, 218, 195, 161], [20, 216, 94, 147, 238, 97, 251, 97, 99, 77, 79, 150, 188, 193, 233, 128, 94, 29, 141, 67, 150, 21, 210, 3, 122, 236, 166, 153, 166, 101, 59, 240], [207, 74, 25, 137, 62, 197, 67, 221, 120, 134, 142, 66, 228, 164, 50, 173, 145, 15, 223, 68, 68, 118, 63, 77, 54, 204, 13, 173, 250, 212, 55, 219], [226, 63, 25, 209, 17, 156, 239, 229, 179, 145, 213, 44, 17, 15, 15, 197, 69, 176, 34, 77, 202, 77, 130, 117, 74, 19, 220, 93, 220, 141, 234, 231], [147, 58, 189, 84, 102, 132, 36, 28, 126, 255, 63, 85, 64, 20, 164, 227, 29, 201, 71, 19, 145, 228, 30, 34, 170, 151, 33, 131, 96, 161, 73, 144], [204, 201, 145, 217, 211, 174, 237, 114, 80, 19, 68, 53, 59, 19, 39, 156, 228, 26, 146, 54, 21, 178, 182, 144, 155, 181, 239, 13, 9, 137, 165, 149], [112, 88, 153, 61, 31, 2, 197, 75, 38, 201, 89, 238, 22, 56, 130, 176, 81, 26, 184, 14, 93, 99, 25, 114, 164, 63, 130, 67, 26, 162, 101, 144], [68, 75, 4, 6, 77, 57, 24, 3, 52, 121, 247, 195, 197, 206, 235, 150, 69, 29, 159, 160, 233, 4, 45, 190, 99, 235, 29, 89, 170, 88, 116, 202], [216, 32, 165, 105, 217, 136, 186, 165, 79, 171, 196, 174, 158, 101, 66, 171, 212, 217, 151, 187, 91, 52, 245, 58, 15, 192, 120, 156, 26, 92, 114, 238], [116, 251, 228, 192, 90, 62, 184, 1, 40, 175, 239, 198, 110, 177, 132, 133, 180, 80, 220, 199, 30, 109, 155, 234, 96, 109, 170, 1, 173, 3, 246, 238], [83, 21, 157, 9, 41, 244, 204, 150, 111, 112, 238, 247, 79, 219, 10, 215, 219, 237, 55, 105, 185, 160, 248, 28, 239, 186, 165, 41, 41, 79, 254, 171], [141, 236, 178, 201, 14, 243, 234, 2, 219, 213, 204, 8, 185, 25, 91, 207, 136, 45, 5, 25, 83, 146, 246, 34, 115, 190, 1, 185, 167, 167, 106, 187], [84, 214, 49, 113, 228, 190, 192, 254, 127, 142, 127, 29, 121, 93, 235, 155, 21, 35, 13, 76, 163, 171, 238, 24, 205, 18, 57, 145, 151, 228, 196, 169], [118, 31, 251, 100, 150, 210, 151, 222, 222, 68, 252, 30, 40, 167, 38, 139, 163, 188, 240, 0, 140, 185, 151, 30, 149, 201, 47, 53, 134, 217, 12, 168], [156, 111, 165, 242, 127, 58, 235, 177, 14, 45, 244, 13, 21, 94, 105, 174, 194, 252, 74, 94, 98, 235, 34, 80, 62, 171, 154, 67, 184, 239, 117, 243], [12, 205, 59, 175, 212, 146, 98, 43, 152, 96, 8, 77, 162, 98, 113, 243, 106, 121, 75, 57, 152, 167, 138, 130, 172, 251, 160, 178, 89, 36, 154, 184], [134, 201, 94, 94, 216, 166, 62, 173, 10, 238, 67, 92, 48, 111, 98, 154, 174, 34, 139, 143, 32, 32, 209, 3, 89, 155, 78, 21, 219, 56, 154, 185], [50, 6, 249, 209, 92, 125, 93, 192, 59, 138, 221, 169, 16, 63, 0, 135, 92, 167, 104, 202, 216, 163, 252, 205, 71, 25, 215, 20, 21, 51, 46, 241], [221, 32, 75, 215, 37, 73, 42, 95, 216, 4, 183, 47, 189, 176, 136, 188, 120, 135, 120, 103, 85, 14, 240, 56, 109, 179, 22, 156, 45, 213, 212, 160], [85, 82, 194, 154, 115, 213, 140, 149, 1, 163, 108, 124, 185, 247, 173, 196, 185, 84, 129, 243, 235, 222, 49, 108, 75, 50, 190, 30, 0, 254, 65, 178], [68, 128, 53, 178, 191, 222, 235, 101, 233, 121, 116, 120, 210, 120, 225, 180, 219, 72, 139, 46, 199, 209, 35, 175, 78, 86, 63, 114, 88, 169, 153, 202], [208, 141, 71, 196, 69, 131, 102, 141, 140, 255, 26, 46, 62, 122, 57, 147, 209, 249, 205, 191, 32, 243, 160, 208, 254, 23, 243, 52, 236, 175, 228, 249], [254, 133, 255, 181, 55, 90, 55, 63, 53, 45, 100, 11, 153, 154, 88, 232, 189, 33, 191, 59, 232, 205, 143, 53, 111, 233, 41, 137, 27, 114, 119, 133], [80, 252, 255, 135, 38, 204, 47, 142, 17, 101, 244, 201, 161, 85, 126, 226, 128, 147, 39, 230, 176, 80, 253, 201, 80, 131, 99, 154, 206, 127, 64, 151], [61, 5, 34, 0, 137, 72, 133, 34, 134, 70, 6, 172, 4, 38, 82, 226, 233, 199, 131, 153, 106, 3, 242, 40, 224, 16, 166, 216, 41, 77, 99, 225], [126, 167, 237, 20, 182, 66, 56, 148, 142, 95, 54, 3, 180, 79, 229, 195, 236, 201, 148, 58, 66, 118, 206, 110, 224, 141, 18, 31, 65, 51, 195, 200], [205, 174, 161, 200, 97, 16, 236, 152, 176, 149, 213, 34, 241, 89, 199, 215, 194, 155, 1, 51, 245, 100, 40, 245, 174, 26, 14, 180, 149, 67, 133, 153], [146, 28, 151, 29, 251, 15, 205, 92, 52, 96, 185, 194, 55, 50, 87, 190, 160, 163, 250, 235, 171, 222, 80, 164, 159, 90, 189, 240, 169, 95, 85, 224], [102, 21, 160, 44, 180, 241, 158, 211, 128, 60, 110, 166, 221, 231, 4, 134, 126, 183, 230, 17, 133, 126, 119, 20, 52, 236, 12, 48, 193, 159, 255, 133], [138, 34, 221, 221, 215, 186, 107, 85, 229, 196, 168, 109, 55, 96, 9, 196, 106, 208, 123, 94, 70, 62, 64, 217, 136, 27, 95, 20, 95, 161, 74, 172], [182, 25, 220, 124, 223, 18, 109, 179, 222, 198, 110, 93, 157, 15, 43, 170, 251, 143, 255, 2, 19, 178, 9, 119, 21, 148, 21, 44, 145, 62, 126, 245], [230, 157, 84, 104, 74, 117, 144, 60, 24, 67, 205, 68, 131, 188, 255, 152, 201, 93, 133, 204, 255, 136, 21, 80, 194, 104, 76, 54, 216, 136, 242, 204], [100, 166, 11, 30, 175, 88, 196, 163, 8, 188, 20, 76, 142, 232, 140, 247, 173, 130, 194, 100, 212, 82, 122, 57, 95, 114, 181, 249, 192, 181, 92, 161], [120, 159, 3, 133, 47, 9, 13, 124, 4, 71, 197, 99, 101, 96, 152, 136, 175, 119, 10, 127, 176, 104, 46, 223, 52, 213, 200, 18, 30, 100, 210, 154], [254, 109, 27, 6, 17, 240, 227, 151, 133, 110, 216, 4, 221, 233, 108, 142, 121, 2, 83, 179, 247, 44, 254, 98, 119, 6, 80, 36, 119, 171, 47, 226], [142, 43, 196, 206, 114, 248, 187, 8, 126, 1, 207, 185, 81, 217, 211, 160, 84, 99, 108, 20, 15, 90, 45, 96, 185, 134, 196, 244, 148, 196, 205, 135], [236, 103, 153, 141, 220, 131, 238, 210, 253, 9, 5, 135, 34, 158, 93, 165, 109, 200, 138, 179, 132, 236, 254, 39, 184, 249, 208, 74, 158, 133, 196, 186], [177, 205, 222, 198, 36, 167, 230, 147, 180, 2, 114, 168, 73, 89, 116, 243, 232, 2, 221, 17, 131, 89, 19, 75, 43, 145, 117, 157, 188, 42, 125, 171], [221, 219, 163, 14, 17, 250, 217, 134, 228, 232, 210, 155, 134, 103, 121, 189, 205, 181, 124, 187, 11, 167, 86, 90, 127, 39, 198, 189, 11, 251, 135, 179], [51, 140, 106, 212, 26, 254, 155, 1, 93, 168, 29, 226, 137, 138, 88, 243, 100, 41, 0, 52, 128, 16, 247, 127, 167, 209, 210, 27, 168, 46, 211, 202], [211, 116, 54, 125, 93, 184, 107, 71, 154, 30, 12, 200, 169, 5, 73, 203, 236, 220, 249, 95, 189, 62, 147, 68, 76, 50, 247, 182, 71, 187, 16, 177], [233, 247, 86, 193, 212, 27, 100, 124, 168, 44, 229, 208, 167, 227, 181, 229, 204, 101, 58, 128, 152, 31, 128, 135, 237, 178, 202, 183, 221, 208, 26, 165], [101, 31, 153, 153, 216, 134, 213, 175, 125, 221, 209, 225, 10, 191, 55, 207, 171, 152, 80, 177, 91, 36, 114, 165, 152, 89, 162, 170, 100, 110, 55, 168], [143, 86, 159, 235, 122, 55, 166, 161, 154, 214, 75, 250, 52, 19, 81, 209, 154, 92, 10, 225, 9, 230, 71, 28, 222, 24, 251, 122, 130, 193, 32, 211], [137, 31, 142, 187, 48, 10, 208, 105, 245, 216, 169, 122, 215, 232, 94, 253, 243, 98, 117, 110, 103, 187, 107, 131, 80, 3, 42, 226, 243, 218, 206, 221], [160, 169, 11, 9, 247, 39, 43, 118, 132, 207, 69, 210, 80, 106, 211, 189, 132, 233, 213, 134, 109, 233, 229, 13, 218, 55, 81, 252, 13, 132, 18, 226], [176, 81, 252, 112, 130, 216, 109, 53, 59, 158, 72, 9, 163, 181, 50, 197, 213, 187, 242, 220, 164, 114, 61, 239, 208, 123, 151, 86, 151, 62, 78, 185], [200, 90, 168, 65, 117, 153, 249, 30, 42, 11, 177, 76, 112, 213, 182, 217, 181, 31, 145, 42, 84, 42, 37, 69, 68, 27, 211, 44, 52, 231, 31, 230], [63, 90, 243, 111, 135, 111, 248, 105, 109, 148, 176, 112, 175, 221, 144, 220, 219, 82, 100, 105, 196, 32, 81, 209, 127, 234, 251, 40, 142, 193, 93, 141], [30, 228, 55, 237, 141, 114, 177, 231, 60, 105, 46, 177, 46, 51, 220, 189, 243, 236, 226, 185, 123, 21, 236, 230, 205, 1, 27, 241, 122, 118, 11, 212], [244, 209, 8, 86, 206, 98, 168, 95, 224, 89, 117, 67, 87, 82, 37, 130, 29, 184, 176, 175, 231, 186, 234, 76, 30, 100, 228, 60, 230, 81, 221, 223], [2, 114, 225, 153, 137, 240, 140, 106, 26, 60, 201, 125, 7, 195, 135, 214, 89, 43, 89, 141, 172, 215, 45, 56, 31, 153, 173, 34, 44, 221, 22, 180], [175, 157, 171, 251, 73, 133, 136, 54, 211, 171, 20, 136, 180, 44, 57, 142, 97, 143, 65, 60, 153, 53, 193, 114, 95, 247, 32, 120, 35, 243, 250, 154], [50, 150, 189, 146, 22, 223, 5, 81, 185, 98, 70, 123, 30, 197, 217, 237, 71, 175, 216, 168, 184, 133, 79, 237, 117, 48, 138, 93, 111, 17, 8, 180], [101, 18, 203, 126, 71, 117, 116, 59, 169, 91, 231, 92, 59, 108, 196, 167, 30, 225, 201, 112, 242, 125, 123, 238, 8, 187, 221, 212, 102, 98, 69, 174], [78, 6, 17, 236, 53, 233, 115, 243, 18, 15, 138, 111, 38, 66, 17, 191, 76, 119, 118, 54, 31, 244, 126, 76, 109, 243, 184, 103, 123, 17, 160, 250], [69, 235, 181, 130, 27, 21, 255, 108, 152, 95, 72, 224, 98, 55, 167, 181, 112, 91, 97, 163, 86, 79, 226, 217, 158, 7, 171, 113, 15, 96, 140, 138], [155, 147, 203, 33, 132, 136, 150, 81, 55, 254, 45, 249, 122, 236, 61, 167, 116, 87, 247, 231, 28, 9, 64, 173, 250, 231, 248, 202, 194, 67, 82, 132], [77, 121, 46, 231, 122, 138, 156, 114, 216, 10, 246, 242, 234, 126, 60, 173, 163, 157, 187, 198, 161, 208, 4, 89, 34, 35, 176, 3, 210, 57, 153, 196], [119, 144, 155, 64, 118, 12, 185, 88, 66, 225, 244, 241, 83, 86, 84, 185, 53, 64, 18, 123, 5, 197, 106, 106, 122, 195, 76, 29, 254, 63, 224, 188], [211, 224, 222, 104, 103, 223, 201, 200, 97, 73, 192, 140, 84, 145, 247, 130, 86, 210, 110, 251, 85, 54, 253, 47, 233, 59, 67, 192, 55, 221, 76, 216], [55, 52, 65, 179, 195, 73, 65, 115, 241, 44, 93, 88, 5, 220, 19, 135, 194, 149, 152, 27, 255, 71, 30, 89, 208, 85, 232, 242, 223, 43, 250, 188], [167, 39, 159, 76, 198, 183, 9, 193, 140, 248, 165, 134, 174, 100, 231, 161, 30, 166, 14, 50, 127, 78, 144, 61, 105, 24, 119, 76, 190, 250, 182, 137], [193, 3, 106, 143, 130, 47, 156, 94, 102, 98, 90, 58, 72, 37, 49, 137, 163, 75, 217, 50, 62, 4, 224, 194, 129, 121, 216, 2, 189, 25, 116, 173], [125, 64, 201, 158, 137, 197, 235, 86, 125, 74, 180, 157, 198, 33, 42, 169, 167, 85, 97, 72, 186, 205, 12, 18, 101, 242, 133, 0, 43, 18, 215, 219], [108, 22, 50, 3, 98, 80, 126, 65, 75, 83, 216, 207, 58, 208, 180, 209, 97, 237, 149, 227, 248, 155, 57, 179, 13, 146, 191, 4, 247, 230, 164, 194], [145, 55, 224, 242, 16, 143, 114, 177, 205, 139, 198, 239, 231, 83, 218, 237, 53, 100, 144, 8, 136, 240, 180, 92, 224, 166, 218, 200, 27, 95, 34, 157], [201, 202, 15, 71, 33, 150, 202, 165, 27, 246, 51, 21, 107, 86, 122, 206, 217, 48, 113, 172, 169, 119, 64, 41, 145, 170, 77, 247, 198, 194, 201, 217], [245, 208, 231, 39, 193, 40, 46, 36, 60, 85, 244, 20, 168, 130, 110, 159, 189, 198, 133, 175, 18, 36, 143, 240, 131, 59, 209, 112, 225, 228, 153, 182], [182, 14, 121, 44, 120, 91, 177, 59, 161, 30, 90, 244, 207, 167, 23, 211, 230, 144, 242, 161, 111, 185, 37, 144, 199, 95, 170, 104, 164, 129, 93, 200], [201, 157, 239, 206, 79, 197, 17, 73, 235, 172, 172, 213, 106, 130, 22, 143, 169, 234, 131, 84, 16, 184, 88, 140, 14, 66, 106, 245, 167, 63, 198, 168], [218, 53, 241, 34, 18, 154, 121, 112, 181, 163, 205, 179, 149, 250, 63, 171, 33, 44, 53, 213, 214, 10, 3, 4, 104, 213, 89, 117, 53, 192, 107, 189], [113, 235, 222, 21, 71, 125, 202, 238, 117, 252, 60, 222, 255, 140, 54, 165, 46, 240, 157, 198, 87, 120, 242, 130, 123, 178, 81, 193, 6, 131, 183, 244]];
    
    //Checking if deserialisation results in the same field element as converting from the intger double.
    let byte_slice: Vec<_> = test_as_bytes.iter().map(
        |a: &[u8; 32]| 
        Fp2::read_from(
            &mut SliceReader::new(a)
        ).unwrap()).collect();
    assert_eq!(f2_a_as_f128p2, byte_slice)
}

    #[test]
    fn sqrt_check(){
        for _ in 0..1000{
            let a=Fp::random();
            let b=a.square();
            let c=b.sqrt().unwrap().square();
            assert_eq!(b,c);
        }
    }
    
#[test]
fn power_by(){
    let a = Fp::from(2u128);
    let b = a.power_by(&[2u64]);
    println!("{:?}", b)
}
